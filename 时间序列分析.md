### 时间序列分析学习记录目录

https://zhuanlan.zhihu.com/p/266172219

**此文转自知乎 不爱起床的燕林** 

## 第一章 平稳序列

## 1.1平稳序列基本概念

无论是从原序列中把趋势项去掉得到的随机波动项，还是用随机差分后得到残差序列，都会存在一种现象：**随机项会沿着水平值波动，并且前后之间具有相关性，与独立序列不同**。

### 一、定义

**定义1.1** 如果时间序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D%3D%5Cleft%5C%7BX_%7Bt%7D%3A+t+%5Cin+%5Cmathbb%7BN%7D%5Cright%5C%7D) 满足

- 对任何 ![[公式]](https://www.zhihu.com/equation?tex=t+%5Cin+%5Cmathbb%7BN%7D%2C+E+X_%7Bt%7D%5E%7B2%7D%3C%5Cinfty) ----等于没说，也就是随机变量性质稍微好点
- 对任何 ![[公式]](https://www.zhihu.com/equation?tex=t+%5Cin+%5Cmathbb%7BN%7D%2C+E+X_%7Bt%7D%3D%5Cmu) ----这个也不本质，取0也可以
- 对任何 ![[公式]](https://www.zhihu.com/equation?tex=t%2C+s+%5Cin+%5Cmathbb%7BN%7D%2C+E%5Cleft%5B%5Cleft%28X_%7Bt%7D-%5Cmu%5Cright%29%5Cleft%28X_%7Bs%7D-%5Cmu%5Cright%29%5Cright%5D%3D%5Cgamma_%7Bt-s%7D) ---**关键！**

那么我们称 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 是**平稳**的时间序列，简称为**平稳序列**。称实数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cgamma_%7Bt%7D%5Cright%5C%7D) 为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 的**自协方差函数**.

**例1.1** 平稳序列的线性变换依然是平稳序列

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 为平稳序列，期望 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmu) ，自协方差函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma%28t%29) 。线性变换得到

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3Da+X_%7Bt%7D%2Bb%2C+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

那么

![[公式]](https://www.zhihu.com/equation?tex=E+Y_%7Bt%7D%3Da+%5Cmu%2Bb%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BCov%7D%5Cleft%28Y_%7Bs%7D%2C+Y_%7Bs%2Bt%7D%5Cright%29%3Da%5E%7B2%7D+%5Coperatorname%7BCov%7D%5Cleft%28X_%7Bt%7D%2C+X_%7Bt%2Bs%7D%5Cright%29%3Da%5E%7B2%7D+%5Cgamma%28t%29%5C%5C) 

可见![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) 为平稳序列.

如果取 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Cfrac%7BX_%7Bt%7D-%5Cmu%7D%7B%5Csqrt%7B%5Cgamma_%7B0%7D%7D%7D) ，那么它的均值为0，方差为1，称为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 的标准化序列.

**例1.2** 调和平稳序列

设 ![[公式]](https://www.zhihu.com/equation?tex=a%2Cb) 为常数，随机变量 ![[公式]](https://www.zhihu.com/equation?tex=U%5Csim+U%28-%5Cpi%2C+%5Cpi%29) ，则

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3Db+%5Ccos+%28a+t%2BU%29%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

是平稳序列.

**证明**：验证期望为常数，协方差只与时间间隔有关

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D+X_%7Bt%7D%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+b+%5Ccos+%28a+t%2Bu%29+d+u%3D0%5C%5C+%5Cbegin%7Baligned%7D+E%5Cleft%28X_%7Bt%7D+X_%7Bs%7D%5Cright%29+%26%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+b%5E%7B2%7D+%5Ccos+%28a+t%2Bu%29+%5Ccos+%28a+s%2Bu%29du+%5C%5C+%26%3D%5Cfrac%7B1%7D%7B2%7D+b%5E%7B2%7D+%5Ccos+%28%28t-s%29+a%29+%5Cend%7Baligned%7D) 

**说明**：计算期望时用到三角函数在一个周期内的积分为0。计算协方差时，用到积化和差公式得到一个常数加一个三角函数，然后用三角函数在一个周期内积分为0。

### 二、自协方差函数性质

自协方差函数有以下三条性质：

- **对称性**： ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Cgamma_%7B-k%7D%2C+%5Cforall+k+%5Cin+%5Cmathbb%7BZ%7D) 
- **非负定性**：

![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bn%7D%3D%5Cleft%28%5Cgamma_%7Bk-j%7D%5Cright%29_%7Bk%2C+j%3D1%7D%5E%7Bn%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bcccc%7D+%5Cgamma_%7B0%7D+%26+%5Cgamma_%7B1%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bn-1%7D+%5C%5C+%5Cgamma_%7B1%7D+%26+%5Cgamma_%7B0%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bn-2%7D+%5C%5C+%5Ccdots+%26+%5Ccdots+%26+%5Ccdots+%26+%5Ccdots+%5C%5C+%5Cgamma_%7Bn-1%7D+%26+%5Cgamma_%7Bn-2%7D+%26+%5Ccdots+%26+%5Cgamma_%7B0%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

对任意 ![[公式]](https://www.zhihu.com/equation?tex=n) 是非负定矩阵

- **有界性**： ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7C%5Cgamma_%7Bk%7D%5Cright%7C+%5Cleq+%5Cgamma_%7B0%7D%2C+%5Cforall+k+%5Cin+%5Cmathbb%7BZ%7D) 

**对称性证明**：用到了协方差的对称性

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Coperatorname%7BCov%7D%5Cleft%28X_%7Bt%7D%2C+X_%7Bt%2Bk%7D%5Cright%29%3D%5Coperatorname%7BCov%7D%5Cleft%28X_%7Bt%2Bk%7D%2C+X_%7Bt%7D%5Cright%29%3D%5Cgamma_%7B-k%7D%5C%5C) 

**非负定性证明：**

任取一个向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha%3D%5Cleft%28a_%7B1%7D%2C+a_%7B2%7D%2C+%5Ccdots%2C+a_%7Bn%7D%5Cright%29%5E%7BT%7D) ，有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Calpha%5E%7BT%7D+%5CGamma_%7Bn%7D+%5Calpha+%26%3D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D+%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+a_%7Bi%7D+a_%7Bj%7D+%5Cgamma_%7Bi-j%7D+%5C%5C+%26%3DE+%5Csum_%7Bi%3D1%7D%5E%7Bn%7D+%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+a_%7Bi%7D+a_%7Bj%7D%5Cleft%28X_%7Bi%7D-%5Cmu%5Cright%29%5Cleft%28X_%7Bj%7D-%5Cmu%5Cright%29+%5C%5C+%26%3DE%5Cleft%5B%5Csum_%7Bi%3D1%7D%5E%7Bn%7D+a_%7Bi%7D%5Cleft%28X_%7Bi%7D-%5Cmu%5Cright%29%5Cright%5D%5E%7B2%7D+%5Cgeq+0+%5Cend%7Baligned%7D%5C%5C) 

对于第一个等号，可以看做是一个求和，其中求和的每一项就是分别从三部分中取一个然后相乘，即

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cldots%2C+a_%7Bi%7D%2C+%5Ccdots%5Cright%29%5Cleft%28%5Cbegin%7Barray%7D%7Bccc%7D+%5Cddots+%26+%5Cvdots+%26+.+%5Ccdot+%5C%5C+%5Ccdots+%26+%5Cgamma_%7Bi-j%7D+%26+%5Ccdots+%5C%5C+%5Ccdot+%5Ccdot+%26+%5Cvdots+%26+%5Cddots+%5Cend%7Barray%7D%5Cright%29%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+%5Cvdots+%5C%5C+a_%7Bj%7D+%5C%5C+%5Cvdots+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

**有界性证明**：运用Schwarz不等式 ![[公式]](https://www.zhihu.com/equation?tex=%7C%5Coperatorname%7BCov%7D%28X%2C+Y%29%7C+%5Cleq+%5Csqrt%7B%5Coperatorname%7BVar%7D%28X%29+%5Coperatorname%7BVar%7D%28Y%29%7D) 有

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bt%7D%3D%5Coperatorname%7BCov%7D%5Cleft%28Y_%7B1%7D%2C+Y_%7Bt%2B1%7D%5Cright%29+%5Cleq+%5Csqrt%7BVar%28Y_1%29Var%28Y_%7Bt%2B1%7D%29%7D+%5Cleq+%5Cgamma_%7B0%7D%5C%5C) 

**反过来**，只要实数列满足这三个条件，就可以构造随机序列，使得该序列的协方差函数为该给定的实数列！

### 三、非负定性、随机变量的线性相关

首先根据非负定性的证明有

![[公式]](https://www.zhihu.com/equation?tex=%5Calpha%5E%7BT%7D+%5CGamma_%7Bn%7D+%5Calpha%3D%5Coperatorname%7BVar%7D%5Cleft%28%5Csum_%7Bi%3D1%7D%5E%7Bn%7D+a_%7Bi%7D+X_%7Bi%7D%5Cright%29+%5Cgeq+0%5C%5C) 

进而如果 ![[公式]](https://www.zhihu.com/equation?tex=+%5CGamma_%7Bn%7D+) 是退化（即非满秩），那么当且仅当存在 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha+%5Cneq+0) 使得

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BVar%7D%5Cleft%28%5Csum_%7Bi%3D1%7D%5E%7Bn%7D+a_%7Bi%7D+X_%7Bi%7D%5Cright%29%3D0%5C%5C) 

此时称 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn%7D) 是线性相关的.

更进一步，如果 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn%7D) 是线性相关的，那么对于 ![[公式]](https://www.zhihu.com/equation?tex=m+%5Cgeq+n) ， ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+%5Cldots%2C+X_%7Bm%7D) 也是线性相关的.

### 四、自相关系数

**定义1.2** 设平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 的标准化序列为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) . ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) 的自协方差函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk%7D%3D%5Cgamma_%7Bk%7D+%2F+%5Cgamma_%7B0%7D%2C+%5Cquad+k+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

我们把这样标准化后序列的自协方差函数成为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 的自相关函数.很多时候求自相关函数比求自协方差函数要容易，因为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_0) 不容易求出来.

### 五、白噪声、白噪声模拟

定义1.3 设平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D) ，如果它满足

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D+%5Cvarepsilon_%7Bt%7D%3D%5Cmu%5C%5C%5Coperatorname%7BCov%7D%5Cleft%28%5Cvarepsilon_%7Bt%7D%2C+%5Cvarepsilon_%7Bs%7D%5Cright%29%3D%5Csigma%5E%7B2%7D+%5Cdelta_%7Bt-s%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Csigma%5E%7B2%7D%2C+%26+t%3Ds+%5C%5C+0%2C+%26+t+%5Cneq+s+%5Cend%7Barray%7D%5Cright.) 

则称![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D)为白噪声序列，记作 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BWN%7D%5Cleft%28%5Cmu%2C+%5Csigma%5E%7B2%7D%5Cright%29) 

- 如果序列是独立的，称为**独立白噪声**
- 如果序列均值为0，称为**零均值白噪声**
- 如果序列均值为0方差为1，称为**标准白噪声**
- 如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D) 服从正态分布，称为**正态白噪声**.

### 六、正交和不相关性

如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BCov%7D%28X%2C+Y%29%3D0) 称 ![[公式]](https://www.zhihu.com/equation?tex=X%2CY) **不相关**，如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%28X+Y%29%3D0) 称 ![[公式]](https://www.zhihu.com/equation?tex=X%2CY) **正交**.

对于两个平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D%2C%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) ，其不相关和正交分别定义为

- **不相关**： ![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BCov%7D%5Cleft%28X_%7Bt%7D%2C+Y_%7Bs%7D%5Cright%29%3D0%2C+%5Cforall+t%2C+s) 
- **正交**： ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%7D+Y_%7Bs%7D%5Cright%29%3D0%2C+%5Cforall+t%2C+s) 

之所以这样定义正交，是从几何角度来看。事实上对于所有二阶矩存在的随机变量，构成一个Hilbert空间，且Hilbert空间上内积就用数学期望来定义.

两个平稳序列之和是否还是平稳序列？下面这个定理给出了说明：

**定理1.1** 对于平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D%2C%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) ，自协方差函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_X%28t%29%2C+%5Cgamma_%7BY%7D%28t%29) ，期望为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmu_%7BX%7D%2C+%5Cmu_%7BY%7D) .且令 ![[公式]](https://www.zhihu.com/equation?tex=Z_%7Bt%7D%3DX_%7Bt%7D%2BY_%7Bt%7D%2C+t+%5Cin+%5Cmathbb%7BZ%7D) ，那么当 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D%2C%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) 正交或不相关的时候， ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BZ_%7Bt%7D%5Cright%5C%7D) 是平稳的.

**证明**： 

二阶矩有界： ![[公式]](https://www.zhihu.com/equation?tex=E+Z_%7Bt%7D%5E%7B2%7D%3DE%5Cleft%28X_%7Bt%7D%2BY_%7Bt%7D%5Cright%29%5E%7B2%7D+%5Cleq+2+E%5Cleft%28X_%7Bt%7D%5E%7B2%7D%2BY_%7Bt%7D%5E%7B2%7D%5Cright%29%3C%5Cinfty) 

均值常数： ![[公式]](https://www.zhihu.com/equation?tex=%5Cmu_%7Bz%7D%3DE+Z_%7Bt%7D%3DE+X_%7Bt%7D%2BE+Y_%7Bt%7D%3D%5Cmu_%7BX%7D%2B%5Cmu_%7BY%7D) 

当正交的时候：![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7BZ%7D%28k%29%3D%5Cgamma_%7BX%7D%28k%29%2B%5Cgamma_%7BY%7D%28k%29-2+%5Cmu_%7BX%7D+%5Cmu_%7BY%7D%2C+%5Cquad+k%3D0%2C1%2C2%2C+%5Cldots) 

当不相关的时候： ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7BZ%7D%28k%29%3D%5Cgamma_%7BX%7D%28k%29%2B%5Cgamma_%7BY%7D%28k%29%5Cquad+k%3D0%2C1%2C2%2C+%5Cldots) 

## 1.2线性平稳序列和线性滤波

几种常用且重要的平稳序列

- 有限运动平均
- 线性平稳序列
- 时间序列的线性滤波

### 一、有限运动平均

设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D%3D%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%3A+t+%5Cin+%5Cmathbb%7BZ%7D%5Cright%5C%7D) 是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BWN%7D%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29) ，对于常数 ![[公式]](https://www.zhihu.com/equation?tex=a_%7B0%7D%2C+a_%7B1%7D%2C+%5Cldots%2C+a_%7Bq%7D) ，称

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%3Da_%7B0%7D+%5Cvarepsilon_%7Bt%7D%2Ba_%7B1%7D+%5Cvarepsilon_%7Bt-1%7D%2B%5Ccdots%2Ba_%7Bq%7D+%5Cvarepsilon_%7Bt-q%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

是白噪声 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D) 的**有限运动平均**，简称为**MA(moving average)**，运动平均又称滑动平均.

- MA的平稳性

验证一下数学期望和自协方差函数的条件:

数学期望： ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D+X_%7Bt%7D%3D0) 

自协方差函数： 

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+E+X_%7Bt%2Bk%7D+X_%7Bt%7D+%26%3DE+%5Csum_%7Bi%3D0%7D%5E%7Bq%7D+a_%7Bi%7D+%5Cvarepsilon_%7Bt%2Bk-i%7D+%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D+%5C%5C+%26%3D%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+%5Csum_%7Bi%3D0%7D%5E%7Bq%7D+a_%7Bj%7D+a_%7Bi%7D+E+%5Cvarepsilon_%7Bt%2Bk-i%7D+%5Cvarepsilon_%7Bt-j%7D+%5C%5C+%26%3D%5Csigma%5E2%5Csum_%7Bj%3D0%7D%5E%7Bq-k%7D+a_%7Bj%7D+a_%7Bj%2Bk%7DI_%7B%280%5Cleq+k%5Cleq+q+%29%7D+%5Cend%7Baligned%7D%5C%5C) 

其中第3个等号利用白噪声的不相关性，只有 ![[公式]](https://www.zhihu.com/equation?tex=t%2Bk-i%3Dt-j) 即 ![[公式]](https://www.zhihu.com/equation?tex=i%3Dj%2Bk) 时，求和项的中数学期望不为0，因此固定 ![[公式]](https://www.zhihu.com/equation?tex=j) 后， ![[公式]](https://www.zhihu.com/equation?tex=i) 只能取为 ![[公式]](https://www.zhihu.com/equation?tex=j%2Bk) ，并且 ![[公式]](https://www.zhihu.com/equation?tex=i) 不能超过 ![[公式]](https://www.zhihu.com/equation?tex=q) ，所以 ![[公式]](https://www.zhihu.com/equation?tex=j) 不超过 ![[公式]](https://www.zhihu.com/equation?tex=q-k) .

### 二、线性平稳序列

将有限运动平均改为无穷项会发生什么？定义零均值白噪声的无穷滑动平均为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

当满足 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D%5Cright%7C%3C%5Cinfty) 时， ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7Bx_%7Bt%7D%5Cright%5C%7D) 是平稳序列，满足的这个条件也称为**绝对可和**.

当求和项数无限时，不能够轻易将期望与求和交换，那么如何证明平稳？

**定理2.1** （**单调收敛定理**）如果非负随机变量序列单调不减 ![[公式]](https://www.zhihu.com/equation?tex=0+%5Cleq+%5Cxi_%7B1%7D+%5Cleq+%5Cxi_%7B2%7D+%5Cleq+%5Ccdots) ，那么如果该序列的极限几乎处处收敛： ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D+%5Crightarrow+%5Cxi%2C+%5Ctext+%7B+a.s+%7D)，则 ![[公式]](https://www.zhihu.com/equation?tex=E+%5Cxi%3D%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+E+%5Cxi_%7Bn%7D) ，也就是期望与极限可交换.

利用这个定理，我们令 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D%3D%5Csum_%7Bj%3D-n%7D%5E%7Bn%7D%5Cleft%7Ca_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%7C) ，显然这是一个单调不减的正随机变量序列，并且在广义随机变量（即随机变量可以是无穷大）假设下有

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-n%7D%5E%7Bn%7D%5Cleft%7Ca_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%7C+%5Crightarrow+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%7C+%5Ctext+%7B+a.s.+%7D%5C%5C) 

因此利用单调收敛定理得到

![[公式]](https://www.zhihu.com/equation?tex=E+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%7C%3D%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+E+%5Csum_%7Bj%3D-n%7D%5E%7Bn%7D%5Cleft%7Ca_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%7C%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+E%5Cleft%7Ca_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%7C%5C%5C) 

但是无穷滑动平均的定义中没有绝对值，怎么办？

**定理2.2** （**控制收敛定理**）如果随机变量序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cxi_%7Bn%7D%5Cright%5C%7D) 满足 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7C%5Cxi_%7Bn%7D%5Cright%7C+%5Cleq+%5Cxi_%7B0%7D+%5Ctext+%7B+a.s+%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%7C%5Cxi_%7B0%7D%5Cright%7C%3C%5Cinfty) ，也就是说该序列被一个期望存在的随机变量控制，那么如果该序列的极限存在： ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D+%5Crightarrow+%5Cxi%2C+%5Ctext+%7B+a.s+%7D) ，则 ![[公式]](https://www.zhihu.com/equation?tex=E+%5Cxi_%7Bn%7D+%5Crightarrow+E+%5Cxi) .

**首先**考察期望。由上面的讨论，我们得到在绝对值情形下的数学期望为 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+E%5Cleft%7Ca_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%7C) ，而由Schwarz不等式以及绝对可和的条件，这个数学期望是有界的，而切比雪夫不等式告诉我们，一个期望有界的随机变量，是几乎处处有界的，因此 ![[公式]](https://www.zhihu.com/equation?tex=+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%7C+%5Ctext+%7B+a.s.+%7D) 是有意义的，进而去掉绝对值符号后， ![[公式]](https://www.zhihu.com/equation?tex=+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7Da_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D+) 也是有意义的.

我们取 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D%3D%5Csum_%7Bj%3D-n%7D%5E%7Bn%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D) ，取 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7B0%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+E%5Cleft%7Ca_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%7C) ，根据控制收敛定理期望与极限可交换，交换之后期望就为0了.

**然后**还要考察 ![[公式]](https://www.zhihu.com/equation?tex=+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7Da_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D+) 的自相关函数，很自然会想到期望与求和交换，进而得到**与有限运动平均类似**的结果：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathrm%7BE%7D+X_%7Bt%7D+X_%7Bt%2Bk%7D+%26%3D%5Cmathrm%7BE%7D+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D+%5Csum_%7Bl%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bl%7D+%5Cvarepsilon_%7Bt%2Bk-1%7D+%5C%5C+%26%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Csum_%7Bl%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+a_%7Bl%7D+%5Cmathrm%7BE%7D%5Cleft%28%5Cvarepsilon_%7Bt-j%7D+%5Cvarepsilon_%7Bt%2Bk-l%7D%5Cright%29+%5C%5C+%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+a_%7Bj%2Bk%7D+%5Cend%7Baligned%7D%5C%5C) 

至于为什么能交换，也就是单调收敛定理与控制收敛定理的应用，具体来说就是先**考察各项都取绝对值后的期望是否存在**，在这里就是

![[公式]](https://www.zhihu.com/equation?tex=V%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Csum_%7Bl%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D%5Cright%7C%5Cleft%7Ca_%7Bl%7D%5Cright%7C%5Cleft%7C%5Cepsilon_%7Bt-j%7D%5Cright%7C%5Cleft%7C%5Cepsilon_%7Bt%2Bk-l%7D%5Cright%7C%5C%5C) 

其期望可计算如下：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathrm%7BE%7D+V+%26%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Csum_%7Bl%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D%5Cright%7C%5Cleft%7Ca_%7Bl%7D%5Cright%7C+%5Cmathrm%7BE%7D%5Cleft%7C%5Cepsilon_%7Bt-j%7D%5Cright%7C%5Cleft%7C%5Cepsilon_%7Bt%2Bk-l%7D%5Cright%7C+%5C%5C+%26+%5Cleq+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Csum_%7Bl%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D%5Cright%7C%5Cleft%7Ca_%7Bl%7D%5Cright%7C+%5Csigma%5E%7B2%7D%3D%5Csigma%5E%7B2%7D%5Cleft%28%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D%5Cright%7C%5Cright%29%5E%7B2%7D%3C%5Cinfty+%5Cend%7Baligned%7D%5C%5C) 

其中第一个等号运用单调收敛定理，即对于正项级数的期望和求和可交换，不等号运用了Schwarz不等式，最后一个小于号利用了绝对可和性。

**最后**说明一下二阶矩有界。这里也是Schwarz不等式的运用，如下：

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D%5E%7B2%7D+%5Cleq%5Cleft%28%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D%5Cright%7C%5Cright%29%5E%7B2%7D%3C%5Cinfty%5C%5C) 

**注1**：绝对可和条件下，如上定义的**自协方差函数是绝对收敛**的。

**证明：**

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7C%5Cgamma_%7Bk%7D%5Cright%7C+%5Cleq+%5Csigma%5E%7B2%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D+a_%7Bj%2Bk%7D%5Cright%7C+%5C%5C+%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D%5Cright%7C+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%2Bk%7D%5Cright%7C%3D%5Csigma%5E%7B2%7D%5Cleft%28%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ca_%7Bj%7D%5Cright%7C%5Cright%29%5E%7B2%7D+%3C+%5Cinfty+%5Cend%7Barray%7D%5C%5C) 

这说明了自协方差函数当 ![[公式]](https://www.zhihu.com/equation?tex=%7Ck%7C) 很大的时候，会很快趋于0，也就是说**时间间隔比较长的两个观测值之间相关性是比较小**的。

**单边线性序列：**只对非负部分求和，即 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D) ，类似可以计算得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+a_%7Bj%2Bk%7D%2C+%26+k+%5Cgeq+0+%5C%5C+%5Cgamma_%7B-k%7D+%26+k%3C0+%5Cend%7Barray%7D%5Cright.%5C%5C) 





时间序列分析（2） ARIMA 模型：https://zhuanlan.zhihu.com/p/60648709



## 1.2线性平稳序列和线性滤波（续）

### 三、线性滤波

考虑将线性平稳序列中的**白噪声替换为一般的平稳序列**，即

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bj%7D+X_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

这称为对 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 进行**线性滤波**。其中绝对可和的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7Bh_%7Bj%7D%5Cright%5C%7D) 称为**保时线性滤波器**。

**问**：如何理解“滤波”的含义？

**答**：相当于把 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 中尖锐的部分抹去，使其变得较为光滑。

可以证明 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D) 是平稳序列，方法与之前的类似。

**第一**，说明无穷级数 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D) 是有意义的。我们取各项带绝对值的来控制它，而各项带绝对值的期望和求和是可交换的，根据 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7Bh_%7Bj%7D%5Cright%5C%7D) 的绝对可和性得到各项带绝对值的期望是小于无穷的。

**第二**，利用控制收敛定理，交换期望与求和，求出 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D) 的数学期望如下：

![[公式]](https://www.zhihu.com/equation?tex=%5Cmu_%7BY%7D%3D%5Cmathrm%7BE%7D+%7BY%7D_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bj%7D+%5Cmathrm%7BE%7D+X_%7Bt-j%7D%3D%5Cmu_%7BX%7D+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bj%7D%5C%5C) 

**第三**，利用控制收敛定理（也是用每项取绝对值来控制），期望与求和交换，求出自协方差函数如下：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7BY%7D%28n%29+%26%3D%5Coperatorname%7BCov%7D%5Cleft%28Y_%7Bn%2B1%7D%2C+Y_%7B1%7D%5Cright%29%3D%5Csum_%7Bj%2C+k%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bj%7D+h_%7Bk%7D+E%5Cleft%5B%5Cleft%28X_%7Bn%2B1-j%7D-%5Cmu%5Cright%29%5Cleft%28X_%7B1-k%7D-%5Cmu%5Cright%29%5Cright%5D+%5C%5C+%26%3D%5Csum_%7Bj%2C+k%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bj%7D+h_%7Bk%7D+%5Cgamma_%7Bn%2Bk-j%7D+%5Cend%7Baligned%7D%5C%5C) 

**第四**，说明二阶矩有限，主要还是Schwarz不等式的应用，计算过程如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7BY%7D%280%29+%26%3D%5Csum_%7Bj%2C+k%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bj%7D+h_%7Bk%7D+%5Cgamma_%7Bk-j%7D%3D%5Csum_%7Bi%2C+j%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bi%7D+h_%7Bi%2Bj%7D+%5Cgamma_%7Bi%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bj%7D+%5Csum_%7Bi%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bi%2Bj%7D+%5Cgamma_%7Bi%7D+%5Cleq+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ch_%7Bj%7D%5Cright%7C+%5Csum_%7Bi%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ch_%7Bi%2Bj%7D+%5Cgamma_%7Bi%7D%5Cright%7C+%5C%5C+%26+%5Cleq+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ch_%7Bj%7D%5Cright%7C+%5Csum_%7Bi%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ch_%7Bi%2Bj%7D+%5Cgamma_%7Bi%7D%5Cright%7C+%5Cleq+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ch_%7Bj%7D%5Cright%7C_%7B+%7D+%5Csqrt%7B%5Cleft%28%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Csum_%7Bi%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7Ch_%7Bi%2Bj%7D%5Cright%7C%5Cright%29%5E%7B2%7D%5Cleft%28%5Csum_%7Bi%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft%7C%5Cgamma_%7Bi%7D%5Cright%7C%5Cright%29%5E%7B2%7D%7D%3C%5Cinfty+%5Cend%7Baligned%7D%5C%5C) 

第二个等号是求和指标的变换，倒数第二步为Schwarz不等式，最后一步利用绝对可和性以及自协方差函数的绝对收敛性。

**例** 矩形窗滤波器。

取 ![[公式]](https://www.zhihu.com/equation?tex=h_%7Bj%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Cfrac%7B1%7D%7B2+M%2B1%7D%2C+%26+%7Cj%7C+%5Cleq+M+%5C%5C+0%2C+%26+%7Cj%7C%3EM+%5Cend%7Barray%7D%5Cright.) ，则 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Cfrac%7B1%7D%7B2+M%2B1%7D+%5Csum_%7Bj%3D-M%7D%5E%7BM%7D+x_%7Bt-j%7D) 。

这相当于对 ![[公式]](https://www.zhihu.com/equation?tex=-M) 到 ![[公式]](https://www.zhihu.com/equation?tex=M) 取平均，自然能够消除 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 中尖锐的部分.

**例** 余弦波信号滤波

取

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3DS_%7Bt%7D%2B%5Cvarepsilon_%7Bt%7D%3Db+%5Ccos+%28%5Comega+t%2BU%29%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=U+%5Csim+U%280%2C+2+%5Cpi%29) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D) 零均值平稳且与 ![[公式]](https://www.zhihu.com/equation?tex=U) 独立。此时信号 ![[公式]](https://www.zhihu.com/equation?tex=S) 与噪声 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon) 的方差分别为 ![[公式]](https://www.zhihu.com/equation?tex=b%5E2%2F2) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E2) ，对应的信噪比为 ![[公式]](https://www.zhihu.com/equation?tex=b%5E%7B2%7D+%2F%5Cleft%282+%5Csigma%5E%7B2%7D%5Cright%29) 

对其做矩形窗滤波得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+Y_%7Bt%7D+%26%3D%5Cfrac%7B1%7D%7B2+M%2B1%7D+%5Csum_%7Bj%3D-M%7D%5E%7BM%7D+X_%7Bt-j%7D+%5C%5C+%26%3D%5Cfrac%7Bb+%5Csin+%5B%5Comega%28M%2B0.5%29%5D%7D%7B%282+M%2B1%29+%5Csin+%28%5Comega+%2F+2%29%7D+%5Ccos+%28%5Comega+t%2BU%29%2B%5Ceta_%7Bt%7D+%5Cend%7Baligned%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Ceta_%7Bt%7D%3D%5Cfrac%7B1%7D%7B2+M%2B1%7D+%5Csum_%7Bj%3D-M%7D%5E%7BM%7D+%5Cvarepsilon_%7Bt-j%7D) ，对于第二个等号具体计算如下：

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-M%7D%5E%7Bj%3DM%7D+b+%5Ccos+%28%5Comega%28t-j%29%2BU%29%3D%5Csum_%7Bj%3D-M%7D%5E%7Bj%3DM%7D+b+%5Ccos+%28%5Comega+j%29+%5Ccos+%28%5Comega+t%2BU%29%5C%5C) 

上面这步用到的是两角差公式，其中由于 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctext%7Bsin%7D) 是负对称的，从 ![[公式]](https://www.zhihu.com/equation?tex=-M) 到 ![[公式]](https://www.zhihu.com/equation?tex=M) 求和为0。接下来用到一个**小技巧**：同乘同除 ![[公式]](https://www.zhihu.com/equation?tex=%5Csin+%28%5Comega+%2F+2%29) ，然后利用积化和差公式惊讶的发现：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Csum_%7Bj%3D-M%7D%5E%7Bj%3DM%7D+%5Ccos+%28%5Comega+j%29+%5Csin+%28%5Comega+%2F+2%29+%5C%5C+%3D%5Cfrac%7B1%7D%7B2%7D+%5Csum_%7Bj%3D-M%7D%5E%7Bj%3DM%7D%5B%5Csin+%28%5Comega+j%2B%5Comega+%2F+2%29-%5Csin+%28%5Comega+j-%5Comega+%2F+2%29%5D+%5Cend%7Barray%7D%5C%5C) 

得到了一个裂项相消的形式，进而保留头尾得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Csin+%28%5Comega+M%2B%5Comega+%2F+2%29) 

经过线性滤波处理前后，序列的一条样本轨道如下图所示：

![img](https://pic4.zhimg.com/80/v2-f665b906c247dbd002f791d325d40183_720w.jpg)X为蓝色，Y为红色

如果事先不告诉你，你可能不会认为蓝色部分是由余弦函数生成的，但经过矩形窗滤波器过滤后，红色部分的周期性就显而易见了。

### 四、放宽假定的线性平稳序列

在线性平稳序列部分，原来假定的是绝对可和，但实际上只需要平方可和即可。

设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7Ba_%7Bj%7D%5Cright%5C%7D+%5Cin+l_%7B2%7D) ，则 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cleft%28L%5E%7B2%7D%5Cright%29) **也是平稳序列**，期望和自协方差函数都是上一讲计算得到的形式。为了研究在这一假定下的线性平稳序列，需要引入新的概念。

两个空间：

（1）所有二阶矩存在的随机变量所构成的空间，记作 ![[公式]](https://www.zhihu.com/equation?tex=L%5E%7B2%7D%3D%5Cleft%5C%7BX%3A+E+X%5E%7B2%7D%3C%5Cinfty%5Cright%5C%7D) 

（2）由给定的平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=X) 的有限线性和构成的空间，记作

![[公式]](https://www.zhihu.com/equation?tex=L%5E%7B2%7D%28X%29%3D%5Cleft%5C%7B%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+a_%7Bj%7D+X%5Cleft%28t_%7Bj%7D%5Cright%29+%5Cmid+a_%7Bj%7D+%5Cin+%5Cmathbb%7BR%7D%2C+t_%7Bj%7D+%5Cin+%5Cmathbb%7BZ%7D%2C+1+%5Cleq+j+%5Cleq+k%2C+k+%5Cin+%5Cmathbb%7BN%7D%5Cright%5C%7D%5C%5C) 

由 ![[公式]](https://www.zhihu.com/equation?tex=X) 平稳可以得到 ![[公式]](https://www.zhihu.com/equation?tex=L%5E%7B2%7D%28X%29) 中的元素的二阶矩都是存在的，只需利用不等式

![[公式]](https://www.zhihu.com/equation?tex=E%28X%2BY%29%5E2+%5Cleq+%5Cfrac%7B1%7D%7B2%7DE%28X%5E2%2BY%5E2%29%5C%5C) 

可以验证 ![[公式]](https://www.zhihu.com/equation?tex=L%5E2%2CL%5E%7B2%7D%28X%29) 都是线性空间，并且如果定义内积为 ![[公式]](https://www.zhihu.com/equation?tex=%5Clangle+X%2C+Y%5Crangle%3DE%28X+Y%29) ，则两者都是内积空间。并由这个内积的定义很自然的引出距离的定义如下：

![[公式]](https://www.zhihu.com/equation?tex=%5C%7CX-Y%5C%7C%3D%28%5Clangle+X-Y%2C+X-Y%5Crangle%29%5E%7B1+%2F+2%7D%5C%5C) 

所谓的Hilbert空间要求内积空间是完备的（**完备指的是柯西序列的极限点也在内积空间当中**）。可以证明 ![[公式]](https://www.zhihu.com/equation?tex=L%5E2) 是完备的，也就是Hilbert空间（这里略去）。

要证明 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D) 的平稳性，令 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D%28t%29%3D%5Csum_%7Bj%3D-n%7D%5E%7Bn%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+t+%5Cin+%5Cmathbb%7BZ%7D) ，则 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D%28t%29+%5Cin+L%5E%7B2%7D) 。

计算 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D%28t%29+) 的柯西序列，对 ![[公式]](https://www.zhihu.com/equation?tex=m+%3C+n) ，当 ![[公式]](https://www.zhihu.com/equation?tex=m+%5Crightarrow+%5Cinfty) 

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cleft%5C%7C%5Cxi_%7Bn%7D-%5Cxi_%7Bm%7D%5Cright%5C%7C%5E%7B2%7D+%26%3D%5Cleft%5C%7C%5Csum_%7Bm%3Cb+%5Cmid+%5Cleq+n%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%5C%7C%5E%7B2%7D+%5C%5C+%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bm%3C%7Cj%7C+%5Cleq+n%7D+a_%7Bj%7D%5E%7B2%7D+%5Cleq+%5Csigma%5E%7B2%7D+%5Csum_%7B%7Cj%7C%3Em%7D+a_%7Bj%7D%5E%7B2%7D+%5Crightarrow+0+%5Cend%7Baligned%7D%5C%5C) 

由 ![[公式]](https://www.zhihu.com/equation?tex=L%5E2) 的完备性可知存在 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D+%5Cin+L%5E%7B2%7D) ，使得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D%28t%29+%5Cstackrel%7B%5Cmathrm%7Bm.s%7D%7D%7B%5Crightarrow%7D+X_%7Bt%7D) ，因此 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D) 是有意义的。

然后计算期望和自协方差函数如下，其中用到内积的连续性：

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D+X_%7Bt%7D%3D%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D%5Cleft%5Clangle%5Cxi_%7Bn%7D%28t%29%2C+1%5Cright%5Crangle%3D%5Clim+_%7Bn%7D+%5Cmathrm%7BE%7D+%5Cxi_%7Bn%7D%5Cleft%28t%5Cright%29%3D0%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Cmathrm%7BE%7D+X_%7Bt%7D+X_%7Bt%2Bk%7D%3D%5Clim+_%7Bn%7D%5Cleft%5Clangle%5Cxi_%7Bn%7D%28t%29%2C+%5Cxi_%7Bn%7D%28t%2Bk%29%5Cright%5Crangle+%5C%5C+%3D%5Clim+_%7Bn%7D%5Cleft%5Clangle%5Csum_%7Bj%3D-n%7D%5E%7Bn%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Csum_%7Bl%3D-n%7D%5E%7Bn%7D+a_%7Bl%7D+%5Cvarepsilon_%7Bt%2Bk-l%7D%5Cright%5Crangle+%5C%5C+%3D%5Clim+_%7Bn%7D+%5Csum_%7Bj%3D-n%7D%5E%7Bn%7D+%5Csum_%7Bl%3D-n%7D%5E%7Bn%7D+a_%7Bj%7D+a_%7Bl%7D+%5Cdelta_%7Bk-l%2Bj%7D+%5Csigma%5E%7B2%7D%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+a_%7Bj%2Bk%7D+%5Cend%7Barray%7D%5C%5C)

可以看出，内积的连续性在计算期望和自协方差函数时，起到和控制收敛定理一样的效果，因此提一下内积连续性定理。

**定理** 在内积空间中，如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmid+%5Cxi_%7Bn%7D-%5Cxi%5C%7C%5Crightarrow+0%2C%5C%7C+%5Ceta_%7Bn%7D-%5Ceta+%5C%7C+%5Crightarrow+0) ，则有

1. ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7C%5Cxi_%7Bn%7D%5Cright%5C%7C+%5Crightarrow%5C%7C%5Cxi%5C%7C) 
2. ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5Clangle%5Cxi_%7Bn%7D%2C+%5Ceta_%7Bn%7D%5Cright%5Crangle+%5Crightarrow%5Clangle%5Cxi%2C+%5Ceta%5Crangle) 

我们在绝对可和的条件下证明过自协方差函数是绝对收敛的，而事实上在平方可和的条件下，也有类似的结论。

**定理** 当 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7Ba_%7Bi%7D%5Cright%5C%7D+%5Cin+l_%7B2%7D) ，有自协方差函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Clim+_%7Bk+%5Crightarrow+%5Cinfty%7D+%5Cgamma_%7Bk%7D%3D0) 

证明：当 ![[公式]](https://www.zhihu.com/equation?tex=k%5Crightarrow%5Cinfty) ，有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cleft%7C%5Cgamma_%7Bk%7D%5Cright%7C+%26%3D%5Csigma%5E%7B2%7D%5Cleft%7C%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D+a_%7Bj%7D+a_%7Bj%2Bk%7D%5Cright%7C+%5C%5C+%26+%5Cleq+%5Csigma%5E%7B2%7D+%5Csum_%7Bj+%5Cmid+%5Cleq+k+%2F+2%7D%5Cleft%7Ca_%7Bj%7D+a_%7Bj%2Bk%7D%5Cright%7C%2B%5Csigma%5E%7B2%7D+%5Csum_%7B%7Cj%7C%3Ek+%2F+2%7D%5Cleft%7Ca_%7Bj%7D+a_%7Bj%2Bk%7D%5Cright%7C+%5C%5C+%26+%5Cleq+%5Csigma%5E%7B2%7D%5Cleft%5B%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D+a_%7Bj%7D%5E%7B2%7D+%5Csum_%7B%7C+j+%5Cmid+%5Cleqslant+k+%2F+2%7D+a_%7Bj%2Bk%7D%5E%7B2%7D%5Cright%5D%5E%7B1+%2F+2%7D%2B%5Csigma%5E%7B2%7D%5Cleft%5B%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D+a_%7Bj%7D%5E%7B2%7D+%5Csum_%7B%7Cj%7C%3Ek+%2F+2%7D+a_%7Bj%7D%5E%7B2%7D%5Cright%5D%5E%7B1+%2F+2%7D+%5Crightarrow+0+%5Cend%7Baligned%7D%5C%5C) 

第三步是对求和的两项分别运用柯西不等式，并对其中的一个求和项的求和范围进行扩大。而当 ![[公式]](https://www.zhihu.com/equation?tex=k) 很大的时候，由于平方可和， ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7B%7Cj+%5Cmid+%5Cleqslant+k+%2F+2%7D+a_%7Bj%2Bk%7D%5E%7B2%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7B%7Cj%7C%3Ek+%2F+2%7D+a_%7Bj%7D%5E%7B2%7D) 都趋于0.

## 1.3 正态平稳时间序列

现在再给白噪声加上一个条件--正态分布。

**定义3.1** 对时间序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) ，任意给定时点 ![[公式]](https://www.zhihu.com/equation?tex=t_%7B1%7D%2C+t_%7B2%7D%2C+%5Ccdots%2C+t_%7Bn%7D+%5Cin+%5Cmathbb%7BZ%7D) ，有 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28X%5Cleft%28t_%7B1%7D%5Cright%29%2C+X%5Cleft%28t_%7B2%7D%5Cright%29%2C+%5Cldots%2C+X%5Cleft%28t_%7Bn%7D%5Cright%29%5Cright%29) 服从多元正态分布，那么称 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 是正态时间序列。如果它还是平稳的，那么称为正态平稳时间序列。

**定理3.4** 令 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D) ，其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D) 是正态白噪声。则只要 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7Ba_%7Bj%7D%5Cright%5C%7D) 绝对可和， ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 就是正态平稳时间序列.

**两个工具**：

- 联合正态等价于任意线性组合为一元正态
- 正态序列如果依分布收敛，则极限还是正态，其期望方差为序列期望方差的极限

而平稳性由之前的讨论已经得到，现在只需说明正态性。

**思路**：要说明正态性，首先考虑有限项 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-M%7D%5E%7BM%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D) ，由于白噪声的正态性可以得到该有限项和的正态性，接下来只要说明依分布收敛。事实上可以考虑 ![[公式]](https://www.zhihu.com/equation?tex=L%5E1) 收敛，即作差

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D-%5Csum_%7Bj%3D-M%7D%5E%7BM%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5C%5C) 

并验证其绝对值的数学期望存在.

**正态性证明**：对任何 ![[公式]](https://www.zhihu.com/equation?tex=b%3D%5Cleft%28b_%7B1%7D%2C+b_%7B2%7D%2C+%5Ccdots%2C+b_%7Bm%7D%5Cright%29%5E%7BT%7D) ，定义

![[公式]](https://www.zhihu.com/equation?tex=Y%3Db%5E%7BT%7D+X%3D%5Csum_%7Bk%3D1%7D%5E%7Bm%7D+b_%7Bk%7D+X_%7Bk%7D%2C+%5Cquad+%5Ceta_%7Bn%7D%3D%5Csum_%7Bk%3D1%7D%5E%7Bm%7D+b_%7Bk%7D+%5Ceta_%7Bk%7D%28n%29%5C%5C) 

这里 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bk%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bk-j%7D+%5Cquad+%5Ceta_%7Bk%7D%28n%29%3D%5Csum_%7Bj%3D-n%7D%5E%7Bn%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bk-j%7D) ，则当 ![[公式]](https://www.zhihu.com/equation?tex=n+%5Crightarrow+%5Cinfty) 时有

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%7C%5Ceta_%7Bk%7D%28n%29-X_%7Bk%7D%5Cright%7C%3DE+%5Csum_%7B%5Cmid+j%3En%7D%5Cleft%7Ca_%7Bj%7D+%5Cvarepsilon_%7Bk-j%7D%5Cright%7C%3D%5Csum_%7B%5Cmid+j%3En%7D+a_%7Bj%7D+E%5Cleft%7C%5Cvarepsilon_%7Bk-j%7D%5Cright%7C+%5Cleq+%5Csigma+%5Csum_%7B%7Cj%7C%3En%7D+a_%7Bj%7D+%5Crightarrow+0%5C%5C%5Cbegin%7Barray%7D%7Bc%7D+E%5Cleft%28%5Cleft%7CY-%5Ceta_%7Bn%7D%5Cright%7C%5Cright%29%3DE%5Cleft%5B%5Cleft%7C%5Csum_%7Bk%3D1%7D%5E%7Bm%7D+b_%7Bk%7D%5Cleft%28X_%7Bk%7D-%5Ceta_%7Bk%7D%28n%29%5Cright%29%5Cright%7C%5Cright%5D+%5C%5C+%5Cleq+%5Csum_%7Bk%3D1%7D%5E%7Bm%7D%5Cleft%7Cb_%7Bk%7D%5Cright%7C+E%5Cleft%5B%5Cleft%7CX_%7Bk%7D-%5Ceta_%7Bk%7D%28n%29%5Cright%7C%5Cright%5D+%5Crightarrow+0+%5Cend%7Barray%7D) 

进而根据第二个工具，得到 ![[公式]](https://www.zhihu.com/equation?tex=Y) 的正态性，其期望和协方差如下：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+E+Y%3D%26+%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+E+%5Ceta_%7Bn%7D%3D%5Csum_%7Bk%3D1%7D%5E%7Bm%7D+b_%7Bk%7D+%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+E+%5Ceta_%7Bk%7D%28n%29+%5C%5C+%26%3D%5Csum_%7Bk%3D1%7D%5E%7Bm%7D+b_%7Bk%7D+E+X_%7Bk%7D%3D0+%5C%5C+%5Coperatorname%7Bvar%7D%28Y%29+%26%3D%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+%5Coperatorname%7Bvar%7D%5Cleft%28%5Ceta_%7Bn%7D%5Cright%29%3D%5Csum_%7Bk%3D1%7D%5E%7Bm%7D+%5Csum_%7Bj%3D1%7D%5E%7Bm%7D+b_%7Bk%7D+%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+E%5Cleft%28%5Ceta_%7Bk%7D%28n%29+%5Ceta_%7Bj%7D%28n%29%5Cright%29+b_%7Bj%7D+%5C%5C+%26%3D%5Csum_%7Bk%3D1%7D%5E%7Bm%7D+%5Csum_%7Bj%3D1%7D%5E%7Bm%7D+b_%7Bk%7D+E%5Cleft%28X_%7Bk%7D+X_%7Bj%7D%5Cright%29+b_%7Bj%7D%3Db%5E%7BT%7D+%5CSigma_%7Bm%7D+b+%5Cend%7Baligned%7D%5C%5C) 

## 1.4 严平稳序列及其遍历性

**严平稳定义**： ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28X_%7B1%7D%2C+X_%7B2%7D%2C+%5Cldots%2C+X_%7Bn%7D%5Cright%29%5E%7BT%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28X_%7B1%2Bk%7D%2C+X_%7B2%2Bk%7D%2C+%5Cldots%2C+X_%7Bn%2Bk%7D%5Cright%29%5E%7BT%7D) 同分布，对任意 ![[公式]](https://www.zhihu.com/equation?tex=%5Cforall+n+%5Cin+%5Cmathbb%7BN%7D+%2Ck+%5Cin+%5Cmathbb%7BZ%7D) 都成立，即**平移后分布不变**。并且任何多元函数作用得到的 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Cphi%5Cleft%28X_%7Bt%2B1%7D%2C+X_%7Bt%2B2%7D%2C+%5Ccdots%2C+X_%7Bt%2Bm%7D%5Cright%29) 仍然是严平稳序列。

**严平稳的遍历性**：如果满足遍历性，就可以由一次实现 ![[公式]](https://www.zhihu.com/equation?tex=x_%7B1%7D%2C+x_%7B2%7D%2C+%5Cldots) 推得严平稳序列的所有有限维分布：

![[公式]](https://www.zhihu.com/equation?tex=F%5Cleft%28x_%7B1%7D%2C+x_%7B2%7D%2C+%5Cldots%2C+x_%7Bm%7D%5Cright%29%3DP%5Cleft%28X_%7B1%7D+%5Cleq+x_%7B1%7D%2C+x_%7B2%7D+%5Cleq+x_%7B2%7D%2C+%5Cldots%2C+X_%7Bm%7D+%5Cleq+x_%7Bm%7D%5Cright%29%2C+%5Cquad+m+%5Cin+%5Cmathbb%7BN%7D%5C%5C) 

**严平稳遍历定理**：如果序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 是严平稳遍历序列，那么有如下两个结果：

- 强大数律：如果，则

![[公式]](https://www.zhihu.com/equation?tex=%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bt%3D1%7D%5E%7Bn%7D+X_%7Bt%7D%3DE+X_%7B1%7D%2C+%5Ctext+%7B+a.s..+%7D%5C%5C) 

- 多元函数作用不变：对任何多元函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cphi%5Cleft%28x_%7B1%7D%2C+x_%7B2%7D%2C+%5Ccdots%2C+x_%7Bm%7D%5Cright%29) ， 其作用后到的

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Cphi%5Cleft%28X_%7Bt%2B1%7D%2C+X_%7Bt%2B2%7D%2C+%5Ccdots%2C+X_%7Bt%2Bm%7D%5Cright%29%5C%5C) 

也是严平稳遍历序列。

例 由严平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=X) 生成序列

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3DI%5Cleft%5BX%5Cleft%28t%2Bt_%7B1%7D%5Cright%29+%5Cleq+y_%7B1%7D%2C+X%5Cleft%28t%2Bt_%7B2%7D%5Cright%29+%5Cleq+y_%7B2%7D%2C+%5Ccdots%2C+X%5Cleft%28t%2Bt_%7Bm%7D%5Cright%29+%5Cleq+y_%7Bm%7D%5Cright%5D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=I) 为示性函数，则如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 是遍历的，则 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) 也是遍历的，利用强大数律得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7D+%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bt%3D1%7D%5E%7Bn%7D+Y_%7Bt%7D%3DE+Y_%7B0%7D+%5C%5C+%3DP%5Cleft%28X%5Cleft%28t_%7B1%7D%5Cright%29+%5Cleq+y_%7B1%7D%2C+X%5Cleft%28t_%7B2%7D%5Cright%29+%5Cleq+y_%7B2%7D%2C+%5Ccdots%2C+X%5Cleft%28t_%7Bm%7D%5Cright%29+%5Cleq+y_%7Bm%7D%5Cright%29+%5Cend%7Barray%7D%5C%5C) 

这说明在几乎必然意义下， ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 的每个观测值都能够绝对 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 的有限维分布.

**线性平稳列的遍历定理**： ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D) 为独立同分布的白噪声，方差为 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E2) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7Ba_%7Bj%7D%5Cright%5C%7D) 平方可和，那么线性平稳序列

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

是严平稳遍历序列。

## 1.5 平稳序列的谱函数

从概率的角度研究一个序列的相关性，一般考察自协方差函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_k) ，但它的计算比较复杂， 工程上常用易于计算的谱密度函数 ![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29) ，而这两者之间是傅里叶变换的关系。

为了能把这部分内容说得更清楚，引入复随机变量的概念

### 一、复值随机变量、复值时间序列

![[公式]](https://www.zhihu.com/equation?tex=z%3Dx%2Bi+Y) 为复值随机变量， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D+Z%3D%5Cmathrm%7BE%7D+X%2Bi+%5Cmathrm%7BE%7D+Y) 

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BCov%7D%5Cleft%28Z_%7B1%7D%2C+Z_%7B2%7D%5Cright%29%3DE%5Cleft%28%5Cleft%28Z_%7B1%7D-E+Z_%7B1%7D%5Cright%29%5Cleft%28Z_%7B2%7D-E+Z_%7B2%7D%5Cright%29%5E%7B%2A%7D%5Cright%29) ， ![[公式]](https://www.zhihu.com/equation?tex=%2A) 表示共轭转置.

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%7CZ%7C%5E%7B2%7D%3D%5Cmathrm%7BE%7D+X%5E%7B2%7D%2B%5Cmathrm%7BE%7D+Y%5E%7B2%7D%3C%5Cinfty) 称为二阶矩有限的复随机变量.

复值随机变量序列称为复值时间序列，需要注意此时自协方差函数的对称性应该写成

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7B-k%7D%3D%5Cgamma_%7Bk%7D%5E%7B%2A%7D%5C%5C) 

**例5.1** 设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BY%7D+%5Csim+%5Cmathbf%7BU%7D%5B-%5Cmathbf%7B%5Cpi%7D%2C+%5Cmathbf%7B%5Cpi%7D%5D) ，定义 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bn%7D%3De%5E%7Bi+n+Y%7D%2C+%5Cmathrm%7Bn%7D+%5Cin+%5Cmathrm%7BZ%7D) ，则

![[公式]](https://www.zhihu.com/equation?tex=E+%5Cvarepsilon_%7Bn%7D%3D%5Cdelta_%7Bn%7D%2C+E%5Cleft%28%5Cvarepsilon_%7Bn%7D+%5Coverline%7B%5Cvarepsilon_%7Bm%7D%7D%5Cright%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+e%5E%7Bi%28n-m%29+y%7D+d+y%3D%5Cdelta_%7Bn-m%7D%5C%5C) 

**注**：求期望用欧拉公式变成三角函数，对于 ![[公式]](https://www.zhihu.com/equation?tex=n%5Cne0) 有三角函数积分为0.

对于平方可和的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7Ba_%7Bj%7D%5Cright%5C%7D) ，定义

![[公式]](https://www.zhihu.com/equation?tex=Z_%7Bn%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bn-j%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+e%5E%7Bi%28n-j%29+Y%7D%2C+n+%5Cin+Z%5C%5C) 

由内积的连续性得到（就期望和求和交换了，不严格写了）

![[公式]](https://www.zhihu.com/equation?tex=E+Z_%7Bn%7D%3Da_%7Bn%7D%2C+E%5Cleft%28Z_%7Bn%7D+%5Coverline%7BZ_%7Bm%7D%7D%5Cright%29%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Calpha_%7Bj%7D+a_%7Bj%2Bn-m%7D%5C%5C) 

而另一方面,把随机变量的期望用积分表示

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7D+E%5Cleft%28Z_%7Bn%7D+%5Coverline%7BZ_%7Bm%7D%7D%5Cright%29%3D%5Cmathrm%7BE%7D%5Cleft%5B%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Calpha_%7Bj%7D+e%5E%7Bi%28n-j%29+Y%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Calpha_%7Bk%7D+e%5E%7B-i%28m-k%29+Y%7D%5Cright%5D+%5C%5C+%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Calpha_%7Bj%7D+e%5E%7Bi%28n-j%29+y%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Calpha_%7Bk%7D+e%5E%7B-i%28m-k%29+y%7D+d+y+%5C%5C+%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Calpha_%7Bj%7D+e%5E%7B-i+j+y%7D%5Cright%7C%5E%7B2%7D+e%5E%7Bi%28n-m%29+y%7D+d+y+%5Cend%7Barray%7D%5C%5C) 

其中第三个等号需要把第二个求和的记号 ![[公式]](https://www.zhihu.com/equation?tex=k) 改为 ![[公式]](https://www.zhihu.com/equation?tex=j) ，并注意到 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Calpha_%7Bj%7D+e%5E%7B-ij+y%7D) 与 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Calpha_%7Bj%7D+e%5E%7Bij+y%7D) 是共轭的关系，进而提出一个公共项 ![[公式]](https://www.zhihu.com/equation?tex=e%5E%7Bi%28n-m%29+y%7D) ，剩下的就是模的平方.

这样就得到了一个**恒等式**：

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+a_%7Bj%2Bn-m%7D%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+e%5E%7B-i+j+y%7D%5Cright%7C%5E%7B2%7D+e%5E%7Bi%28n-m%29+y%7D+d+y%5C%5C) 

我们称右边积分中的项除去指数部分剩下的为**谱密度函数**。

定义

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+e%5E%7B-i+j+%5Clambda%7D%5Cright%7C%5E%7B2%7D%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B2%7D%5C%5C) 

第二个等号是因为共轭的关系，所以正负号随意.

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+a_%7Bj%2Bk%7D%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+f%28y%29+e%5E%7Bi+k+y%7D+d+y%2C+k+%5Cin+Z%5C%5C) 

### 二、谱函数的定义

设平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 有自协方差函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cgamma_%7Bk%7D%5Cright%5C%7D) 

如果有 ![[公式]](https://www.zhihu.com/equation?tex=%5B-%5Cpi%2C+%5Cpi%5D) 上单调不减右连续的函数 ![[公式]](https://www.zhihu.com/equation?tex=F%28%5Clambda%29) 使得

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+e%5E%7Bi+k+%5Clambda%7D+d+F%28%5Clambda%29%2C+%5Cquad+F%28-%5Cpi%29%3D0%2C+%5Cquad+k+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

则称 ![[公式]](https://www.zhihu.com/equation?tex=F%28%5Clambda%29) 为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 或 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cgamma_%7Bk%7D%5Cright%5C%7D) 的**谱分布函数**，简称**谱函数**。

如果
 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+f%28%5Clambda%29+e%5E%7Bi+k+%5Clambda%7D+d+%5Clambda%2C+%5Cquad+k+%5Cin+%5Cmathbb%7BZ%7D+%5C%5C) 

则 ![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29) 为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 或 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cgamma_%7Bk%7D%5Cright%5C%7D) 的**谱密度函数**，简称**谱密度**。

谱密度和谱分布的关系：

如果两者都存在，则谱分布的导数为谱密度.

如果谱分布绝对连续，则其几乎处处导数 ![[公式]](https://www.zhihu.com/equation?tex=F%5E%7B%5Cprime%7D%28%5Clambda%29) 为谱密度

如果谱分布连续，除有限点外导数存在且连续，则

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bl%7D+F%5E%7B%5Cprime%7D%28%5Clambda%29%2C%E5%AF%BC%E6%95%B0%E5%AD%98%E5%9C%A8+%5C%5C+0%EF%BC%8C%E5%AF%BC%E6%95%B0%E4%B8%8D%E5%AD%98%E5%9C%A8+%5Cend%7Barray%7D%5Cright.%5C%5C) 

### 三、谱函数的唯一性定理

**定理5.1** 平稳序列的谱函数唯一存在

### 四、线性平稳序列的谱密度

**定理5.2** 平方可和下线性平稳序列的谱密度函数形式为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C%5Csum_%7Bi%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B2%7D%5C%5C) 

可这样记忆，令 ![[公式]](https://www.zhihu.com/equation?tex=z%3De%5E%7Bj%5Clambda%7D) ，则形式上为幂级数

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C%5Csum_%7Bi%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+a_%7Bi%7D+z%5Ei%5Cright%7C%5E%7B2%7D%5C%5C) 

### 五、两正交序列的谱函数

**定理5.3** 设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) 为相互正交的零均值平稳序列， ![[公式]](https://www.zhihu.com/equation?tex=c) 是常数，定义

![[公式]](https://www.zhihu.com/equation?tex=Z_%7Bt%7D%3DX_%7Bt%7D%2BY_%7Bt%7D%2Bc%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

- 如果![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D)的谱函数分别为 ![[公式]](https://www.zhihu.com/equation?tex=F_%7BX%7D%28%5Clambda%29+%2CF_%7BY%7D%28%5Clambda%29) ，则

![[公式]](https://www.zhihu.com/equation?tex=F_%7BZ%7D%28%5Clambda%29%3DF_%7BX%7D%28%5Clambda%29%2BF_%7BY%7D%28%5Clambda%29%5C%5C) 

类似地 ![[公式]](https://www.zhihu.com/equation?tex=f_%7BZ%7D%28%5Clambda%29%3Df_%7BX%7D%28%5Clambda%29%2Bf_%7BY%7D%28%5Clambda%29) ，如果存在的话.

因为在正交的前提下，和的自相关函数等于自相关函数的和，即

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7BZ%7D%28k%29%3D%5Cgamma_%7BX%7D%28k%29%2B%5Cgamma_%7BY%7D%28k%29%5C%5C) 

### 六、线性滤波及其谱函数

线性滤波的形式为 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bj%7D+X_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D+.+%5Ctext+%7B+a.s.+%7D) ，其自协方差函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7BY%7D%28k%29%3D%5Csum_%7Bl%2C+j%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bl%7D+h_%7Bj%7D+%5Cgamma%28k%2Bl-j%29%5C%5C) 

接下来具体计算 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma) ，根据控制收敛定理![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7BY%7D%28k%29+%26%3D%5Csum_%7Bl%2C+j%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bl%7D+h_%7Bj%7D+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+%5Cexp+%28i%28k%2Bl-j%29+%5Clambda%29+d+F_%7BX%7D%28%5Clambda%29+%5C%5C+%26%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+%5Csum_%7Bl%2C+j%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bl%7D+h_%7Bj%7D+%5Cexp+%28i%28I-j%29+%5Clambda%29+e%5E%7Bi+k+%5Clambda%7D+d+F_%7BX%7D%28%5Clambda%29+%5C%5C+%26%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bj%7D+%5Cexp+%28-i+j+%5Clambda%29%5Cright%7C%5E%7B2%7D+e%5E%7Bi+k+%5Clambda%7D+d+F_%7BX%7D%28%5Clambda%29+%5C%5C+%26%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D%5Cleft%7CH%5Cleft%28e%5E%7B-i+%5Clambda%7D%5Cright%29%5Cright%7C%5E%7B2%7D+e%5E%7Bi+k+%5Clambda%7D+d+F_%7BX%7D%28%5Clambda%29+%5Cend%7Baligned%7D%5C%5C) 

其中

![[公式]](https://www.zhihu.com/equation?tex=H%28z%29%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+h_%7Bj%7D+z%5E%7Bj%7D%2C%7Cz%7C+%5Cleq+1%5C%5C) 

因此线性滤波的谱分布函数为

![[公式]](https://www.zhihu.com/equation?tex=F_%7BY%7D%28%5Clambda%29%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Clambda%7D%5Cleft%7CH%5Cleft%28e%5E%7B-i+s%7D%5Cright%29%5Cright%7C%5E%7B2%7D+d+F_%7BX%7D%28s%29%5C%5CF_%7BY%7D%28%5Clambda%29%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Clambda%7D%5Cleft%7CH%5Cleft%28e%5E%7B-i+s%7D%5Cright%29%5Cright%7C%5E%7B2%7D+f_%7BX%7D%28s%29+d+s) 

与线性平稳序列比较，线性滤波的谱密度实际上是把线性平稳序列的谱密度中的常数替换成 ![[公式]](https://www.zhihu.com/equation?tex=X) 的谱密度，事实上当 ![[公式]](https://www.zhihu.com/equation?tex=X) 为白噪声时，其谱密度就是常数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Csigma%5E2%7D%7B2%5Cpi%7D) 。



## 第二章 自回归模型

从形式上看，自回归模型是滞后 ![[公式]](https://www.zhihu.com/equation?tex=p) 期加权和与一白噪声叠加得到：

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

## 2.1推移算子和常系数差分方程

首先为了记号方便，引入**推移算子**的概念：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Cmathscr%7BB%7D+X_%7Bt%7D%3DX_%7Bt-1%7D+%5C%5C+%5Cmathscr%7BB%7D%5E%7B2%7D+X_%7Bt%7D%3D%5Cmathscr%7BB%7D%5Cleft%28%5Cmathscr%7BB%7D+X_%7Bt%7D%5Cright%29%3DX_%7Bt-2%7D+%5Cend%7Barray%7D%5C%5C) 

称 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathscr%7BB%7D) 是时间 ![[公式]](https://www.zhihu.com/equation?tex=t) 的向后推移算子，简称为**推移算子**（该记号为**花写的B，**且直观上应该是向前推移，但定义如此就不去管它了）。它具有如下的性质。

### 一、推移算子的性质

- ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathscr%7BB%7D+Y%3DY) ，其中 ![[公式]](https://www.zhihu.com/equation?tex=Y) 与 ![[公式]](https://www.zhihu.com/equation?tex=t) 无关.--**与时间 ![[公式]](https://www.zhihu.com/equation?tex=t) 无关**，推移前后自然不变。
- ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathscr%7BB%7D%5E%7Bn%7D%5Cleft%28a+X_%7Bt%7D%5Cright%29%3Da+%5Cmathscr%7BB%7D%5E%7Bn%7D+X_%7Bt%7D%3Da+X_%7Bt-n%7D) .--满足**数乘可交换**，并且推移作用**可叠加**。
- ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathscr%7BB%7D%5E%7Bn%2Bm%7D+X_%7Bt%7D%3D%5Cmathscr%7BB%7D%5E%7Bn%7D%5Cleft%28%5Cmathscr%7BB%7D%5E%7Bm%7D%5Cright%29+X_%7Bt%7D%3DX_%7Bt-n-m%7D) .
- 对多项式 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+c_%7Bj%7D+z%5E%7Bj%7D) ，有 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+c_%7Bj%7D+X_%7Bt-j%7D) .

后两条由推移作用的**叠加性质**以及算子的**线性性质**容易得到。

**性质5**：对于多项式 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+c_%7Bj%7D+z%5E%7Bj%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Cphi%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+d_%7Bj%7D+z%5E%7Bj%7D) 的乘积 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D%5Cpsi%28z%29+%5Cphi%28z%29) ，有

![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3D%5Cpsi%28%5Cmathscr%7BB%7D%29%5Cleft%5B%5Cphi%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%5Cright%5D%3D%5Cphi%28%5Cmathscr%7BB%7D%29%5Cleft%5B%5Cpsi%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%5Cright%5D%5C%5C) 

**说明**：由性质4可知算子可以同多项式复合，有着和多项式类似的性质，因此乘积可交换。

**性质6**：对于时间序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D%2C%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) ，多项式 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+c_%7Bj%7D+z%5E%7Bj%7D) 和随机变量 ![[公式]](https://www.zhihu.com/equation?tex=U%2CV%2CW) ，有

![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28%5Cmathscr%7BB%7D%29%5Cleft%28U+X_%7Bt%7D%2BV+Y_%7Bt%7D%2BW%5Cright%29%3DU+%5Cpsi%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%2BV+%5Cpsi%28%5Cmathscr%7BB%7D%29+Y_%7Bt%7D%2BW+%5Cpsi%281%29%5C%5C) 

上述性质的严格证明不作要求，后续碰到时直接运用即可，目的在于使得之后推导时的过程能够较为简洁。我们规定：只要无穷级数 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bi%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+b_%7Bj%7D+X_%7Bt-j%7D) 是有意义的（某种意义下收敛），那么就记

![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+b_%7Bj%7D+%5Cmathscr%7BB%7D%5E%7Bj%7D+X_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+b_%7Bj%7D+X_%7Bt-j%7D%5C%5C) 

现在我们想要研究什么样的时间序列满足 

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

即求方程的解，而这显然是一个关于 ![[公式]](https://www.zhihu.com/equation?tex=X) 非齐次的线性差分方程，为了求解，首先研究它对应的齐次差分方程。

### 二、常系数齐次线性差分方程

**定义**：给定实数 ![[公式]](https://www.zhihu.com/equation?tex=a_%7B1%7D%2C+a_%7B2%7D%2C+%5Ccdots%2C+a_%7Bp%7D%2C+a_%7Bp%7D+%5Cneq+0) ，称

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D-%5Cleft%5Ba_%7B1%7D+X_%7Bt-1%7D%2Ba_%7B2%7D+X_%7Bt-2%7D%2B%5Ccdots%2Ba_%7Bp%7D+X_%7Bt-p%7D%5Cright%5D%3D0%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

是 ![[公式]](https://www.zhihu.com/equation?tex=p) 阶**常系数齐次线性差分方程**，简称为**齐次差分方程**。我们把满足上式的**数列**和**时间序列**都称为方程的解。

容易看出，如果给定 ![[公式]](https://www.zhihu.com/equation?tex=p) 个初始值 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B0%7D%2C+X_%7B1%7D%2C+%5Ccdots%2C+X_%7Bp-1%7D) ，就可以通过逐步递推的方式来得到完整的时间序列，具体来说分为 ![[公式]](https://www.zhihu.com/equation?tex=t+%5Cgeq+p) 和 ![[公式]](https://www.zhihu.com/equation?tex=t%3C0) 两种情形，递推式分别为：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+X_%7Bt%7D%3D%5Cleft%5Ba_%7B1%7D+X_%7Bt-1%7D%2Ba_%7B2%7D+X_%7Bt-2%7D%2B%5Ccdots%2Ba_%7Bp%7D+X_%7Bt-p%7D%5Cright%5D%2C+%5Cquad+t+%5Cgeq+p+%5C%5C+X_%7Bt-p%7D%3D%5Cfrac%7B1%7D%7Ba_%7Bp%7D%7D%5Cleft%5Bx_%7Bt%7D-a_%7B1%7D+X_%7Bt-1%7D-%5Ccdots-a_%7Bp-1%7D+X_%7Bt-p%2B1%7D%5Cright%5D%2C+%5Cquad+t-p%3C0+%5Cend%7Barray%7D%5C%5C) 

那么该如何求得通解呢？

### 三、齐次线性方程的解

**首先**猜想它的通解会具有怎样的形式，而差分方程和微分方程其实是很类似的，在常微分方程中，对于齐次方程，其通解通常有一个是幂函数的形式，那自然联想到，是否差分方程的通解中也有幂函数的一项呢？

我们假设差分方程有形如 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cfrac%7B1%7D%7Bz%7D%5Cright%29%5E%7Bt%7D) 的解，代入得到 ![[公式]](https://www.zhihu.com/equation?tex=z) 应该满足

![[公式]](https://www.zhihu.com/equation?tex=1-%5Cleft%28a_%7B1%7D+z%2B%5Ccdots%2Ba_%7Bp%7D+z%5E%7Bp%7D%5Cright%29%3D0%5C%5C) 

即为多项式 ![[公式]](https://www.zhihu.com/equation?tex=1-%5Cleft%28a_%7B1%7D+z%2B%5Ccdots%2Ba_%7Bp%7D+z%5E%7Bp%7D%5Cright%29) 的根。利用推移算子可将差分方程写作 

![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3D0%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C)

其中 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D1-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+z%5E%7Bj%7D) ，我们称 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29) 为该差分方程的**特征多项式**。并且通过简单的运算可知，该差分方程的**解构成一个线性空间**，即如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D%2C%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) 是解，则 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi+X_%7Bt%7D%2B%5Ceta+Y_%7Bt%7D) 也是解，这其实在微分方程里也是成立的。

**然后**，对于该 ![[公式]](https://www.zhihu.com/equation?tex=p) 阶齐次差分方程，我们就只需要找到 ![[公式]](https://www.zhihu.com/equation?tex=p) 个线性无关的解，它们就可以构成完整的通解空间。上面已经求得一个解，如何寻找其他？我们通过几个例子来找下规律。

**例** ![[公式]](https://www.zhihu.com/equation?tex=%281-a+B%29X_t%3D0) 的通解是什么？

**解** ![[公式]](https://www.zhihu.com/equation?tex=%281-a+B%29+a%5E%7Bt%7D%3Da%5E%7Bt%7D-a+%5Ctimes+a%5E%7B%28t-1%29%7D%3D0) ，即 ![[公式]](https://www.zhihu.com/equation?tex=a%5Et) 是它的一个特解，乘上任意常数就得到通解.

**例** ![[公式]](https://www.zhihu.com/equation?tex=%281-a+B%29%5E2X_t%3D0) 的通解是什么？

**解** 对应的特征多项式为 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D%281-a+z%29%5E%7B2%7D) ，该特征多项式的根为 ![[公式]](https://www.zhihu.com/equation?tex=1%2Fa) ，所以 ![[公式]](https://www.zhihu.com/equation?tex=a%5Et) 为它的一个特解。那么另一个特解是？回顾微分方程中重根情形，其中有形如 ![[公式]](https://www.zhihu.com/equation?tex=te%5Et) 的特解，因此自然地，验证得到 ![[公式]](https://www.zhihu.com/equation?tex=ta%5Et) 是差分方程的特解.

以此类推，我们就通过找规律得到了差分方程的通解形式，即先将特征多项式做因式分解，可以得到 ![[公式]](https://www.zhihu.com/equation?tex=p) 个根（这些根可能会相同），然后对于这 ![[公式]](https://www.zhihu.com/equation?tex=p) 个根就能够写出其对应的 ![[公式]](https://www.zhihu.com/equation?tex=p) 个特解，接下来具体讨论。

### 四、差分方程的基础解

设特征多项式 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29) 有 ![[公式]](https://www.zhihu.com/equation?tex=k) 个不同零点 ![[公式]](https://www.zhihu.com/equation?tex=z_%7B1%7D%2C+z_%7B2%7D%2C+%5Ccdots%2C+z_%7Bk%7D) ，其中 ![[公式]](https://www.zhihu.com/equation?tex=z_j) 为 ![[公式]](https://www.zhihu.com/equation?tex=r%28j%29) 重零点，那么对应于 ![[公式]](https://www.zhihu.com/equation?tex=z_j) 有 ![[公式]](https://www.zhihu.com/equation?tex=r%28j%29) 个特解，分别是 ![[公式]](https://www.zhihu.com/equation?tex=z%5E%7B-t%7D_j%2Ctz%5E%7B-t%7D_j%2C...%2Ct%5E%7Br%28j%29-1%7Dz%5E%7B-t%7D_j) ，然后对于每个根都把特解写出来，所有 ![[公式]](https://www.zhihu.com/equation?tex=p) 个特解就构成一个通解空间。

但对于每个根，是否 ![[公式]](https://www.zhihu.com/equation?tex=z%5E%7B-t%7D_j%2Ctz%5E%7B-t%7D_j%2C...%2Ct%5E%7Br%28j%29-1%7Dz%5E%7B-t%7D_j) 都是特解，还需要证明，接下来就来证明一下：

**证**：可以将特征多项式做因式分解得到

![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D%5Cprod_%7Bj%3D1%7D%5E%7Bk%7D%5Cleft%281-z_%7Bj%7D%5E%7B-1%7D+z%5Cright%29%5E%7Br%28j%29%7D%5C%5C) 

则我们只需要证明 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%281-z_%7Bj%7D%5E%7B-1%7D+%5Cmathscr%7BB%7D%5Cright%29%5E%7Br%28j%29%7D+t%5E%7Bl%7D+z_%7Bj%7D%5E%7B-t%7D%3D0) ，其中 ![[公式]](https://www.zhihu.com/equation?tex=l%3D0%2C1%2C+%5Cldots%2C+r%28j%29-1) 即可.

而该结论的一个充分条件是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%281-z_%7Bj%7D%5E%7B-1%7D+%5Cmathscr%7BB%7D%5Cright%29%5E%7Bl%2B1%7D%5Cleft%28t%5E%7Bl%7D+z_%7Bj%7D%5E%7B-t%7D%5Cright%29%3D0%2C+l%3D0%2C1%2C+%5Cldots%2C+r%28j%29-1) ，因为 ![[公式]](https://www.zhihu.com/equation?tex=l%2B1) 不会超过 ![[公式]](https://www.zhihu.com/equation?tex=r%28j%29) ，进而可以运用**归纳法**证明该充分条件是成立的。

![[公式]](https://www.zhihu.com/equation?tex=l%3D0) 时， 验证结论成立

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%281-z_%7Bj%7D%5E%7B-1%7D+%5Cmathscr%7BB%7D%5Cright%29+z_%7Bj%7D%5E%7B-t%7D%3Dz_%7Bj%7D%5E%7B-t%7D-z_%7Bj%7D%5E%7B-1%7D+z_%7Bj%7D%5E%7B-%28t-1%29%7D%3D0%5C%5C) 

设对 ![[公式]](https://www.zhihu.com/equation?tex=0+%5Cleq+l+%5Cleq+m-1) 有

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%281-z_%7Bj%7D%5E%7B-1%7D+%5Cmathscr%7BB%7D%5Cright%29%5E%7Bl%2B1%7D+t%5E%7Bl%7D+z_%7Bj%7D%5E%7B-t%7D%3D0%5C%5C) 

则对 ![[公式]](https://www.zhihu.com/equation?tex=l%3Dm) 情形，有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26%5Cleft%281-z_%7Bj%7D%5E%7B-1%7D+%5Cmathscr%7BB%7D%5Cright%29%5E%7Bm%2B1%7D+t%5E%7Bm%7D+z_%7Bj%7D%5E%7B-t%7D+%5C%5C+%3D%26%5Cleft%281-z_%7Bj%7D%5E%7B-1%7D+%5Cmathscr%7BB%7D%5Cright%29%5E%7Bm%7D%5Cleft%28t%5E%7Bm%7D+z_%7Bj%7D%5E%7B-t%7D-z_%7Bj%7D%5E%7B-1%7D%28t-1%29%5E%7Bm%7D+z_%7Bj%7D%5E%7B-%28t-1%29%7D%5Cright%29+%5C%5C+%3D%26%5Cleft%281-z_%7Bj%7D%5E%7B-1%7D+%5Cmathscr%7BB%7D%5Cright%29%5E%7Bm%7D%5Cleft%28t%5E%7Bm%7D-%28t-1%29%5E%7Bm%7D%5Cright%29+z_%7Bj%7D%5E%7B-t%7D+%5C%5C+%3D%26%5Cleft%281-z_%7Bj%7D%5E%7B-1%7D+%5Cmathscr%7BB%7D%5Cright%29%5E%7Bm%7D%5Cleft%28c_%7B1%7D+t%5E%7Bm-1%7D%2Bc_%7B2%7D+t%5E%7Bm-2%7D%2B%5Ccdots%2Bc_%7Bm%7D%5Cright%29+z_%7Bj%7D%5E%7B-t%7D%3D0+%5Cend%7Baligned%7D%5C%5C) 

进而结论成立，即得齐次差分方程的基础解。而这些解是否线性无关，教材中没有给出证明，这里也就不要求了。

### 五、齐次线性差分方程的通解

通过上面的介绍，将所得的基础解作线性组合，就得到通解。

**定理** 上面定义的齐次线性差分方程的通解为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+%5Csum_%7Bl%3D0%7D%5E%7Br%28j%29-1%7D+U_%7Bl%2C+j%7D+t%5E%7Bl%7D+z_%7Bj%7D%5E%7B-t%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=U) 是随机变量，就相当于微分方程中的任意常数 ![[公式]](https://www.zhihu.com/equation?tex=C) .

### 六、通解的收敛性

如果差分方程特征多项式的**所有根都在单位圆外**，那么取 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha) 满足

![[公式]](https://www.zhihu.com/equation?tex=1%3C%5Calpha%3C%5Cmin+%5Cleft%5C%7B%5Cleft%7Cz_%7Bj%7D%5Cright%7C%3A+j%3D1%2C+%5Cldots%2C+k%5Cright%5C%7D%5C%5C) 

则当 ![[公式]](https://www.zhihu.com/equation?tex=t) 很大时，有

![[公式]](https://www.zhihu.com/equation?tex=t%5E%7Bl%7D%5Cleft%7Cz_%7Bj%7D%5Cright%7C%5E%7B-t%7D%3Dt%5E%7Bl%7D%5Cleft%28%5Calpha+%2F%5Cleft%7Cz_%7Bj%7D%5Cright%7C%5Cright%29%5E%7Bt%7D+%5Calpha%5E%7B-t%7D%3Do%5Cleft%28%5Calpha%5E%7B-t%7D%5Cright%29%5C%5C) 

在这种情形下， 齐次差分方程的基础解都是指数衰减于0的，说明齐次差分方程的解不会影响到我们求得的非齐次方程的解的收敛性。

如果不满足所有根都在单位圆外呢？这样就会出现不收敛的情况。

**例** 如果特征多项式有一根在单位圆上，设为 ![[公式]](https://www.zhihu.com/equation?tex=z_%7Bj%7D%3D%5Cexp+%5Cleft%28i+%5Clambda_%7Bj%7D%5Cright%29) ，则方程有一周期解

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3Da+%5Ccos+%5Cleft%28%5Clambda_%7Bj%7D+t%5Cright%29%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

**例** 如果特征多项式有一根在单位圆内，设为 ![[公式]](https://www.zhihu.com/equation?tex=z_%7Bj%7D%3D%5Crho_%7Bj%7D+%5Cexp+%5Cleft%28i+%5Clambda_%7Bj%7D%5Cright%29%2C+%5Crho_%7Bj%7D%3C1) ，则方程有一爆炸解（发散）

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3Da%5Cleft%28%5Cfrac%7B1%7D%7B%5Crho_%7Bj%7D%7D%5Cright%29%5E%7Bt%7D+%5Ccos+%5Cleft%28%5Clambda_%7Bj%7D+t%5Cright%29%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

### 七、非齐次线性差分方程及其通解

设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BY_%7Bt%7D%5Cright%5C%7D) 为时间序列，则非齐次线性差分方程形式为

![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DY_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

类似微分方程，该非齐次差分方程的通解也是（**特解+齐次方程通解**）的形式，即

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3DX_%7Bt%7D%5E%7B%280%29%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+%5Csum_%7Bl%3D0%7D%5E%7Br%28j%29-1%7D+U_%7Bl%2C+j%7D+t%5E%7Bl%7D+z_%7Bj%7D%5E%7B-t%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%5E%7B%280%29%7D) 为非齐次线性差分方程的一个特解。接下来我们回到自回归模型，看看对于自回归模型，它的非齐次线性差分方程的特解该如何选取。

## 2.2自回归模型及其平稳性

利用上面讲的内容，考察一阶自回归模型

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3Da+X_%7Bt-1%7D%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D+%5Csim+%5Cmathrm%7BWN%7D%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29) ，求出它对应差分方程的通解形式。

解 对自回归系数进行讨论

若 ![[公式]](https://www.zhihu.com/equation?tex=%7Ca%7C%3C1) ，则特征多项式的根在单位圆外，并且下面无穷级数有意义

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a%5E%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

找特解的一个有效的方法就是递推，而上面这个无穷级数就是通过递推得到的，我们验证它的确是差分方程的一个特解，过程如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+a+X_%7Bt-1%7D%2B%5Cvarepsilon_%7Bt%7D+%26%3Da+%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a%5E%7Bj%7D+%5Cvarepsilon_%7Bt-1-j%7D%2B%5Cvarepsilon_%7Bt%7D+%5C%5C+%26%3D%5Csum_%7Bi%3D1%7D%5E%7B%5Cinfty%7D+a%5E%7Bi%7D+%5Cvarepsilon_%7Bt-i%7D%2B%5Cvarepsilon_%7Bt%7D+%5Cquad%28i%3Dj%2B1%29+%5C%5C+%26%3DX_%7Bt%7D+%5Cend%7Baligned%7D%5C%5C) 

而对应齐次方程的解也已经完整讨论过，这里就直接写出非齐次方程的通解为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a%5E%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C%2B%5Cxi+a%5E%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

当 ![[公式]](https://www.zhihu.com/equation?tex=t) 很大时，齐次通解会很快衰减，最后只保留特解部分。

如果 ![[公式]](https://www.zhihu.com/equation?tex=%7Ca%7C%3D1) ，此时特征多项式的根在单位圆上，可以在给定初值为 ![[公式]](https://www.zhihu.com/equation?tex=X_0) 的条件下，证明非齐次差分方程没有平稳解。

如果 ![[公式]](https://www.zhihu.com/equation?tex=%7Ca%7C%3E1) ，此时特征多项式的根在单位圆内。我们之前给出一个例子说明特征多项式的根如果在单位圆内，那么解有可能发散，但就真的没有平稳解了吗？**并不是！！！**

逆向递推得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+X_%7Bt-1%7D%3D%5Cfrac%7B1%7D%7Ba%7D+X_%7Bt%7D-%5Cfrac%7B1%7D%7Ba%7D+%5Cvarepsilon_%7Bt%7D+%5C%5C+%3D%5Cfrac%7B1%7D%7Ba%5E%7B2%7D%7D+X_%7Bt%2B1%7D-%5Cfrac%7B1%7D%7Ba%5E%7B2%7D%7D+%5Cvarepsilon_%7Bt%2B1%7D-%5Cfrac%7B1%7D%7Ba%7D+%5Cvarepsilon_%7Bt%7D%3D%5Ccdots+%5C%5C+%3D-%5Cfrac%7B1%7D%7Ba%5E%7B2%7D%7D+%5Cvarepsilon_%7Bt%2B1%7D-%5Cfrac%7B1%7D%7Ba%7D+%5Cvarepsilon_%7Bt%7D-%5Ccdots+%5Cend%7Barray%7D%5C%5C) 

最后这个式子的系数都是小于1的，是平稳序列，但这个平稳解没有实际意义，它用未来的白噪声来刻画现在。

此外，在 ![[公式]](https://www.zhihu.com/equation?tex=%7Ca%7C%3E1) ，可构造一个新的自回归模型如下

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cfrac%7B1%7D%7B%5Calpha%7D+X_%7Bt-1%7D%2B%5Ceta_%7Bt%7D%2C+t+%5Cin+Z%2C%5Cleft%5C%7B%5Ceta_%7Bt%7D%5Cright%5C%7D+%5Csim+W+N%5Cleft%280%2C+%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B%5Ceta%5E%7B2%7D%7D%5Cright%29%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Ceta_%7Bt%7D%5Cright%5C%7D%7B%2C%7D%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D) 均与 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bs%7D%5Cright%5C%7D) 无关，可以证明该模型与原自回归模型具有相同的自协方差函数。之后给出证明。

因此归纳得到一阶自回归模型的几个结论

- ![[公式]](https://www.zhihu.com/equation?tex=%7Ca%7C%3C1) 时序列可以稳定下来，称系统是稳定的
- ![[公式]](https://www.zhihu.com/equation?tex=a%3D%5Cpm+1) 序列振荡越来越大，呈爆炸型
- ![[公式]](https://www.zhihu.com/equation?tex=%7Ca%7C%3E1) 时序列也不能稳定。 ![[公式]](https://www.zhihu.com/equation?tex=%7Ca%7C+%5Cgeq+1) 时称序列的非稳定的

建立在平稳性讨论的基础上，就可以给出自回归模型的定义了。

### 一、AR(p)模型的定义

定义 如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D%5Csim+%5Cmathrm%7BWN%7D%5Cleft%28%5Cmathrm%7B0%7D%2C+%5Csigma%5E%7B2%7D%5Cright%29) ，且实数 ![[公式]](https://www.zhihu.com/equation?tex=a_%7B1%7D%2C+a_%7B2%7D%2C+%5Cldots%2C+a_%7Bp%7D%5Cleft%28a_%7Bp%7D+%5Cneq+0%5Cright%29) 使得多项式 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D1-%5Csum_%7Bi%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+z%5E%7Bj%7D) 的**根都在单位圆外**，那么称 ![[公式]](https://www.zhihu.com/equation?tex=p) 阶差分方程

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

为 ![[公式]](https://www.zhihu.com/equation?tex=p) 阶自回归模型，简称**AR(p)**模型。满足该模型的平稳时间序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 称为**平稳解**，或称为**AR(p)序列**，其中 ![[公式]](https://www.zhihu.com/equation?tex=+%5Cmathbf%7Ba%7D%3D%5Cleft%28a_%7B1%7D%2C+a_%7B2%7D%2C+%5Ccdots%2C+a_%7Bp%7D%5Cright%29%5E%7BT%7D) 为**自回归系数**。把特征多项式的根在单位圆外的条件称为**最小相位条件**，或**稳定性条件**。

如果引入推移算子，该模型也可写作 ![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D) 

分析完定义后，就要来找该模型的特解了，之前我们对一阶情形用递推的方法得到一个特解，但对于高阶自回归模型，递推法就没那么奏效了，那么应该如何做呢？

一个很奇妙但也很自然的想法是，能不能把 ![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29) 除过去？

### 二、AR(p)的平稳解

设多项式 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29) 的互异根为 ![[公式]](https://www.zhihu.com/equation?tex=z_%7B1%7D%2C+z_%7B2%7D%2C+%5Cldots%2C+z_%7Bk%7D) ，取 ![[公式]](https://www.zhihu.com/equation?tex=1%3C%5Crho%3C%5Cmin+%5Cleft%5C%7B%5Cleft%7Cz_%7Bj%7D%5Cright%7C%5Cright%5C%7D) ，那么该多项式的倒数 ![[公式]](https://www.zhihu.com/equation?tex=A%5E%7B-1%7D%28z%29%3D1+%2F+A%28z%29) 在 ![[公式]](https://www.zhihu.com/equation?tex=%5C%7Bz%3A%7Cz%7C+%5Cleq+%5Crho%5C%7D) 内是解析函数，可通过泰勒展开得到

![[公式]](https://www.zhihu.com/equation?tex=A%5E%7B-1%7D%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+z%5E%7Bj%7D%2C%7Cz%7C+%5Cleq+%5Crho%5C%5C) 

而欲使该无穷级数有意义，应该有通项 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7C%5Cpsi_%7Bj%7D+%5Crho%5E%7Bj%7D%5Cright%7C+%5Crightarrow+0) ，于是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi_%7Bj%7D%3Do%5Cleft%28%5Crho%5E%7B-j%7D%5Cright%29) 

事实上我们有如下的引理（该引理不作证明）：

**引理** 如果多项式 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+%5Cphi_%7Bj%7D+z%5E%7Bj%7D) 满足最小相位条件，即

![[公式]](https://www.zhihu.com/equation?tex=A%28z%29+%5Cneq+0%2C+%5Cquad+%5Cforall%7Cz%7C+%5Cleq+1%5C%5C) 

则存在 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdelta%3E0) 使得

![[公式]](https://www.zhihu.com/equation?tex=A%5E%7B-1%7D%28z%29+%5Ctriangleq+%5Cfrac%7B1%7D%7BA%28z%29%7D%3D%5Csum_%7Bi%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+z%5E%7Bj%7D%2C+%5Cquad%7Cz%7C+%5Cleq+1%2B%5Cdelta%5C%5C) 

- 就是说只要特征多项式满足了最小相位条件，求逆就是有意义的！

并且对于**有界**的数列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7By_%7Bt%7D%5Cright%5C%7D) 和**平稳**的时间序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) ，有

![[公式]](https://www.zhihu.com/equation?tex=y_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+A%28%5Cmathscr%7BB%7D%29+y_%7Bt%7D%3DA%28%5Cmathscr%7BB%7D%29+A%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+y_%7Bt%7D%5C%5CX_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DA%28%5Cmathscr%7BB%7D%29+A%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%2C+%5Cquad+%5Ctext+%7B+a.s.+%7D%5C%5C) 

因此AR(p)模型的平稳解为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cpsi_%7Bj%7D%5Cright%5C%7D) 称为平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 的**Wold系数**。并且如果平稳解存在，则**必然**为上面的形式！因为如果 ![[公式]](https://www.zhihu.com/equation?tex=Y_t) 也是一个平稳解，则

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+A%28%5Cmathscr%7BB%7D%29+Y_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%3DX_%7Bt%7D%5C%5C) 

### 三、AR(p)的平稳解及通解定理

**定理** AR(p)模型的通解具有如下形式（**上面所求特解+齐次方程通解**）

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+%5Csum_%7Bl%3D0%7D%5E%7Br%28j%29-1%7D+U_%7Bl%2C+j%7D+t%5E%7Bl%7D+z_%7Bj%7D%5E%7B-t%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

下面举例说明Wold系数如何计算

### 四、Wold系数的计算

**方法一：级数展开**

将原特征多项式取倒数后，利用泰勒展开得到

![[公式]](https://www.zhihu.com/equation?tex=A%5E%7B-1%7D%28z%29+%5Ctriangleq+%5Cfrac%7B1%7D%7BA%28z%29%7D%3D%5Csum_%7Bi%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+z%5E%7Bj%7D%5C%5C) 

方法二：递推公式

记 ![[公式]](https://www.zhihu.com/equation?tex=a_%7B0%7D%3D-1) ，则 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D-%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+a_%7Bj%7D+z%5E%7Bj%7D) ，计算得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7D+1%3DA%28z%29+A%5E%7B-1%7D%28z%29%3D-%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+a_%7Bj%7D+z%5E%7Bj%7D+%5Csum_%7Bk%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bk%7D+z%5E%7Bk%7D+%5C%5C+%3D-%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+%5Csum_%7Bk%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cpsi_%7Bk%7D+z%5E%7Bj%2Bk%7D%3D-%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+%5Csum_%7Bm%3Dj%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cpsi_%7Bm-j%7D+z%5E%7Bm%7D+%5C%5C+%3D-%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+%5Csum_%7Bm%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cpsi_%7Bm-j%7D+z%5E%7Bm%7D%3D-%5Csum_%7Bm%3D0%7D%5E%7B%5Cinfty%7D%5Cleft%28%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cpsi_%7Bm-j%7D%5Cright%29+z%5E%7Bm%7D+%5Cend%7Barray%7D%5C%5C) 

其中第四个等号作变量替换 ![[公式]](https://www.zhihu.com/equation?tex=m%3Dj%2Bk) ，第五个等号需要注意到Wold系数下标从0开始，如果为负都约定为0，对比系数得到![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi_%7B0%7D%3D1%2C+%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cpsi_%7Bm-j%7D%3D0%2C+m%3E0) ，于是有递推关系如下：

![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi_%7Bm%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cpsi_%7Bm-j%7D%2C+%5Cquad+m%3D1%2C2%2C+%5Cldots%5C%5C) 

**注意**：上面的下标 ![[公式]](https://www.zhihu.com/equation?tex=j) 是**从1开始**加的！并且这个形式是一个**齐次差分方程**，可以利用之前讨论过的结果来写出它的通解。1<\rho<\min \left\{\left|z_{j}\right|\right\}

**例** 求出下面自回归模型的平稳解（留作练习）

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D-0.7+X_%7Bt-1%7D%2B0.1+X_%7Bt-2%7D%3D%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+%5Cvarepsilon_%7Bt%7D+%5Csim+W+N%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29%5C%5C) 

### 五、通解和平稳解的关系

AR(p)模型通解和平稳解之间相差了一个齐次差分方程的通解，而我们说只要满足最小相位条件，齐次差分方程的通解就是指数衰减的，因此有

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7CY_%7Bt%7D-X_%7Bt%7D%5Cright%7C%3D%5Cleft%7C%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+%5Csum_%7Bl%3D0%7D%5E%7Br%28j%29-1%7D+U_%7Bl%2C+j%7D+t%5E%7B%5Cprime%7D+z_%7Bj%7D%5E%7B-t%7D%5Cright%7C%3Do%5Cleft%28%5Crho%5E%7B-t%7D%5Cright%29%2C+%5Ctext+%7B+a.s.+%7D+t+%5Crightarrow+%5Cinfty%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=1%3C%5Crho%3C%5Cmin+%5Cleft%5C%7B%5Cleft%7Cz_%7Bj%7D%5Cright%7C%5Cright%5C%7D) ，这个事实是模拟产生AR(p)序列的基础。

### 六、AR(p)序列的模拟

取 ![[公式]](https://www.zhihu.com/equation?tex=p) 个初始值，不断产生白噪声，由递推关系得到一个序列，并从某个比较大的 ![[公式]](https://www.zhihu.com/equation?tex=t) 开始记录之后的数值，这样得到的序列受齐次差分方程通解的影响就比较小了。需要注意，如果根与单位圆比较靠近，那么 ![[公式]](https://www.zhihu.com/equation?tex=t) 的截断位置应该更靠后。

**例** 设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D+%5Csim+W+N%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29) ,对于两个模型 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D-%5Cfrac%7B1%7D%7Ba%7D+X_%7Bt-1%7D%3D%5Cvarepsilon_%7Bt%7D+%5Cquad+X_%7Bt%7D-a+X_%7Bt-1%7D%3D%5Ceta_%7Bt%7D) ，试求 ![[公式]](https://www.zhihu.com/equation?tex=%5Ceta_%7Bt%7D) 

**证** 取 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D1-a+z) ，令 ![[公式]](https://www.zhihu.com/equation?tex=%5Ceta_%7Bt%7D%3DA%28B%29+X_%7Bt%7D) 为平稳序列。根据谱密度函数的性质有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+f_%7B%5Ceta%7D%28%5Clambda%29+%26%3D%7C%5Cleft.A%5Cleft%28e%5E%7Bi+%5Clambda%7D%5Cright%29%5Cright%7C%5E%7B2%7D+f_%7BX%7D%28%5Clambda%29+%5C%5C+%26%3D%5Cleft%7C1-a+e%5E%7Bi+%5Clambda%7D%5Cright%7C%5E%7B2%7D+%5Ccdot%5Cleft%7C1-%5Cfrac%7B1%7D%7Ba%7D+e%5E%7B-i+%5Clambda%7D%5Cright%7C%5E%7B-2%7D+f_%7B%5Cvarepsilon%7D%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D+a%5E%7B2%7D%7D%7B2+%5Cpi%7D+%5Cend%7Baligned%7D%5C%5C) 

第一和第二个等号是需要记忆的公式，在线性滤波部分已经推导过，最后一个等号利用白噪声的谱密度函数为定值 ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Csigma%5E%7B2%7D+%7D%7B2+%5Cpi%7D) ，因此 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Ceta_%7Bt%7D%5Cright%5C%7D+%5Csim+W+N%5Cleft%280%2C+a%5E2%5Csigma%5E%7B2%7D%5Cright%29) 也是白噪声。

**说明**：即使特征多项式的根在单位圆内，通过根的倒数替代后，也能得到一个符合最小相位条件的AR(p)模型。

## 2.3 AR(p)模型的谱密度和Yule-Walker方程

**问题**：在实际问题中，怎么判断一个序列是否为AR(p)序列？如果已知为AR(p)序列，又应该如何求自回归系数？这一部分将给出解答。

### 一、AR(p)的自协方差

我们已经得到模型的平稳解为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5C%5C) 

这实际上是一个线性平稳序列，根据之前推导的结果，有

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3DE%5Cleft%28X_%7Bt%2Bk%7D+X_%7Bt%7D%5Cright%29%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cpsi_%7Bj%2Bk%7D%2C+%5Cquad+k%3D0%2C1%2C+%5Cldots%5C%5C) 

并且该自协方差函数会很快趋向0，这也是线性平稳序列的性质之一，推导如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cleft%7C%5Cgamma_%7Bk%7D%5Cright%7C+%26+%5Cleq+%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D%5Cleft%7C%5Cpsi_%7Bj%7D%5Cright%7C+%5Ccdot%5Cleft%7C%5Cpsi_%7Bj%2Bk%7D%5Cright%7C+%5Cleq+%5Csigma%5E%7B2%7D%5Cleft%28%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D%5Cleft%7C%5Cpsi_%7Bj%7D%5Cright%7C%5Cright%29%5Cleft%28%5Csum_%7Bl%3Dk%7D%5E%7B%5Cinfty%7D%5Cleft%7C%5Cpsi_%7Bl%7D%5Cright%7C%5Cright%29+%5C%5C+%26+%5Cleq+c_%7B0%7D+%5Csum_%7Bl%3Dk%7D%5E%7B%5Cinfty%7D+%5Crho%5E%7B-l%7D+%5Cleq+c_%7B1%7D+%5Crho%5E%7B-k%7D+%5Cend%7Baligned%7D%5C%5C) 

其中第三步利用 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmid+%5Cpsi_%7Bj%7D%7C%3Do%5Cleft%28%5Crho%5E%7B-j%7D%5Cright%29) 以及由此得到的Wold系数的绝对可和性。因此如果一个序列是AR(p)模型，那么它的自协方差函数会衰减的很快，称为**短记忆性**，这也是**直观判断**一个序列是否为AR（p）模型的依据。

### 二、AR(p)的谱密度

根据线性平稳序列的谱密度公式得到AR(p)模型的谱密度为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B2%7D%5C%5C) 

而这个级数的通项又能够用特征多项式来表示，为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D+%5Cfrac%7B1%7D%7B%5Cleft%7CA%5Cleft%28e%5E%7Bi+%5Clambda%7D%5Cright%29%5Cright%7C%5E%7B2%7D%7D%5C%5C) 

从这个形式不难看出：如果特征多项式有一个靠近单位圆的根 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bj%7D+e%5E%7Bi+%5Clambda_%7Bj%7D%7D) ，那么 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7CA%5Cleft%28e%5E%7Bi+%5Clambda_%7Bj%7D%7D%5Cright%29%5Cright%7C) 会接近0，进而造成谱密度在 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda%3D%5Clambda_%7Bj%7D) 处有一个**峰值**.

### 三、谱密度函数的自协方差函数反演公式

回顾谱密度函数的定义，它是满足

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+e%5E%7Bi+k+%5Clambda%7D+f%28%5Clambda%29+d+%5Clambda%5C%5C) 

的非负可积函数，下面给出利用自协方差函数来导出谱密度的公式。

**定理** 如果平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 有绝对可和的自协方差函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cgamma_%7Bk%7D%5Cright%5C%7D) ，则该平稳序列有谱密度，其谱密度可以表示为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Cgamma_%7Bk%7D+e%5E%7B-i+k+%5Clambda%7D%5C%5C) 

且由于谱密度函数是实值函数，所以用欧拉公式展开去掉复数项，上式还可以写成

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Cgamma_%7Bk%7D+%5Ccos+%28k+%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D%5Cleft%5B%5Cgamma_%7B0%7D%2B2+%5Csum_%7Bk%3D1%7D%5E%7B%5Cinfty%7D+%5Cgamma_%7Bk%7D+%5Ccos+%28k+%5Clambda%29%5Cright%5D%5C%5C) 

**证明** 将上式**代入谱密度函数的定义**，看是否满足。

由于自协方差函数绝对可和，所以定理给出的无穷级数是收敛的，又因为谱密度是连续的，所以积分和求和可以进行交换，得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+f%28%5Clambda%29+e%5E%7Bi+j+%5Clambda%7D+d+%5Clambda%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Cgamma_%7Bk%7D+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+e%5E%7B-i%28k-j%29+%5Clambda%7D+d+%5Clambda%3D%5Cgamma_%7Bj%7D%5C%5C) 

最后一个等号是利用欧拉公式将指数变为两个三角函数，利用三角函数在一个周期内的积分为0，最后保留 ![[公式]](https://www.zhihu.com/equation?tex=k%3D0) 时的一项.

接下来再验证下**非负性**，设 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+%5Cldots%2C+X_%7BN%7D) 为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 的观测值，引进

![[公式]](https://www.zhihu.com/equation?tex=I_%7BN%7D%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi+N%7D%5Cleft%7C%5Csum_%7Bj%3D1%7D%5E%7BN%7D+X_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B2%7D%2C+%5Cquad+%5Clambda+%5Cin%5B-%5Cpi%2C+%5Cpi%5D%5C%5C) 

称为 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+%5Cldots%2C+X_%7BN%7D) 的**周期图**。

引入周期图的概念，主要是因为它的形式与定理中给出的反演公式十分相关。对周期图求数学期望，并令为 ![[公式]](https://www.zhihu.com/equation?tex=f_%7BN%7D%28%5Clambda%29%3D%5Coperatorname%7BE%7DI_%7BN%7D%28%5Clambda%29) 则，则有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+0+%5Cleq+f_%7BN%7D%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi+N%7D+%5Csum_%7Bk%3D1%7D%5E%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7BN%7D+%5Cgamma_%7Bk-j%7D+e%5E%7B-i%28k-j%29+%5Clambda%7D+%5C%5C+%3D%5Cfrac%7B1%7D%7B2+%5Cpi+N%7D+%5Csum_%7Bm%3D1-N%7D%5E%7BN-1%7D+%5Csum_%7Bk%3D1%2B%7Cm%7C%7D%5E%7BN%7D+%5Cgamma_%7Bm%7D+e%5E%7B-i+m+%5Clambda%7D+%5C%5C+%3D%5Cfrac%7B1%7D%7B2+%5Cpi+N%7D+%5Csum_%7Bm%3D1-N%7D%5E%7BN-1%7D%28N-%7Cm%7C%29+%5Cgamma_%7Bm%7D+e%5E%7B-i+m+%5Clambda%7D+%5C%5C+%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Csum_%7Bm%3D1-N%7D%5E%7BN-1%7D+%5Cgamma_%7Bm%7D+e%5E%7B-i+m+%5Clambda%7D-%5Cfrac%7B1%7D%7B2+%5Cpi+N%7D+%5Csum_%7Bm%3D1-N%7D%5E%7BN-1%7D%7Cm%7C+%5Cgamma_%7Bm%7D+e%5E%7B-i+m+%5Clambda%7D+%5Cend%7Barray%7D%5C%5C) 

其中第一个等号就把周期图中的模平方变成一对共轭复数的乘积，求期望就有自协方差函数了。第二个等号是求和指标的变换。

最后式子中的第一项的极限就是定理中谱密度的形式，只需要说明第二项趋于0，而这个是Kronecker引理的一个特例，引理的内容如下。

**Kronecker引理** 如果 ![[公式]](https://www.zhihu.com/equation?tex=b_n) 单调上升趋于无穷大，复数列 ![[公式]](https://www.zhihu.com/equation?tex=a_n) 的无穷级数收敛，则

![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bn%5Crightarrow%5Cinfty%7D+%5Cfrac%7B1%7D%7Bb_n%7D+%5Csum_%7Bj%3D1%7D%5Enb_ja_j%3D0%5C%5C) 

这个引理的证明留作练习，考试时可以直接使用。

### 四、AR(p)谱密度的自协方差函数表示

**推论** 由上面的定理可以得到，AR(p)模型的谱密度为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Cgamma_%7Bk%7D+e%5E%7B-i+k+%5Clambda%7D%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D+%5Cfrac%7B1%7D%7B%5Cleft%7CA%5Cleft%28e%5E%7Bi+%5Clambda%7D%5Cright%29%5Cright%7C%5E%7B2%7D%7D%5C%5C) 

其中前面是由定理给出的，后面那个是由线性滤波公式得出的。

**例** 给定自协方差函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Cfrac%7B4+%5Csigma%5E%7B2%7D%7D%7B3%7D+2%5E%7B-k%7D%2C+%5Cquad+k+%5Cgeq+0) ，求谱密度。

**解** 利用定理得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+f%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Cgamma_%7Bk%7D+e%5E%7B-i+k+%5Clambda%7D+%5C%5C+%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Cfrac%7B4%7D%7B3%7D+2%5E%7B-%7Ck%7C%7D+e%5E%7B-ik%5Clambda%7D%3D%5Cfrac%7B2+%5Csigma%5E%7B2%7D%7D%7B3+%5Cpi%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+2%5E%7B-%7Ck%7C%7D+e%5E%7B-ik%5Clambda%7D+%5Cend%7Barray%7D%5C%5C) 

令 ![[公式]](https://www.zhihu.com/equation?tex=z%3De%5E%7B-i+%5Clambda%7D+%2F+2) ，这样不容易错！然后将区间分为两部分

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7D+%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+2%5E%7B%5Cdashv+k+%5Cmid%7D+e%5E%7B-i+k%5Clambda%7D%3D%5Csum_%7Bk%3D0%7D%5E%7B%5Cinfty%7D+z%5E%7Bk%7D%2B%5Csum_%7Bk%3D1%7D%5E%7B%5Cinfty%7D+%5Cbar%7Bz%7D%5E%7Bk%7D%3D%5Cfrac%7B1%7D%7B1-z%7D%2B%5Cfrac%7B%5Cbar%7Bz%7D%7D%7B1-%5Cbar%7Bz%7D%7D+%5C%5C+%3D%5Cfrac%7B1-%7Cz%7C%5E%7B2%7D%7D%7B%7C1-z%7C%5E%7B2%7D%7D%3D%5Cfrac%7B3+%2F+4%7D%7B%7C1-z%7C%5E%7B2%7D%7D+%5Cend%7Barray%7D%5C%5C) 

故 ![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7Ba%5E%7B2%7D%7D%7B2+%5Cpi%7D+%5Ctimes+%5Cfrac%7B1%7D%7B%7C1-z%7C%5E%7B2%7D%7D+) ，这实际上是一个AR(1)模型，特征多项式为 ![[公式]](https://www.zhihu.com/equation?tex=1-z) 

### 五、白噪声与平稳解的关系

再把平稳解为写一遍

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5C%5C) 

由控制收敛定理得到

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28X_%7Bt%7D+%5Cvarepsilon_%7Bt%2Bk%7D%5Cright%29%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+E%5Cleft%28%5Cvarepsilon_%7Bt-j%7D+%5Cvarepsilon_%7Bt%2Bk%7D%5Cright%29%3D0%2Ck%5Cgeq+1%5C%5C) 

即 ![[公式]](https://www.zhihu.com/equation?tex=X_t) **与将来的白噪声不相关**。并且如果白噪声时独立序列，则![[公式]](https://www.zhihu.com/equation?tex=X_t) 与将来的白噪声独立。

### 六、AR(p)模型的Yule-Walker方程

下面开始讨论参数估计问题。

对AR(p)模型两边同乘 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt-k%7D) 并取数学期望，得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3Da_%7B1%7D+%5Cgamma_%7Bk-1%7D%2Ba_%7B2%7D+%5Cgamma_%7Bk-2%7D%2B%5Ccdots%2Ba_%7Bp%7D+%5Cgamma_%7Bk-p%7D%2C+%5Cquad+k+%5Cgeq+1%5C%5C) 

这实际上是一个差分方程，可以用推移算子表示为

![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+%5Cgamma_%7Bk%7D%3D0%2C+%5Cquad+k+%5Cgeq+1%5C%5C) 

当 ![[公式]](https://www.zhihu.com/equation?tex=k%3D0) 时

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7B0%7D+%26%3DE+X_%7Bt%7D%5E%7B2%7D%3DE%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%2B%5Cvarepsilon_%7Bt%7D%5Cright%29%5E%7B2%7D+%5C%5C+%26%3DE%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%5Cright%29%5E%7B2%7D%2BE+%5Cvarepsilon_%7Bt%7D%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C%3D%5Csum_%7Bk%3D1%7D%5E%7Bp%7D+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bk%7D+a_%7Bj%7D+%5Cgamma_%7Bk-j%7D%2B%5Csigma%5E%7B2%7D%3D%5Csum_%7Bk%3D1%7D%5E%7Bp%7D+a_%7Bk%7D+%5Cgamma_%7Bk%7D%2B%5Csigma%5E%7B2%7D%5C%5C) 

第三个等号利用 ![[公式]](https://www.zhihu.com/equation?tex=X) 与白噪声不相关，第四个等号将平方写作两个求和相乘，原本是同一个求和指标，现在换成两个，第五个等号利用递推公式 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bk-j%7D) ，所以

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E%7B2%7D%3D%5Cgamma_%7B0%7D-%5Csum_%7Bk%3D1%7D%5E%7Bp%7D+a_%7Bk%7D+%5Cgamma_%7Bk%7D%5C%5C) 

这一推导旨在得出**自协方差函数与模型中白噪声的方差的关系**！这就可以得到参数估计了。总结一下前面的结果，就得到下面的定理。

**定理Yule-Walker方程** AR(p)序列的自协方差函数满足

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3Da_%7B1%7D+%5Cgamma_%7Bk-1%7D%2Ba_%7B2%7D+%5Cgamma_%7Bk-2%7D%2B%5Ccdots%2Ba_%7Bp%7D+%5Cgamma_%7Bk-p%7D%2C+%5Cquad+k+%5Cgeq+1%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E%7B2%7D%3D%5Cgamma_%7B0%7D-a_%7B1%7D+%5Cgamma_%7B1%7D-a_%7B2%7D+%5Cgamma_%7B2%7D-%5Ccdots-a_%7Bp%7D+%5Cgamma_%7Bp%7D%3DA%28%5Cmathscr%7BB%7D%29+%5Cgamma_%7B0%7D%5C%5C) 

下面我们给出另外一种思路，把AR(p)和一般平稳序列的Yule-Walker方程统一起来引入。

把 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%2C+X_%7Bt%2B1%7D%2C+%5Cldots%2C+X_%7Bt%2Bn-1%7D) 的递推式写成矩阵的形式，即

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+X_%7Bt%7D+%5C%5C+X_%7Bt%2B1%7D+%5C%5C+%5Cvdots+%5C%5C+X_%7Bt%2Bn-1%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bllll%7D+X_%7Bt-1%7D+%26+X_%7Bt-2%7D+%26+%5Cldots+%26+X_%7Bt-n%7D+%5C%5C+X_%7Bt%7D+%26+X_%7Bt-1%7D+%26+%5Cldots+%26+X_%7Bt%2B1-n%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+X_%7Bt%2Bn-2%7D+%26+X_%7Bt%2Bn-3%7D+%26+%5Cldots+%26+X_%7Bt-1%7D+%5Cend%7Barray%7D%5Cright%29+%5Cmathbf%7Ba%7D_%7Bn%7D%2B%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+%5Cvarepsilon_%7Bt%7D+%5C%5C+%5Cvarepsilon_%7Bt%2B1%7D+%5C%5C+%5Cvdots+%5C%5C+%5Cvarepsilon_%7Bt%2Bn-1%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D_%7Bn%7D%3D%5Cleft%28a_%7Bn%2C+1%7D%2C+a_%7Bn%2C+2%7D%2C+%5Cldots%2C+a_%7Bn%2C+n%7D%5Cright%29%5E%7BT%7D+%5Ctriangleq%5Cleft%28a_%7B1%7D%2C+a_%7B2%7D%2C+%5Cldots%2C+a_%7Bp%7D%2C+0%2C+%5Cldots%2C+0%5Cright%29%5E%7BT%7D) 

相当于对AR(p)模型进行扩展，递推式变为n阶，然后两边同乘 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt-1%7D) 并求期望得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bn%7D%3D%5CGamma_%7Bn%7D+%5Cmathbf%7Ba%7D_%7Bn%7D%2C+%5Cquad+n+%5Cgeq+p%5C%5C) 

其中

![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bn%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bcccc%7D+%5Cgamma_%7B0%7D+%26+%5Cgamma_%7B1%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bn-1%7D+%5C%5C+%5Cgamma_%7B1%7D+%26+%5Cgamma_%7B0%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bn-2%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+%5Cgamma_%7Bn-1%7D+%26+%5Cgamma_%7Bn-2%7D+%26+%5Ccdots+%26+%5Cgamma_%7B0%7D+%5Cend%7Barray%7D%5Cright%29%2C%5Cgamma_%7Bn%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+%5Cgamma_%7B1%7D+%5C%5C+%5Cgamma_%7B2%7D+%5C%5C+%5Ccdots+%5C%5C+%5Cgamma_%7Bn%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

上面的等式中矩阵如果写开，实际上就是我们之前得到的Yule-Walker方程，同理计算白噪声的方差如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7B0%7D+%26%3DE+X_%7Bt%7D%5E%7B2%7D%3DE%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%2B%5Cvarepsilon_%7Bt%7D%5Cright%29%5E2+%5C%5C+%26%3DE%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%5Cright%29%5E%7B2%7D%2BE+%5Cvarepsilon_%7Bt%7D%5E%7B2%7D%5C%5C%26%3D%5Cmathbf%7BE%7D%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+a_%7Bn+j%7D+X_%7Bt-j%7D%5Cright%29%5E%7B2%7D%2B%5Csigma%5E%7B2%7D%5C%5C%26%3D%5Cmathbf%7Ba%7D_%7Bn%7D%5E%7BT%7D+%5CGamma_%7Bn%7D+%5Cmathbf%7Ba%7D_%7Bn%7D%2B%5Csigma%5E%7B2%7D%3D%5Cmathbf%7Ba%7D_%7Bn%7D%5E%7BT%7D+%5Cgamma_%7Bn%7D%2B%5Csigma%5E%7B2%7D%2C+%5Cquad+n+%5Cgeq+p+%5Cend%7Baligned%7D%5C%5C) 

注意第三个等号中，p项变成了n项。总结成如下定理。

**定理** 由矩阵推导得到AR(p)和一般平稳序列的Yule-Walker方程为

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bn%7D%3D%5CGamma_%7Bn%7D+%5Cmathbf%7Ba%7D_%7Bn%7D%2C+%5Cquad+%5Cgamma_%7B0%7D%3D%5Cgamma_%7Bn%7D%5E%7BT%7D+%5Cmathbf%7Ba%7D_%7Bn%7D%2B%5Csigma%5E%7B2%7D%2C+%5Cquad+n+%5Cgeq+p%5C%5C) 

对于一般的平稳序列，当 ![[公式]](https://www.zhihu.com/equation?tex=k+%3E+p) 时， ![[公式]](https://www.zhihu.com/equation?tex=a_%7Bn%2Ck%7D) 不一定为0，但是只要满足对所有 ![[公式]](https://www.zhihu.com/equation?tex=k%3Ep) 都有 ![[公式]](https://www.zhihu.com/equation?tex=a_%7Bn%2Ck%7D) 为0，那么就一定是AR(p)序列，后面会说明这是充分必要的。

特别地，当 ![[公式]](https://www.zhihu.com/equation?tex=n%3Dp) 时，有

![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bp%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+a_%7B1%7D+%5C%5C+a_%7B2%7D+%5C%5C+%5Ccdots+%5C%5C+a_%7Bp%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cgamma_%7B1%7D+%5C%5C+%5Cgamma_%7B2%7D+%5C%5C+%5Ccdots+%5C%5C+%5Cgamma_%7Bp%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

这样写的好处是，只要自协方差函数知道了，就可以估计回归系数 ![[公式]](https://www.zhihu.com/equation?tex=a_k) ，此外还可以引进 ![[公式]](https://www.zhihu.com/equation?tex=%5Cphi_%7B0%7D%3D1%2C+%5Cphi_%7B1%7D%3D-a_%7B1%7D%2C+%5Cldots%2C+%5Cphi_%7Bp%7D%3D-a_%7Bp%7D) ，将Yule-Walker方程写成

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bcccc%7D+%5Cgamma_%7B0%7D+%26+%5Cgamma_%7B1%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bp%7D+%5C%5C+%5Cgamma_%7B1%7D+%26+%5Cgamma_%7B0%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bp-1%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+%5Cgamma_%7Bp%7D+%26+%5Cgamma_%7Bp-1%7D+%26+%5Ccdots+%26+%5Cgamma_%7B0%7D+%5Cend%7Barray%7D%5Cright%29%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cphi_%7B0%7D+%5C%5C+%5Cphi_%7B1%7D+%5C%5C+%5Cvdots+%5C%5C+%5Cphi_%7Bp%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Csigma%5E%7B2%7D+%5C%5C+0+%5C%5C+%5Cvdots+%5C%5C+0+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

***推论** 定义 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi_%7Bk%7D%3D0%2Ck%3C0) ，则AR(p)模型的自协方差函数满足的差分方程为

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D-%5Cleft%28a_%7B1%7D+%5Cgamma_%7Bk-1%7D%2Ba_%7B2%7D+%5Cgamma_%7Bk-2%7D%2B%5Ccdots%2Ba_%7Bp%7D+%5Cgamma_%7Bk-p%7D%5Cright%29%3D%5Csigma%5E%7B2%7D+%5Cpsi_%7B-k%7D%5C%5C) 

**证明** ![[公式]](https://www.zhihu.com/equation?tex=k+%5Cgeq+0)就是Yule-walker方程，下面对 ![[公式]](https://www.zhihu.com/equation?tex=k%3C0) 讨论。

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+%5Cgamma_%7Bk%7D-%5Cleft%28a_%7B1%7D+%5Cgamma_%7Bk-1%7D%2Ba_%7B2%7D+%5Cgamma_%7Bk-2%7D%2B%5Ccdots%2Ba_%7Bp%7D+%5Cgamma_%7Bk-p%7D%5Cright%29+%5C%5C+%3D%26+E%5Cleft%5BX_%7Bt-k%7D%5Cleft%28X_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%5Cright%29%5Cright%5D+%5C%5C+%3D%26+E%5Cleft%28X_%7Bt-k%7D+%5Cvarepsilon_%7Bt%7D%5Cright%29%3DE%5Cleft%5B%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cvarepsilon_%7Bt-k-j%7D+%5Cvarepsilon_%7Bt%7D%5Cright%5D%3D%5Csigma%5E%7B2%7D+%5Cpsi_%7B-k%7D+%5Cend%7Baligned%7D%5C%5C) 

第三个等号用Wold系数表示 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt-k%7D) ，第四个等号只保留 ![[公式]](https://www.zhihu.com/equation?tex=t-k-j%3Dt) 的项

### 七、自协方差函数的周期性分析（了解）

设特征多项式有p个**互异根** ![[公式]](https://www.zhihu.com/equation?tex=z_%7Bj%7D%3D%5Crho_%7Bj%7D+e%5E%7Bi+%5Clambda_%7Bj%7D%7D%2C+j%3D1%2C+%5Cldots%2C+p) ，则可得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7Bt%7D+%26%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+%5Csigma%5E%7B2%7D+%5Cpsi_%7B-t%7D+%5C%5C+%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+c_%7Bj%7D+A%5E%7B-1%7D%5Cleft%28z_%7Bj%7D%5E%7B-1%7D%5Cright%29+z_%7Bj%7D%5E%7B-t%7D+%5C%5C+%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+A_%7Bj%7D+%5Crho_%7Bj%7D%5E%7B-t%7D+%5Ccos+%5Cleft%28%5Clambda_%7Bj%7D+t%2B%5Ctheta_%7Bj%7D%5Cright%29%2C+%5Cquad+t+%5Cgeq+0+%5Cend%7Baligned%7D%5C%5C) 



## 2.3 AR(p)模型的谱密度和Yule-Walker方程（续）

### 七、自协方差函数的周期性分析（续）

上一讲的最后提到，自协方差函数最后能够写成一个带有三角函数的求和形式，因而具有周期性，但计算过程跳跃比较大，这一讲首先将其补充完整。

由于考虑的是具有p个互异根的情形，所以特征多项式可以表示为

![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D%5Cprod_%7Bj%3D1%7D%5E%7Bp%7D%5Cleft%281-z+%2F+z_%7Bj%7D%5Cright%29%5C%5C) 

取倒数后，就变成了一个有理分式，其中分母是连乘积的形式，根据代数理论可以将该有理分式分解得到

![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%5E%7B-1%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+%5Cfrac%7Bc_%7Bj%7D%7D%7B1-z+%2F+z_%7Bj%7D%7D%5C%5C) 

事实上系数 ![[公式]](https://www.zhihu.com/equation?tex=c_j) 可以用 ![[公式]](https://www.zhihu.com/equation?tex=z_1%2C...%2Cz_n) 来表示出来，这里就默认是已知的，进而有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7Bt%7D+%26%3DA%5E%7B-1%7D%28%5Cmathrm%7BB%7D%29+%5Csigma%5E%7B2%7D+%5Cpsi_%7B-t%7D%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+c_%7Bj%7D%5Cleft%281-z_%7Bj%7D%5E%7B-1%7D+%5Cmathrm%7BB%7D%5Cright%29%5E%7B-1%7D+%5Cpsi_%7B-t%7D+%5C%5C+%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+c_%7Bj%7D+%5Csum_%7Bl%3D0%7D%5E%7B%5Cinfty%7D+z_%7Bj%7D%5E%7B-l%7D+%5Cmathrm%7BB%7D%5E%7Bl%7D+%5Cpsi_%7B-t%7D+%5C%5C+%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+c_%7Bj%7D+%5Csum_%7Bl%3D0%7D%5E%7B%5Cinfty%7D+z_%7Bj%7D%5E%7B-l%7D+%5Cpsi_%7B-t%2Bl%7D+%5C%5C+%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+c_%7Bj%7D+%5Csum_%7Bl%3Dt%7D%5E%7B%5Cinfty%7D+z_%7Bj%7D%5E%7B-l%7D+%5Cpsi_%7Bl-t%7D+%5C%5C+%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+c_%7Bj%7D+%5Csum_%7Bl%3Dt%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bl-t%7D+z_%7Bj%7D%5E%7B-l%2Bt%7D+z_%7Bj%7D%5E%7B-t%7D+%5C%5C+%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+c_%7Bj%7D+A%5E%7B-1%7D%5Cleft%28z_%7Bj%7D%5E%7B-1%7D%5Cright%29+z_%7Bj%7D%5E%7B-t%7D+%5Cend%7Baligned%7D%5C%5C) 

**第一个**等号是Yule-Walker方程的推论，**第二个**等号是将有理分式分解的结果，**第三个**等号将分式泰勒展开为幂级数，**第四个**等号将后移算子作用到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi) 上，**第五个**等号利用Wold系数下标大于等于0，即小于0的Wold系数为0，**第六个**等号将 ![[公式]](https://www.zhihu.com/equation?tex=z_j%5E%7B-t%7D) 拆成两部分旨在拼凑幂级数，**第七个**等号即Wold系数的定义。

注意到 ![[公式]](https://www.zhihu.com/equation?tex=z_%7Bj%7D%3D%5Crho_%7Bj%7D+e%5E%7Bi+%5Clambda_%7Bj%7D%7D) 是复数，而自协方差函数为实数，进而利用每个复数根 ![[公式]](https://www.zhihu.com/equation?tex=z_j) 的共轭也是特征多项式的根，利用欧拉公式取其中实数部分，则为 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_j%5Ccos%5Clambda_j) 或 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_j%5Csin%5Clambda_j) 的形式，进而可以利用两角和公式，最后化成一个cos的形式，即

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7Bt%7D++%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+A_%7Bj%7D+%5Crho_%7Bj%7D%5E%7B-t%7D+%5Ccos+%5Cleft%28%5Clambda_%7Bj%7D+t%2B%5Ctheta_%7Bj%7D%5Cright%29+%5Cend%7Baligned%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=A_j) 为 ![[公式]](https://www.zhihu.com/equation?tex=c_%7Bj%7D+A%5E%7B-1%7D%5Cleft%28z_%7Bj%7D%5E%7B-1%7D%5Cright%29) 的实数部分。

**例** 对于AR（4）模型，特征多项式的根设为

![[公式]](https://www.zhihu.com/equation?tex=z_%7B1%7D%2C+z_%7B2%7D%3D1.09+e%5E%7B%5Cpm+i+%5Cpi+%2F+3%7D%2C+%5Cquad+z_%7B3%7D%2C+z_%7B4%7D%3D1.098+e%5E%7B%5Cpm+i+2+%5Cpi+%2F+3%7D%5C%5C) 

则周期分别为 ![[公式]](https://www.zhihu.com/equation?tex=2+%5Cpi+%2F%28%5Cpi+%2F+3%29%3D6) 和 ![[公式]](https://www.zhihu.com/equation?tex=2+%5Cpi+%2F%282%5Cpi+%2F+3%29%3D3) 

分别画出谱密度和自协方差函数图像得到

![img](https://pic2.zhimg.com/80/v2-95006a0360c5ff9e60912a75e3aae6d1_720w.jpg)谱密度函数



![img](https://pic2.zhimg.com/80/v2-169f92d0c8f4b47a76c232a32538bc89_720w.jpg)自协方差函数

从谱密度函数图像可以看出，谱密度确实在 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpi%2F3%2C2%5Cpi%2F3) 处达到峰值，从自协方差函数图像来看，大圆点大致周期为6，小圆点的大致周期为3（大圆点中有小圆点）。

类比以下 根较为远离单位圆的的模型：

![[公式]](https://www.zhihu.com/equation?tex=z_%7B1%7D%2C+z_%7B2%7D%3D1.264+e%5E%7B%5Cpm+i+%5Cpi+%2F+3%7D%2C+%5Cquad+z_%7B3%7D%2C+z_%7B4%7D%3D1.273+e%5E%7B%5Cpm+i+2+%5Cpi+%2F+3%7D%5C%5Cz_%7B1%7D%2C+z_%7B2%7D%3D1.635+e%5E%7B%5Cpm+i+%5Cpi+%2F+3%7D%2C+%5Cquad+z_%7B3%7D%2C+z_%7B4%7D%3D1.647+e%5E%7B%5Cpm+i+2+%5Cpi+%2F+3%7D%5C%5C) 

其谱密度图像和自协方差函数的图像分别为

![img](https://pic3.zhimg.com/80/v2-acf372d650fb59e3f9aa6e4e53578a56_720w.jpg)谱密度图像

![img](https://pic2.zhimg.com/80/v2-2d689fc7f87f59252b2cbd0c1163b2b5_720w.jpg)自协方差图像

可以看出，因为根远离单位圆，衰减比较厉害，所以峰值和周期性不大看的出来。

### 八、自协方差函数的正定性（重点）

根据Yule-Walker方程的可以看出，AR（p）模型的自协方差函数能够由白噪声方差和自回归系数唯一确定，那么反过来，能否由自协方差函数来确定白噪声方差和自回归系数呢？

我们回顾n=p情形下的Yule-Walker方程

![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7BP%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+a_%7B1%7D+%5C%5C+a_%7B2%7D+%5C%5C+%5Ccdots+%5C%5C+a_%7Bp%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cgamma_%7B1%7D+%5C%5C+%5Cgamma_%7B2%7D+%5C%5C+%5Ccdots+%5C%5C+%5Cgamma_%7Bp%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

可以看出，只要 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7BP%7D) 正定，那么就能由Yule-Walker方程解出自回归系数了，同时再取0阶自协方差函数，就得到白噪声的方差，用数学式子表示就是

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D_%7B%5Cboldsymbol%7Bp%7D%7D%3D%5CGamma_%7B%5Cboldsymbol%7Bp%7D%7D%5E%7B-%5Cmathbf%7B1%7D%7D+%5Cgamma_%7B%5Cboldsymbol%7Bp%7D%7D%2C+%5Cquad+%5Csigma%5E%7B%5Cboldsymbol%7B2%7D%7D%3D%5Cgamma_%7B%5Cmathbf%7B0%7D%7D-%5Cgamma_%7B%5Cboldsymbol%7Bp%7D%7D%5E%7BT%7D+%5CGamma_%7B%5Cboldsymbol%7Bp%7D%7D%5E%7B-%5Cmathbf%7B1%7D%7D+%5Cgamma_%7B%5Cboldsymbol%7Bp%7D%7D%5C%5C) 

而我们一开始就介绍过平稳序列的自协方差具有非负定性，如果它不是正定的，就相当于这个时间序列中 ![[公式]](https://www.zhihu.com/equation?tex=X_1%2C...%2CX_n) 是线性相关的，而从Yule-Walker方程递推可知，随着时间增加，每次都将增加一个白噪声的信息，所以直观上看自协方差函数应该不会由前面的若干个时间点所唯一确定下来，即应该是正定的。下面我们将严格说明这件事。

**定理** 设 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bn%7D) 是平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 的n阶自协方差矩阵， ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7B0%7D%3E0) （如果等于0就以概率1为常数时间序列了），则有以下两个结论：

- 如果平稳序列**谱密度存在**，则对于n≥1，自协方差矩阵正定
- 如果**自协方差函数趋于0**，则对于n≥1，自协方差矩阵正定

从结论1可以看出，AR（p）模型存在谱密度，所以自协方差矩阵是正定的。另外我们证明过线性平稳序列，只要系数是平方可和的，其自协方差函数都将趋于0，所以由结论2自协方差矩阵也是正定的。

为证明该定理，首先给出如下引理。

**引理** 对于实数平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) ，设自协方差矩阵为 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bn%7D) ，谱分布函数为 ![[公式]](https://www.zhihu.com/equation?tex=F%28%5Clambda%29) ，则对于任意 ![[公式]](https://www.zhihu.com/equation?tex=+%5Cmathbf%7Bb%7D%3D%5Cleft%28b_%7B1%7D%2C+%5Cldots%2C+b_%7Bn%7D%5Cright%29+%5Cin+R%5E%7Bn%7D) ，有

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bb%7D%5E%7BT%7D+%5CGamma_%7Bn%7D+%5Cmathbf%7Bb%7D%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B2%7D+d+F%28%5Clambda%29%5C%5C) 

此外如果谱密度存在，上式可写成

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bb%7D%5E%7BT%7D+%5CGamma_%7Bn%7D+%5Cmathbf%7Bb%7D%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B2%7D+f%28%5Clambda%29+d+%5Clambda%5C%5C) 

**引理的证明**：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+%5Cmathbf%7Bb%7D%5E%7BT%7D+%5CGamma_%7Bn%7D+%5Cmathbf%7Bb%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Csum_%7Bk%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+b_%7Bk%7D+%5Cgamma_%7Bj-k%7D+%5C%5C+%3D%26+%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Csum_%7Bk%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+b_%7Bk%7D+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+e%5E%7Bi%28j-k%29+%5Clambda%7D+d+F%28%5Clambda%29+%5C%5C+%3D%26+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Csum_%7Bk%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+b_%7Bk%7D+e%5E%7Bi+j+%5Clambda%7D+e%5E%7B-i+k+%5Clambda%7D+d+F%28%5Clambda%29+%5C%5C+%3D%26+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B2%7D+d+F%28%5Clambda%29+%5Cend%7Baligned%7D%5C%5C) 

第一个等号在证明非负定的时候已经用过一次了，第二个等号是谱函数的定义。

利用这个引理，直观上看只要积分项不恒等于0，则积分出来应该是大于0，也就得到了自协方差矩阵的正定性。那会不会存在非0的向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bb%7D) ，使得积分项恒为0呢？**不会**！

因为只要令 ![[公式]](https://www.zhihu.com/equation?tex=z%3De%5E%7Bi%5Clambda%7D) ，那么求和式就变成关于z的n次多项式，它至多有n个零点！如果要对所有在单位圆内的z都等于0，只能是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bb%7D%3D%5Cmathbf%7B0%7D) ，同时 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7B0%7D%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+f%28%5Clambda%29+d+%5Clambda%3E0) ，于是

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bb%7D%5E%7BT%7D+%5CGamma_%7Bn%7D+%5Cmathbf%7Bb%7D%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B2%7D+f%28%5Clambda%29+d+%5Clambda%3E0%5C%5C) 

也就**证明了定理的结论1**。

对于结论2，可以采用**反证法**，假设存在从某个n+1开始，自协方差矩阵就不是正定的，而对于n之前的都是正定的，即 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bn%7D) 正定， ![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7Bdet%7D%5Cleft%28%5CGamma_%7Bn%2B1%7D%5Cright%29%3D0) ，另外不妨设 ![[公式]](https://www.zhihu.com/equation?tex=E+X_%7Bt%7D%3D0) （非0均值的情况只要减去均值即可），定义

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D_%7Bn%7D%3D%5Cleft%28X_%7B1%7D%2C+X_%7B2%7D%2C+%5Cldots%2C+X_%7Bn%7D%5Cright%29%5E%7BT%7D%5C%5C) 

那么对任何实向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bb%7D%3D%5Cleft%28b_%7B1%7D%2C+b_%7B2%7D%2C+%5Cldots%2C+b_%7Bn%7D%5Cright%29%5E%7BT%7D+%5Cneq+0) 有

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29%5E%7B%5Cmathbf%7B2%7D%7D%3D%5Cmathbf%7Bb%7D%5E%7BT%7D+%5CGamma_%7Bn%7D+%5Cmathbf%7Bb%7D%3E0%5C%5C) 

这一步利用 ![[公式]](https://www.zhihu.com/equation?tex=E%5Cmathbf%7BX%7D_%7Bn%7D%5Cmathbf%7BX%7D_%7Bn%7D%5E%7B%5Cprime%7D%3D%5CGamma_%7Bn%7D+)  ，类似地，由 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7C%5CGamma_%7Bn%2B1%7D%5Cright%7C%3D0) 知，存在 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D%3D%5Cleft%28a_%7B1%7D%2C+a_%7B2%7D%2C+%5Cldots%2C+a_%7Bn%2B1%7D%5Cright%29%5E%7BT%7D+%5Cneq+0) 且 ![[公式]](https://www.zhihu.com/equation?tex=a_%7Bn%2B1%7D+%5Cneq+0) （如果等于0就与上面式子矛盾了）使得

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D_%7Bn%2B1%7D%5Cright%29%5E%7B2%7D%3D%5Cmathbf%7Ba%7D%5E%7BT%7D+%5CGamma_%7Bn%2B1%7D+%5Cmathbf%7Ba%7D%3D0%5C%5C) 

于是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D_%7Bn%2B1%7D%3Da_%7B1%7D+X_%7B1%7D%2Ba_%7B2%7D+X_%7B2%7D%2B%5Ccdots%2Ba_%7Bn%2B1%7D+X_%7Bn%2B1%7D%3D0) 几乎处处成立，因此 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2B1%7D) 可由前n项线性表出，即

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2B1%7D%3D-%5Cfrac%7Ba_%7Bn%7D%7D%7Ba_%7Bn%2B1%7D%7D+X_%7Bn%7D-%5Cfrac%7Ba_%7Bn-1%7D%7D%7Ba_%7Bn%2B1%7D%7D+X_%7Bn-1%7D-%5Ccdots-%5Cfrac%7Ba_%7B1%7D%7D%7Ba_%7Bn%2B1%7D%7D+X_%7B1%7D%5C%5C) 

将时间点向后平移t就得到

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D-%5Cfrac%7Ba_%7Bn%7D%7D%7Ba_%7Bn%2B1%7D%7D+X_%7Bt-1%7D-%5Cfrac%7Ba_%7Bn-1%7D%7D%7Ba_%7Bn%2B1%7D%7D+X_%7Bt-2%7D-%5Ccdots-%5Cfrac%7Ba_%7B1%7D%7D%7Ba_%7Bn%2B1%7D%7D+X_%7Bt-n%7D%5C%5C) 

由此递推可知，对k≥1， ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2Bk%7D) 可以由 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn%7D) 线性表出，即有实向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha+%5Ctriangleq+%5Calpha%5E%7B%28k%29%7D+%5Ctriangleq%5Cleft%28%5Calpha_%7B1%7D%2C+%5Cldots%2C+%5Calpha_%7Bn%7D%5Cright%29%5E%7BT%7D) 使得 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2Bk%7D%3D%5Cleft%28%5Calpha%5E%7B%28k%29%7D%5Cright%29%5E%7BT%7D+%5Cmathbf%7BX_%7Bn%7D%7D) 

而根据定理条件，有自协方差函数趋于0，但是这个结果表明无论k多么大， ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2Bk%7D) 都和 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn%7D) 线性相关，且如果线性表出系数有界，则 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2Bk%7D) 一定是退化的（几乎处处为常数），这就导出矛盾。当然这只是直观理解，后续还要严格证明。

首先给出一个错误证明：

![[公式]](https://www.zhihu.com/equation?tex=E+X_%7Bn%2Bk%7D%5E%7B2%7D%3D%5Cgamma_%7B0%7D%3E0) ， ![[公式]](https://www.zhihu.com/equation?tex=E+X_%7Bn%2Bk%7D%5Cleft%28%5Calpha%5E%7B%28k%29%7D%5Cright%29%5E%7BT%7D+X_%7Bn%7D%5Crightarrow0) ，矛盾。

错误的原因在于，第二项中虽然每一项都趋于0，但是因为总共有n项，而n是趋于无穷大的，所以并不能直接得到整体趋于0.

正确的证明是：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7B0%7D+%26%3D%5Cmathrm%7BE%7D%5Cleft%28%5Cleft%28%5Calpha%5E%7B%28k%29%7D%5Cright%29%5E%7BT%7D+%5Cmathbf%7BX%7D+%5Ccdot+X_%7Bn%2Bk%7D%5Cright%29%3D%5Cleft%28%5Calpha%5E%7B%28k%29%7D%5Cright%29%5E%7BT%7D+E%5Cleft%28%5Cmathbf%7BX%7D+X_%7Bn%2Bk%7D%5Cright%29+%5C%5C+%26%3D%5Cleft%28%5Calpha%5E%7B%28k%29%7D%5Cright%29%5E%7BT%7D%5Cleft%28%5Cgamma_%7Bn%2Bk-1%7D%2C+%5Cgamma_%7Bn%2Bk-2%7D%2C+%5Cldots%2C+%5Cgamma_%7Bk%7D%5Cright%29%5E%7BT%7D+%5C%5C+%26+%5Cleq%5Cleft%7C%5Cboldsymbol%7B%5Calpha%7D%5E%7B%28k%29%7D%5Cright%7C%5Cleft%28%5Csum_%7Bj%3D0%7D%5E%7Bn-1%7D+%5Cgamma_%7Bj%2Bk%7D%5E%7B%5Cmathbf%7B2%7D%7D%5Cright%29%5E%7B1+%2F+2%7D+%5Cend%7Baligned%7D%5C%5C) 

 其中不等号利用柯西不等式，向量的绝对值表示二范数。而由正定性，可将自协方差矩阵正交分解得到

![[公式]](https://www.zhihu.com/equation?tex=T+%5CGamma_%7Bn%7D+%5Ccdot+T%5E%7BT%7D%3D%5Coperatorname%7Bdiag%7D%5Cleft%28%5Clambda_%7B1%7D%2C+%5Clambda_%7B2%7D%2C+%5Cldots%2C+%5Clambda_%7Bn%7D%5Cright%29%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=0%3C%5Clambda_%7B1%7D+%5Cleq+%5Clambda_%7B2%7D+%5Ccdots+%5Cleq+%5Clambda_%7Bn%7D) ，由此可以重写上面的步骤得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7B0%7D+%26%3DE+X_%7Bn%2Bk%7D%5E%7B2%7D%3DE%5Cleft%28%5Cleft%28%5Calpha%5E%7B%28k%29%7D%5Cright%29%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D%3D%5Cleft%28%5Calpha%5E%7B%28k%29%7D%5Cright%29%5E%7BT%7D+%5CGamma_%7Bn%7D+%5Calpha%5E%7B%28k%29%7D+%5C%5C+%26%3D%5Cleft%28%5Cleft%28%5Calpha%5E%7B%28k%29%7D%5Cright%29%5E%7BT%7D+T%5E%7BT%7D%5Cright%29%5Cleft%28T+%5CGamma_%7Bn%7D+T%5E%7BT%7D%5Cright%29%5Cleft%28T+%5Calpha%5E%7B%28k%29%7D%5Cright%29+%5C%5C+%26+%5Cgeq+%5Clambda_%7B1%7D%5Cleft%28%5Cleft%28%5Calpha%5E%7B%28k%29%7D%5Cright%29%5E%7BT%7D+T%5E%7BT%7D%5Cright%29%5Cleft%28T+%5Calpha%5E%7B%28k%29%7D%5Cright%29%3D%5Clambda_%7B1%7D%5Cleft%7C%5Calpha%5E%7B%28k%29%7D%5Cright%7C%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

第四个等号添上正交矩阵及其转置，由于得到单位阵，所以结果不变，而中间项就是一个对角矩阵。不等号需要注意到对角阵左边为行向量，右边为其转置，最终结果形式上为行向量**每个分量的平方乘上对应的特征根再求和**，将其用最小特征根放缩就得到该结果。最后一步利用正交矩阵及其转置乘积为单位阵。

由此可以得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7C%5Calpha%5E%7B%28k%29%7D%5Cright%7C+%5Cleq+%5Csqrt%7B%5Cgamma_%7B0%7D+%2F+%5Clambda_%7B1%7D%7D%3C%5Cinfty) ，因此

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7B0%7D+++%5Cleq%5Cleft%7C%5Cboldsymbol%7B%5Calpha%7D%5E%7B%28k%29%7D%5Cright%7C%5Cleft%28%5Csum_%7Bj%3D0%7D%5E%7Bn-1%7D+%5Cgamma_%7Bj%2Bk%7D%5E%7B%5Cmathbf%7B2%7D%7D%5Cright%29%5E%7B1+%2F+2%7D%5Crightarrow0%5C%5C) 

这就与 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7B0%7D%3E0) 矛盾，因此假设不成立，就**得到了定理的结论2**。

前面根据定理已经说明过可得到线性平稳序列自协方差的正定性，这里用推论的形式给出。

**推论** 系数平方可和的线性平稳序列的自协方差矩阵总是正定的，称自协方差函数是正定序列。

### 九、相关基本概念

对于方差有限的随机变量 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7B1%7D%2C+Y_%7B2%7D%2C+%5Ccdots%2C+Y_%7Bn%7D) ，如果有不全为0的常数 ![[公式]](https://www.zhihu.com/equation?tex=b_%7B1%7D%2C+%5Cldots%2C+b_%7Bn%7D) 使得

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BE%7D%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+Y_%7Bj%7D%5Cright%29%5E%7B2%7D%3D0%5C%5C) 

则称随机变量 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7B1%7D%2C+Y_%7B2%7D%2C+%5Ccdots%2C+Y_%7Bn%7D) 线性相关，否则线性无关。

当线性相关时，存在常数 ![[公式]](https://www.zhihu.com/equation?tex=b_0) 有 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+Y_%7Bj%7D%3Db_%7B0%7D+%5Cquad+%5Cmathrm%7Ba.s%7D) 成立，并且当 ![[公式]](https://www.zhihu.com/equation?tex=b_%7Bn%7D+%5Cneq+0) 时， ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bn%7D) 可以由 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7B1%7D%2C+Y_%7B2%7D%2C+%5Ccdots%2C+Y_%7Bn-1%7D) 线性表示，即

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bn%7D%3Da_%7B0%7D%2Ba_%7B1%7D+Y_%7Bn-1%7D%2B%5Ccdots%2Ba_%7Bn%7D+Y_%7B1%7D%5C%5C) 

称 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bn%7D) 可以由 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7B1%7D%2C+Y_%7B2%7D%2C+%5Ccdots%2C+Y_%7Bn-1%7D) **完全线性预测**。

此外，对于平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) ， ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt-1%7D%2C+%5Cldots%2C+X_%7Bt-n%7D) 的一个**带截距的线性组合**为

![[公式]](https://www.zhihu.com/equation?tex=b_%7B1%7D+X_%7Bt-1%7D%2B%5Cldots+b_%7Bn%7D+X_%7Bt-n%7D-b_%7B0%7D%5C%5C) 

随机变量线性无关当且仅当

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Coperatorname%7BVar%7D%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+X_%7Bt-j%7D-b_%7B0%7D%5Cright%29%3D%5Coperatorname%7BVar%7D%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+b_%7Bj%7D+X_%7Bt-j%7D%5Cright%29+%5C%5C+%3D%5Cmathbf%7Bb%7D+%5CGamma_%7Bn%7D+%5Cmathbf%7Bb%7D%3E0+%5Cend%7Barray%7D%5C%5C) 

即**自协方差矩阵正定**。

## 2.4平稳序列的偏相关系数和Levinson递推公式

接下来是要解决AR(p)模型的定阶问题，前面我们总假定是p阶的，但实际问题中我们并不知道一个AR(p)序列是几阶的。

### 一、最优线性预测

设 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+X_%7B2%7D%2C+%5Cldots%2C+X_%7Bn%7D%2C+Y) 为随机变量，考虑估计问题

![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28Y+%5Cmid+X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn%7D%5Cright%29+%5Ctriangleq+%5Cunderset%7B%5Chat%7BY%7D%3Da_%7B0%7D%2Ba_%7B1%7D+X_%7B1%7D%2B%5Ccdots%2Ba_%7Bn%7D+X_%7Bn%7D%7D%7B%5Carg+%5Cmin+%7D+E%28Y-%5Chat%7BY%7D%29%5E%7B2%7D%5C%5C) 

称 ![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28Y+%5Cmid+X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn%7D%5Cright%29) 为 ![[公式]](https://www.zhihu.com/equation?tex=Y) 关于 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+X_%7B2%7D%2C+%5Cldots%2C+X_%7Bn%7D) 的**最优线性估计**。这里用到的实际上是最小二乘法。下面推导最优线性估计的表达式。

由于这些随机变量的数学期望不为0，所以先将其**零均值化**，令

![[公式]](https://www.zhihu.com/equation?tex=%5Cxi%3DX-E+X%EF%BC%8C%5Ceta%3DY-%5Cmathrm%7BE%7D+Y%5C%5C) 

设 ![[公式]](https://www.zhihu.com/equation?tex=%5CSigma_%7B%5Cmathbf%7BX%7D%7D+%5Ctriangleq+%5Coperatorname%7BVar%7D%28%5Cmathbf%7BX%7D%29%3D%5Coperatorname%7BVar%7D%28%5Cxi%29) 正定，记 ![[公式]](https://www.zhihu.com/equation?tex=%5CSigma_%7B%5Cmathbf%7Bx%7D%2C+Y%7D%3D%5Coperatorname%7BCov%7D%28%5Cmathbf%7BX%7D%2C+Y%29) 。

记 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D%3D%5Cleft%28a_%7Bn%7D%2C+%5Cldots%2C+a_%7B1%7D%5Cright%29%5E%7BT%7D) 为实数向量，则

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+%5Cmathrm%7BE%7D%5Cleft%28Y-%5Cleft%28a_%7B0%7D%2Ba_%7B1%7D+X_%7B1%7D%2B%5Ccdots%2Ba_%7Bn%7D+X_%7Bn%7D%5Cright%29%5Cright%29%5E%7B2%7D+%5C%5C+%3D%26+%5Cmathrm%7BE%7D%5Cleft%28%5Ceta-%5Cleft%28a_%7B1%7D+%5Cxi_%7B1%7D%2B%5Cldots+a_%7Bn%7D+%5Cxi_%7Bn%7D%5Cright%29%5Cright%29%5E%7B2%7D%2B%5Cleft%28%5Cmathrm%7BE%7D+Y-a_%7B0%7D-%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathrm%7BEX%7D%5Cright%29%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

即加一项减一项，交叉项为0（常用套路了）。到这里可以发现，求 ![[公式]](https://www.zhihu.com/equation?tex=E%28Y-%5Chat%7BY%7D%29%5E%7B2%7D) 最小值等价于求 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28%5Ceta-%5Cleft%28a_%7B1%7D+%5Cxi_%7B1%7D%2B%5Cldots+a_%7Bn%7D+%5Cxi_%7Bn%7D%5Cright%29%5Cright%29%5E%7B2%7D) 的最小值（只需取合适的 ![[公式]](https://www.zhihu.com/equation?tex=a_0) 让后面那项为0即可），所以以后我们一般不妨假设随机变量的数学期望为0。

这时

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+%5Cmathrm%7BE%7D%5Cleft%28Y-%5Cleft%28a_%7B1%7D+X_%7B1%7D%2B%5Cldots+a_%7Bn%7D+X_%7Bn%7D%5Cright%29%5Cright%29%5E%7B2%7D+%5C%5C+%3D%26+%5Coperatorname%7BVar%7D%28Y%29%2B%5Cmathbf%7Ba%7D%5E%7BT%7D+%5CSigma_%7B%5Cmathrm%7BX%7D%7D+%5Cmathbf%7Ba%7D-2+%5Cmathbf%7Ba%7D%5E%7BT%7D+%5CSigma_%7B%5Cmathbf%7BX%7D%2C+Y%7D+%5Cend%7Baligned%7D%5C%5C) 

关于 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D) 求导数并令为0得到最小值点为

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D%3D%5CSigma_%7B%5Cmathbf%7BX%7D%7D%5E%7B%5Cmathbf%7B1%7D%7D+%5CSigma_%7B%5Cmathbf%7BX%7D%2C+Y%7D%5C%5C) 

估计误差的最小值为

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28Y-%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D%3D%5Coperatorname%7BVar%7D%28Y%29-%5CSigma_%7B%5Cmathbf%7BX%7D%2C+Y%7D%5E%7BT%7D+%5CSigma_%7B%5Cmathbf%7BX%7D%7D%5E%7B-1%7D+%5CSigma_%7B%5Cmathbf%7BX%7D%2C+Y%7D%5C%5C) 

这与多元正态分布的条件分布那部分的结论一致。

### 二、平稳序列的最优线性预测

设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 为零均值平稳列，考虑用 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn%7D) 的组合来预测 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2B1%7D) ，设 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bn%7D%3E0) ，则

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+X_%7Bn%7D+%5C%5C+%5Cvdots+%5C%5C+X_%7B1%7D+%5Cend%7Barray%7D%5Cright%29+%5Cquad+%5Cmathbf%7Ba%7D_%7Bn%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cmathbf%7Ba%7D_%7Bn+1%7D+%5C%5C+%5Cvdots+%5C%5C+%5Cmathbf%7Ba%7D_%7Bn+n%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

注意这里X是从n写到1，由上面推导的结果可以得到

![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7B1%7D%5Cright%29%3D%5Cleft%5B%5Coperatorname%7BVar%7D%5Cleft%28%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+X_%7Bn%7D+%5C%5C+%5Cvdots+%5C%5C+X_%7B1%7D+%5Cend%7Barray%7D%5Cright%29%5Cright%29%5E%7B-1%7D+%5Coperatorname%7BCov%7D%5Cleft%28%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+X_%7Bn%7D+%5C%5C+%5Cvdots+%5C%5C+X_%7B1%7D+%5Cend%7Barray%7D%5Cright%29%2C+X_%7Bn%2B1%7D%5Cright%29%5Cright%5D%5E%7BT%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+X_%7Bn%7D+%5C%5C+%5Cvdots+%5C%5C+X_%7B1%7D%5C%5C+%5Cend%7Barray%7D%5Cright%29%5C%5C%5Cbegin%7Barray%7D%7Bl%7D+%3D%5Cleft%28%5CGamma_%7Bn%7D%5E%7B-1%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cgamma_%7B1%7D+%5C%5C+%5Cgamma_%7B2%7D+%5C%5C+%5Ccdots+%5C%5C+%5Cgamma_%7Bn%7D+%5Cend%7Barray%7D%5Cright%29%5Cright%29%5E%7BT%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+X_%7Bn%7D+%5C%5C+%5Ccdots+%5C%5C+X_%7B1%7D+%5Cend%7Barray%7D%5Cright%29+%5C%5C+%5Ctriangleq_%7Ba_%7Bn+1%7D%7D+X_%7Bn%7D%2Ba_%7Bn+2%7D+X_%7Bn-1%7D%2B%5Ccdots%2Ba_%7Bn+n%7D+X_%7B1%7D+%5C%5C+%5Ctriangleq+%5Cmathbf%7Ba%7D_%7Bn%7D%5E%7BT%7D%5Cleft%28X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7B1%7D%5Cright%29%5E%7BT%7D+%5Cend%7Barray%7D) 

其中第三个等号反向利用最佳线性估计的公式。

### 三、平稳序列的Yule-Walker方程

称方程

![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bn%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+a_%7Bn+1%7D+%5C%5C+%5Ccdots+%5C%5C+a_%7Bn+n%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cgamma_%7B1%7D+%5C%5C+%5Ccdots+%5C%5C+%5Cgamma_%7Bn%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

的解 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D_%7Bn%7D+%5Ctriangleq%5Cleft%28a_%7Bn+1%7D%2C+a_%7Bn+2%7D%2C+%5Cldots%2C+a_%7Bn+n%7D%5Cright%29%5E%7BT%7D) 为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cgamma_%7Bk%7D%5Cright%5C%7D) 的n阶Yule-Walker系数。

最小的线性预测方差为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Csigma_%7Bn%7D%5E%7B2%7D+%26%3D%5Cmathrm%7BE%7D%5Cleft%28X_%7Bn%2B1%7D-%5Cleft%28a_%7Bn+1%7D+X_%7Bn%7D%2B%5Cldots+a_%7Bn+n%7D+X_%7B1%7D%5Cright%29%5Cright%29%5E%7B2%7D+%5C%5C+%26%3D%5Cgamma_%7B0%7D-a_%7Bn+1%7D+%5Cgamma_%7B1%7D-%5Ccdots-a_%7Bn+n%7D+%5Cgamma_%7Bn%7D+%5Cend%7Baligned%7D%5C%5C) 

第二个等号利用之前推导的方差表达式，并注意到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D_%7Bn%7D%3D%5CSigma_%7BX%7D%5E%7B1%7D+%5CSigma_+%7BX%2C+Y%7D) 

这样的好处是对于任意的平稳序列都可以得到这样的方程，而AR(p)序列的Yule-Walker系数只有p个非零，其余都是0。

### 四、Yule-Walker系数的最小相位性

如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cgamma_%7Bk%7D%5Cright%5C%7D) 是某AR（p）模型的自协方差系数，则p阶Yule-Walker方程解出的系数就是自回归系数，所以满足最小相位条件，即

![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D1-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+z%5E%7Bj%7D+%5Cneq+0%2C+%5Cquad+%5Ctext+%7B+%E5%AF%B9+%7D%7Cz%7C+%5Cleq+1%5C%5C) 

事实上关于Yule-Walker系数有如下定理。

**定理** 如果实数列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%2C+k%3D0%2C1%2C+%5Cldots%2C+n) 使得

![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bn%2B1%7D+%5Ctriangleq%5Cleft%28%5Cbegin%7Barray%7D%7Bcccc%7D+%5Cgamma_%7B0%7D+%26+%5Cgamma_%7B1%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bn%7D+%5C%5C+%5Cgamma_%7B1%7D+%26+%5Cgamma_%7B0%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bn-1%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+%5Cgamma_%7Bn%7D+%26+%5Cgamma_%7Bn-1%7D+%26+%5Ccdots+%26+%5Cgamma_%7B0%7D+%5Cend%7Barray%7D%5Cright%29%3E0%5C%5C) 

则解出的Yule-Walker系数满足最小相位条件。

定理的证明不要求，是需要知道由Yule-Walker方程解出的系数满足最小相位条件即可。

根据这个定理，结合线性平稳序列的自协方差矩阵正定，所以其解出来的系数满足最小相位条件，也就是说，这些系数就来自某个AR(p)模型。

### 五、Levinson递推公式

这个递推公式是**用于解Yule-Walker方程**的。

事实上它是通过令n取0,1,2,3，...，来构建下面的系数表

![img](https://pic2.zhimg.com/80/v2-7379b3b0e96e3355a31d2dd7db42c161_720w.jpg)

**定理** 如果 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bn%2B1%7D) 正定，则 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%2C+k%3D0%2C1%2C+%5Cldots%2C+n) 的 ![[公式]](https://www.zhihu.com/equation?tex=1%2C2%2C+%5Cldots%2C+n%2C+n%2B1) 阶Yule-Walker系数与均方误差 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7Bk%7D%5E%7B2%7D) 可以通过下面的递推方法计算

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Csigma_%7B0%7D%5E%7B2%7D+%26%3D%5Cgamma_%7B0%7D+%5C%5C+a_%7B1%2C1%7D+%26%3D%5Cgamma_%7B1%7D+%2F+%5Cgamma_%7B0%7D+%5C%5C+%5Csigma_%7Bk%7D%5E%7B2%7D+%26%3D%5Csigma_%7Bk-1%7D%5E%7B2%7D%5Cleft%281-a_%7Bk%2C+k%7D%5E%7B2%7D%5Cright%29+%5C%5C+a_%7Bk%2B1%2C+k%2B1%7D+%26%3D%5Cfrac%7B%5Cgamma_%7Bk%2B1%7D-a_%7Bk%2C+1%7D+%5Cgamma_%7Bk%7D-a_%7Bk%2C+2%7D+%5Cgamma_%7Bk-1%7D-%5Ccdots-a_%7Bk%2C+k%7D+%5Cgamma_%7B1%7D%7D%7B%5Cgamma_%7B0%7D-a_%7Bk%2C+1%7D+%5Cgamma_%7B1%7D-a_%7Bk%2C+2%7D+%5Cgamma_%7B2%7D-%5Ccdots-a_%7Bk%2C+k%7D+%5Cgamma_%7Bk%7D%7D+%5C%5C+a_%7Bk%2B1%2C+j%7D+%26%3Da_%7Bk%2C+j%7D-a_%7Bk%2B1%2C+k%2B1%7D+a_%7Bk%2C+k%2B1-j%7D%2C+%5Cquad+1+%5Cleq+j+%5Cleq+k+%5Cend%7Baligned%7D%5C%5C) 

第四第五步表明，表中的某一行的系数可以由上一行的系数结合自协方差函数计算得到。其中

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7Bk%7D%5E%7B2%7D%3D%5Cmathrm%7BE%7D%5Cleft%28X_%7Bk%2B1%7D-%5Cleft%28a_%7Bk%2C+1%7D+X_%7Bk%7D%2B%5Ccdots%2Ba_%7Bk%2C+k%7D+X_%7B1%7D%5Cright%29%5Cright%29%5E%7B2%7D%5C%5C) 

第五个等号有下面一个易于记忆的形式

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+a_%7Bk%2B1%2C1%7D+%5C%5C+%5Cvdots+%5C%5C+a_%7Bk%2B1%2C+k%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+a_%7Bk%2C+1%7D+%5C%5C+%5Cvdots+%5C%5C+a_%7Bk%2C+k%7D+%5Cend%7Barray%7D%5Cright%29-a_%7Bk%2B1%2C+k%2B1%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+a_%7Bk%2C+k%7D+%5C%5C+%5Cvdots+%5C%5C+a_%7Bk%2C+1%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

### 六、偏相关系数

**定义** 如果自协方差矩阵正定，称 ![[公式]](https://www.zhihu.com/equation?tex=a_%7Bn%2C+n%7D) 为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 或 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cgamma_%7Bk%7D%5Cright%5C%7D) 的n阶偏相关系数。

我们知道AR(p)模型的Yule-Walker系数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathbf%7Ba%7D_%7Bn%7D+%26%3D%5Cleft%28a_%7B1%7D%2C+%5Cldots%2C+a_%7Bp%7D%2C+0%2C+%5Cldots%2C+0%5Cright%29%5E%7BT%7D+%5C%5C+%26%3D%5Cleft%28a_%7Bn%2C+1%7D%2C+a_%7Bn%2C+2%7D%2C+%5Cldots%2C+a_%7Bn%2C+n%7D%5Cright%29%5E%7BT%7D%2C+%5Cquad+n+%5Cgeq+p+%5Cend%7Baligned%7D%5C%5C) 

其偏相关系数满足

![[公式]](https://www.zhihu.com/equation?tex=a_%7Bn%2C+n%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+a_%7Bp%7D+%5Cneq+0%2C+%26+n%3Dp+%5C%5C+0%2C+%26+n%3Ep+%5Cend%7Barray%7D%5Cright.%5C%5C) 

称偏相关系数**p步截尾**。

反之，如果一个零均值平稳列满足偏相关系数是p步截尾的，那么它一定是AR(p)序列。这个是我们之后要证明的。

**注意**：偏相关系数隐含自协方差矩阵正定！这是由定义得到的

### 七、AR序列的充分必要条件

**定理** 如果一个零均值平稳列满足偏相关系数是p步截尾的，那么它一定是AR(p)序列

必要性前面已经介绍过了（即已知AR序列，那么偏相关系数是p步截尾），这里重点看充分性的证明。

**充分性证明**：回顾一下，当Yule-Walker方程的n取为p的时候，其解最接近与AR(p)模型的系数。因此先考察这个情形。

记 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28a_%7Bp%2C+1%7D%2C+%5Cldots%2C+a_%7Bp%2C+p%7D%5Cright%29%3D%5Cleft%28a_%7B1%7D%2C+%5Cldots%2C+a_%7Bp%7D%5Cright%29) ，令 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D%3DX_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D) ，则只要证明 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D) 是白噪声即可。先根据之前的递推公式直观来看一下

![img](https://pic1.zhimg.com/80/v2-9198315e9da9c18ff4208494cdfca2a4_720w.jpg)

根据p步截尾的条件，上面式子当k取p时，可以发现表格中的**p+1行就完全等于p行**。也就是说从第p行开始，后面的p+1，p+2，...偏相关系数都与p行是一样的。

因此可以利用AR(p)模型的Yule-Walker方程来进行计算，即有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7Bk%7D+%26%3Da_%7B1%7D+%5Cgamma_%7Bk-1%7D%2Ba_%7B2%7D+%5Cgamma_%7Bk-2%7D%2B%5Ccdots%2Ba_%7Bp%7D+%5Cgamma_%7Bk-p%7D+%5C%5C+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bk-j%7D%2C+%5Cquad+k+%5Cgeq+1+%5Cend%7Baligned%7D%5C%5C) 

这些系数满足最小相位条件，且根据齐次差分方程性质，自协方差函数作为差分方程的解，是趋于0的，因此自协方差矩阵正定。

根据![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D)的定义有 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D+%5Cvarepsilon_%7Bt%7D%3D0%2C+%5Coperatorname%7BVar%7D%5Cleft%28%5Cvarepsilon_%7Bt%7D%5Cright%29%3D%5Csigma_%7Bp%7D%5E%7B2%7D%3E0) （因为自协方差函数趋于0，所以不可完全线性预测，进而要大于0），并且它是平稳序列的线性滤波，因此也是平稳序列。下面证明它是白噪声。（往证 ![[公式]](https://www.zhihu.com/equation?tex=E+%5Cvarepsilon_%7Bs%7D+%5Cvarepsilon_%7Bt%7D%3D0) ）

通常证法：对t>s有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathrm%7BE%7D%5Cleft%28%5Cvarepsilon_%7Bt%7D+X_%7Bs%7D%5Cright%29+%26%3DE%5Cleft%5B%5Cleft%28X_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%5Cright%29+X_%7Bs%7D%5Cright%5D+%5C%5C+%26%3D%5Cgamma_%7Bt-s%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bt-s-j%7D+%5C%5C+%26%3D0+%5Cquad+%5Cend%7Baligned%7D%5C%5C) 

最后一步即Yule-Walker方程，所以

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28%5Cvarepsilon_%7Bt%7D+%5Cvarepsilon_%7Bs%7D%5Cright%29%3D%5Cmathrm%7BE%7D%5Cleft%5B%5Cvarepsilon_%7Bt%7D%5Cleft%28X_%7Bs%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bs-j%7D%5Cright%29%5Cright%5D%3D0%5C%5C) 

因为根据上面的结果每一项都是0。所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D+%5Ctext+%7B+%E6%98%AF+%7D+%5Cmathrm%7BWN%7D%5Cleft%280%2C+%5Csigma_%7Bp%7D%5E%7B2%7D%5Cright%29) 且系数满足最小相位条件。

### 本节内容的意义：

现实中我们会得到一组有N数的时间序列样本，可以通过计算样本的自协方差函数

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cgamma%7D_%7Bk%7D%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7BN-k%7D%5Cleft%28x_%7Bt%7D-%5Cbar%7Bx%7D%5Cright%29%5Cleft%28x_%7Bt%2Bk%7D-%5Cbar%7Bx%7D%5Cright%29%5C%5C) 

进而利用Y-W方程得到偏相关系数的估计，如果发现偏相关系数有截尾性，那么可以拟合一个AR模型。

## 2.5例子

主要要求是算自协方差函数

### 例 AR(1)模型

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3Da+X_%7Bt-1%7D%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%2C+%5Cquad%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D+%5Csim+%5Cmathrm%7BWN%7D%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29%5C%5C) 

其自协方差函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Cgamma_%7B0%7D%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a%5E%7B2+j%7D%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B1-a%5E%7B2%7D%7D+%5C%5C+%5Cgamma_%7Bk%7D%3Da+%5Cgamma_%7Bk-1%7D%3D%5Ccdots%3Da%5E%7Bk%7D+%5Cgamma_%7B0%7D%2C+%5Cquad+k+%5Cgeq+1+%5Cend%7Barray%7D%5C%5C) 

自相关函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk%7D%3D%5Cfrac%7B%5Cgamma_%7Bk%7D%7D%7B%5Cgamma_%7B0%7D%7D%3Da%5E%7Bk%7D%5C%5C) 

谱密度为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+f%28%5Clambda%29+%26%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D+%5Cfrac%7B1%7D%7B%5Cleft%7C1-a+e%5E%7Bi+%5Clambda%7D%5Cright%7C%5E%7B2%7D%7D+%5C%5C+%26%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%5B1%2Ba%5E%7B2%7D-2+a+%5Ccos+%5Clambda%5Cright%5D%5E%7B-1%7D%2C+%5Clambda+%5Cin%5B-%5Cpi%2C+%5Cpi%5D+%5Cend%7Baligned%7D%5C%5C) 

### 例 AR(2)模型

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3Da_%7B1%7D+X_%7Bt-1%7D%2Ba_%7B2%7D+X_%7Bt-2%7D%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+%5Cvarepsilon_%7Bt%7D+%5Csim+%5Cmathrm%7BWN%7D%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D1-a_%7B1%7D+z-a_%7B2%7D+z%5E%7B2%7D+%5Cneq+0%2C%7Cz%7C+%5Cleq+1%5C%5C) 

要讨论的是，系数取何值，满足最小相位条件？

**结论**：稳定性条件下系数取值满足 ![[公式]](https://www.zhihu.com/equation?tex=a_%7B2%7D+%5Cpm+a_%7B1%7D%3C1%2C+%5Cquad%5Cleft%7Ca_%7B2%7D%5Cright%7C%3C1) 

将特征多项式改为 ![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Clambda%5E%7B2%7D-a_%7B1%7D+%5Clambda-a_%7B2%7D%3D0) ，那么要求这个多项式的根在单位圆内。分实根和复根两种情况：

**当判别式大于等于0时**，此时要求 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+-1%3C%5Clambda_%7B1%7D%3C1+%EF%BC%8C+-1%3C%5Clambda_%7B2%7D%3C%7B1%7D+%5Cend%7Barray%7D) ，而这等价于

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bl%7D+%5Cleft%28%5Clambda_%7B1%7D-1%5Cright%29%5Cleft%28%5Clambda_%7B2%7D-1%5Cright%29%3E0+%5C%5C+%5Cleft%28%5Clambda_%7B1%7D%2B1%5Cright%29%5Cleft%28%5Clambda_%7B2%7D%2B1%5Cright%29%3E0+%5C%5C+%7C%5Clambda_%7B1%7D%5Clambda_%7B2%7D%7C%3C1+%5Cend%7Barray%7D%5Cright.%5C%5C) 

由韦达定理

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bl%7D+%5Clambda_%7B1%7D+%5Clambda_%7B2%7D%3D-a_%7B2%7D+%5C%5C+%5Clambda_%7B1%7D%2B%5Clambda_%7B2%7D%3Da_%7B1%7D+%5Cend%7Barray%7D%5Cright.%5C%5C) 

结合等价条件中的第三个式子就推得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7Ca_%7B2%7D%5Cright%7C%3C1) ，而结合前两个式子可得

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bl%7D+-a_%7B2%7D-a_%7B1%7D%2B1%3E0+%5C%5C+-a_%7B2%7D%2Ba_%7B1%7D%2B1%3E0+%5Cend%7Barray%7D%5Cright.%5C%5C) 

就得到了稳定性条件。

当判别式小于0时，有

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bc%7D+%5Clambda_%7B1%7D%2B%5Cbar%7B%5Clambda%7D_%7B1%7D%3Da_%7B1%7D+%5C%5C+%5Clambda_%7B1%7D+%5Cbar%7B%5Clambda%7D_%7B1%7D%3D-a_%7B2%7D+%5C%5C+%5Cleft%7C%5Clambda_%7B1%7D%5Cright%7C%3C1+%5C%5C+%5Cleft%7C%5Cbar%7B%5Clambda%7D_%7B1%7D%5Cright%7C%3C1+%5Cend%7Barray%7D%5Cright.%5CLeftrightarrow%5Cleft%5C%7B%5Cbegin%7Baligned%7D+%5Cleft%281-%5Clambda_%7B1%7D%5Cright%29%5Cleft%281-%5Cbar%7B%5Clambda%7D_%7B1%7D%5Cright%29+%26%3D1-a_%7B1%7D-a_%7B2%7D%3E0+%5C%5C+%5Cleft%281%2B%5Clambda_%7B1%7D%5Cright%29%5Cleft%281%2B%5Cbar%7B%5Clambda%7D_%7B1%7D%5Cright%29+%26%3D1%2Ba_%7B1%7D-a_%7B2%7D%3E0+%5C%5C+%5Cmid+%5Clambda_%7B1%7D+%5Cbar%7B%5Clambda%7D_%7B1%7D+%7C%26%3D%5Cleft%7Ca_%7B2%7D%5Cright%7C%3C1+%5Cend%7Baligned%7D%5Cright.%5C%5C) 

右边的前两个式子即 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7C%5Clambda_%7B1%7D-1%5Cright%7C%3E0%2C%5Cleft%7C%5Clambda_%7B1%7D%2B1%5Cright%7C%3E0) 。事实上判别式大于0和小于0的情形，等价的条件是一样的，只不过大于0是用实数与1的大小，小于0则用复数的模。

稳定性条件下系数的取值如下图

![img](https://pic3.zhimg.com/80/v2-cddb3e9d0deaa7c3670f955adb826846_720w.jpg)



蓝的是判别式大于等于0，红的是判别式小于0。

接下来计算自相关函数和偏相关系数。由Y-W方程

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Crho_%7B0%7D%3D1+%5C%5C+%5Crho_%7B1%7D%3D%5Cfrac%7Ba_%7B1%7D%7D%7B1-a_%7B2%7D%7D+%5C%5C+%5Crho_%7Bk%7D%3Da_%7B1%7D+%5Crho_%7Bk-1%7D%2Ba_%7B2%7D+%5Crho_%7Bk-2%7D%2C+%5Cquad+k+%5Cgeq+1+%5Cend%7Barray%7D%5C%5C) 

其中最重要的就是反复利用推论：

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D-%5Cleft%28a_%7B1%7D+%5Cgamma_%7Bk-1%7D%2Ba_%7B2%7D+%5Cgamma_%7Bk-2%7D%2B%5Ccdots%2Ba_%7Bp%7D+%5Cgamma_%7Bk-p%7D%5Cright%29%3D%5Csigma%5E%7B2%7D+%5Cpsi_%7B-k%7D%5C%5C) 

剩下的内容留到下一讲。





## 2.5 例子（续）

上一讲的最后介绍了 AR 序列自相关系数的递推公式，现在来考察 AR(2) 自协方差函数的计算。

### （一）AR(2) 的自协方差函数

**例** ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D-0.7+X_%7Bt-1%7D%2B0.1+X_%7Bt-2%7D%3D%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+%5Cvarepsilon_%7Bt%7D+%5Csim+W+N%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29) 

**解法一**：Y-W 方程推论

根据 Y-W 方程的推论可以得到关于自协方差函数的如下递推关系

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%5C%7B+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B%7B%5Cgamma+_0%7D+-+0.7%7B%5Cgamma+_1%7D+%2B+0.1%7B%5Cgamma+_2%7D+%3D+%7B%5Csigma+%5E2%7D%7D%5C%5C+%7B%7B%5Cgamma+_k%7D+-+0.7%7B%5Cgamma+_%7Bk+-+1%7D%7D+%2B+0.1%7B%5Cgamma+_%7Bk+-+2%7D%7D+%3D+0%2C%5Cquad+k+%5Cge+1%7D+%5Cend%7Barray%7D%7D+%5Cright.%5C%5C%5C%5D) 

其中由第二个式子可得

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Cgamma+_k%7D+%3D+%7BC_1%7D%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B2%7D%7D+%5Cright%29%5Ek%7D+%2B+%7BC_2%7D%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B5%7D%7D+%5Cright%29%5Ek%7D%2C%5Cquad+k+%5Cge+0%5C%5C%5C%5D) 

考察 Y-W 方程推论在 k=0 和 1的情形

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%5C%7B+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B%7B%5Cgamma+_0%7D+-+0.7%7B%5Cgamma+_1%7D+%2B+0.1%7B%5Cgamma+_2%7D+%3D+%7B%5Csigma+%5E2%7D%7D%5C%5C+%7B%7B%5Cgamma+_1%7D+-+0.7%7B%5Cgamma+_0%7D+%2B+0.1%7B%5Cgamma+_1%7D+%3D+0%7D+%5Cend%7Barray%7D%7D+%5Cright.%5C%5C%5C%5D) 

我们需要解出两个待定的常数，利用得到的通解取 k=0 和 1，有

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Cgamma+_0%7D+%3D+%7BC_1%7D+%2B+%7BC_2%7D%2C%5Cquad+%7B%5Cgamma+_1%7D+%3D+%5Cfrac%7B1%7D%7B2%7D%7BC_1%7D+%2B+%5Cfrac%7B1%7D%7B5%7D%7BC_2%7D%5C%5C%5C%5D) 

将其代入上面的式子中化简得到

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%5C%7B+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B%5Cfrac%7B%7B27%7D%7D%7B%7B40%7D%7D%7BC_1%7D+%2B+%5Cfrac%7B%7B108%7D%7D%7B%7B125%7D%7D%7BC_2%7D+%3D+%7B%5Csigma+%5E2%7D%7D%5C%5C+%7B%7BC_1%7D+%2B+%5Cfrac%7B%7B16%7D%7D%7B5%7D%7BC_2%7D+%3D+0%7D+%5Cend%7Barray%7D%7D+%5Cright.+%5CRightarrow+%5Cleft%5C%7B+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bl%7D%7D+%7B%7BC_1%7D+%3D+%5Cfrac%7B%7B200%7D%7D%7B%7B81%7D%7D%7B%5Csigma+%5E2%7D%7D%5C%5C+%7B%7BC_2%7D+%3D++-+%5Cfrac%7B%7B125%7D%7D%7B%7B162%7D%7D%7B%5Csigma+%5E2%7D%7D+%5Cend%7Barray%7D%7D+%5Cright.%5C%5C%5C%5D) 

所以

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Cleft%5B%5Cfrac%7B200%7D%7B81%7D+%5Ctimes%5Cleft%28%5Cfrac%7B1%7D%7B2%7D%5Cright%29%5E%7B%7Ck%7C%7D-%5Cfrac%7B125%7D%7B162%7D+%5Ctimes%5Cleft%28%5Cfrac%7B1%7D%7B5%7D%5Cright%29%5E%7B%7Ck%7C%7D%5Cright%5D+%5Csigma%5E%7B2%7D%2C+%5Cquad+k+%5Cin+Z%5C%5C) 

**解法二**：级数展开

首先将特征多项式的倒数作有理因式分解，然后级数展开得到

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B%5Cfrac%7B1%7D%7B%7B1+-+0.7z+%2B+0.1%7Bz%5E2%7D%7D%7D+%3D+%5Cfrac%7B%7B+-+2%2F3%7D%7D%7B%7B1+-+0.2z%7D%7D+%2B+%5Cfrac%7B%7B5%2F3%7D%7D%7B%7B1+-+0.5z%7D%7D%7D%5C%5C+%7B+%3D+%5Csum%5Climits_%7Bj+%3D+0%7D%5E%7B+%2B+%5Cinfty+%7D+%7B%5Cleft%5B+%7B+-+%5Cfrac%7B2%7D%7B3%7D+%5Ctimes+%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B5%7D%7D+%5Cright%29%7D%5Ej%7D+%2B+%5Cfrac%7B5%7D%7B3%7D+%5Ctimes+%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B2%7D%7D+%5Cright%29%7D%5Ej%7D%7D+%5Cright%5D%7D+%7Bz%5Ej%7D%7D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

 这样得到 wold 系数为 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Cpsi+_j%7D+%3D++-+%5Cfrac%7B2%7D%7B3%7D+%5Ctimes+%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B5%7D%7D+%5Cright%29%5Ej%7D+%2B+%5Cfrac%7B5%7D%7B3%7D+%5Ctimes+%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B2%7D%7D+%5Cright%29%5Ej%7D%5C%5D) 

当 k≥0 时，有

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+%7B%5Cgamma+_k%7D+%3D+%5Csum%5Climits_%7Bj+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cpsi+_j%7D%7B%5Cpsi+_%7Bj+%2B+k%7D%7D%7D++%3D+%5Csum%5Climits_%7Bj+%3D+0%7D%5E%7B+%2B+%5Cinfty+%7D+%7B%5Cleft%5B+%7B+-+%5Cfrac%7B2%7D%7B3%7D+%5Ctimes+%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B5%7D%7D+%5Cright%29%7D%5Ej%7D+%2B+%5Cfrac%7B5%7D%7B3%7D+%5Ctimes+%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B2%7D%7D+%5Cright%29%7D%5Ej%7D%7D+%5Cright%5D%7D+%5Cleft%5B+%7B+-+%5Cfrac%7B2%7D%7B3%7D+%5Ctimes+%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B5%7D%7D+%5Cright%29%7D%5E%7Bj+%2B+k%7D%7D+%2B+%5Cfrac%7B5%7D%7B3%7D+%5Ctimes+%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B2%7D%7D+%5Cright%29%7D%5E%7Bj+%2B+k%7D%7D%7D+%5Cright%5D%7B%5Csigma+%5E2%7D%5C%5C++%3D+%5Csum%5Climits_%7B%7B%5Crm%7Bj%7D%7D+%3D+0%7D%5E%7B+%2B+%5Cinfty+%7D+%7B%5Cleft%5B+%7B%5Cfrac%7B4%7D%7B9%7D+%5Ctimes+%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B%7B25%7D%7D%7D+%5Cright%29%7D%5E%7B%5Crm%7Bj%7D%7D%7D+-+%5Cfrac%7B%7B10%7D%7D%7B9%7D+%5Ctimes+%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B%7B10%7D%7D%7D+%5Cright%29%7D%5E%7B%5Crm%7Bj%7D%7D%7D%7D+%5Cright%5D%7D+%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B5%7D%7D+%5Cright%29%5E%7B%5Crm%7Bk%7D%7D%7D%7B%5Csigma+%5E2%7D+%2B+%5Csum%5Climits_%7Bj+%3D+0%7D%5E%7B+%2B+%5Cinfty+%7D+%7B%5Cleft%5B+%7B+-+%5Cfrac%7B%7B10%7D%7D%7B9%7D+%5Ctimes+%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B%7B10%7D%7D%7D+%5Cright%29%7D%5Ej%7D+%2B+%5Cfrac%7B%7B25%7D%7D%7B9%7D+%5Ctimes+%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B4%7D%7D+%5Cright%29%7D%5Ej%7D%7D+%5Cright%5D%7D+%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B2%7D%7D+%5Cright%29%5Ek%7D%7B%5Csigma+%5E2%7D%5C%5C++%3D++-+%5Cfrac%7B%7B125%7D%7D%7B%7B162%7D%7D+%5Ctimes+%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B5%7D%7D+%5Cright%29%5E%7B%5Crm%7Bk%7D%7D%7D%7B%5Csigma+%5E2%7D+%2B+%5Cfrac%7B%7B200%7D%7D%7B%7B81%7D%7D+%5Ctimes+%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7B2%7D%7D+%5Cright%29%5E%7B%5Crm%7Bk%7D%7D%7D%7B%5Csigma+%5E2%7D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

这样也能得到同样的结果，但计算上会复杂一些，考试时不采用此种方法。

**解法三**：先算自相关系数，再算 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_0) 

首先根据定义有

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Cgamma+_0%7D+%3D+EX_t%5E2+%3D+E%7B%5Cleft%28+%7B0.7%7BX_%7Bt+-+1%7D%7D+-+0.1%7BX_%7Bt+-+2%7D%7D+%2B+%7B%5Cvarepsilon+_t%7D%7D+%5Cright%29%5E2%7D+%3D+0.49%7B%5Cgamma+_0%7D+%2B+0.01%7B%5Cgamma+_0%7D+%2B+%7B%5Csigma+%5E2%7D+-+0.14%7B%5Cgamma+_1%7D%5C%5C%5C%5D) 

结合 Y-W 推论取 k=1 的情形 ![[公式]](https://www.zhihu.com/equation?tex=%7B%7B%5Cgamma+_1%7D+-+0.7%7B%5Cgamma+_0%7D+%2B+0.1%7B%5Cgamma+_1%7D+%3D+0%7D) 可以联立解得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_0%2C%5Cgamma_1) 。

我自己算了一遍，解法一和解法三的时间是差不多的，但解法三会避免一次性进行多个分数的通分运算，所以我个人偏向于解法三。

但是，有991计算器的情况下解法一体现出了碾压性的优势！

### （二）AR(2) 的稳定域和允许域

上一讲的最后，我们计算得到使得 AR(2) 序列的特征根在单位圆外的系数满足

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathscr%7BA%7D%3D%5Cleft%5C%7B%5Cleft%28a_%7B1%7D%2C+a_%7B2%7D%5Cright%29%3A+a_%7B2%7D+%5Cpm+a_%7B1%7D%3C1%2C%5Cleft%7Ca_%7B2%7D%5Cright%7C%3C1%5Cright%5C%7D%5C%5C) 

这一集合称为 AR(2) 的**稳定域**。

而根据 Y-W 方程，偏相关系数和自相关系数能够互相表示如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bl%7D+%5Crho_%7B1%7D%3Da_%7B1%7D+%5Crho_%7B0%7D%2Ba_%7B2%7D+%5Crho_%7B1%7D+%5C%5C+%5Crho_%7B2%7D%3Da_%7B1%7D+%5Crho_%7B1%7D%2Ba_%7B2%7D+%5Crho_%7B0%7D+%5Cend%7Barray%7D%5Cright.%5C%5C%5CRightarrow+a_%7B1%7D%3D%5Cfrac%7B%5Crho_%7B1%7D%5Cleft%281-%5Crho_%7B2%7D%5Cright%29%7D%7B1-%5Crho_%7B1%7D%5E%7B2%7D%7D%2C+%5Cquad+a_%7B2%7D%3D%5Cfrac%7B%5Crho_%7B2%7D-%5Crho_%7B1%7D%5E%7B2%7D%7D%7B1-%5Crho_%7B1%7D%5E%7B2%7D%7D%5C%5C%5CRightarrow%5Crho_%7B1%7D%3D%5Cfrac%7Ba_%7B1%7D%7D%7B1-a_%7B2%7D%7D%2C+%5Cquad+%5Crho_%7B2%7D%3Da_%7B2%7D%2B%5Cfrac%7Ba_%7B1%7D%5E%7B2%7D%7D%7B1-a_%7B2%7D%7D) 

可以得到当偏相关系数落入稳定域时，自相关系数的取值范围

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathscr%7BC%7D%3D%5Cleft%5C%7B%5Cleft%28%5Crho_%7B1%7D%2C+%5Crho_%7B2%7D%5Cright%29%3A+%5Crho_%7B1%7D%5E%7B2%7D%3C%5Cleft%281%2B%5Crho_%7B2%7D%5Cright%29+%2F+2%2C%5Cleft%7C%5Crho_%7B1%7D%5Cright%7C%3C1%2C%5Cleft%7C%5Crho_%7B2%7D%5Cright%7C%3C1%5Cright%5C%7D%5C%5C) 

称这一集合为 AR(2) 的**允许域**。

**稳定域和允许域等价性的证明**：

由稳定域推允许域

![[公式]](https://www.zhihu.com/equation?tex=%5Cpm+a_%7B1%7D%3C1-a_%7B2%7D+%5CRightarrow%5Cleft%7Ca_%7B1%7D%5Cright%7C+%7C1-a_%7B2%7D%7C%5CRightarrow%7C+%5Crho_%7B1%7D+%5Cmid%3C1%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Crho+_2%7D+%3D+%5Crho+_1%5E2+%2B+%7Ba_2%7D%5Cleft%28+%7B1+-+%5Crho+_1%5E2%7D+%5Cright%29+%5CRightarrow+%7B%5Crho+_2%7D+%3C+%5Crho+_1%5E2+%2B+%7C%7Ba_2%7D%5Cmid++%5Ccdot+%5Cleft%28+%7B1+-+%5Crho+_1%5E2%7D+%5Cright%29+%3C+%5Crho+_1%5E2+%2B+%5Cleft%28+%7B1+-+%5Crho+_1%5E2%7D+%5Cright%29+%3C+1%5C%5C%5C%5D) 

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D++-+1+%3C+%5Cfrac%7B%7B%7B%5Crho+_2%7D+-+%5Crho+_1%5E2%7D%7D%7B%7B1+-+%5Crho+_1%5E2%7D%7D+%3C+1+%5CRightarrow++-+%5Cleft%28+%7B1+-+%5Crho+_1%5E2%7D+%5Cright%29+%3C+%7B%5Crho+_2%7D+-+%5Crho+_1%5E2+%3C+1+-+%5Crho+_1%5E2%5C%5C++%5CRightarrow+%5Crho+_1%5E2+%3C+%5Cleft%28+%7B1+%2B+%7B%5Crho+_2%7D%7D+%5Cright%29%2F2+%5Cend%7Barray%7D%5C%5C%5C%5D) 

由允许域推稳定域

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+%5Crho+_1%5E2+%3C+%5Cleft%28+%7B1+%2B+%7B%5Crho+_2%7D%7D+%5Cright%29%2F2+%5CRightarrow++-+%5Cleft%28+%7B1+-+%5Crho+_1%5E2%7D+%5Cright%29+%3C+%7B%5Crho+_2%7D+-+%5Crho+_1%5E2+%3C+1+-+%5Crho+_1%5E2%5C%5C++%5CRightarrow++-+1+%3C+%5Cfrac%7B%7B%7B%5Crho+_2%7D+-+%5Crho+_1%5E2%7D%7D%7B%7B1+-+%5Crho+_1%5E2%7D%7D+%3C+1+%5CRightarrow+%5Cleft%7C+%7B%7Ba_2%7D%7D+%5Cright%7C+%3C+1+%5Cend%7Barray%7D%5C%5C%5C%5D) 

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%7C+%7B%7B%5Crho+_1%7D%7D+%5Cright%7C+%3C+1+%5CRightarrow+%5Cleft%7C+%7B%7Ba_1%7D%7D+%5Cright%7C+%3C+%7C1+-+%7Ba_2%7D%5Cmid++%5CRightarrow++%5Cpm+%7Ba_1%7D+%3C+1+-+%7Ba_2%7D%5C%5C%5C%5D) 

**大致思路**：稳定域的前两式等价允许域中的第一式，稳定域中第三式对应于允许域中的后两式。

### （三）AR(2) 的谱密度

其谱密度的形式为 ![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D+%5Ccdot+%5Cfrac%7B1%7D%7B%5Cleft%7C1-a_%7B1%7D+e%5E%7Bi+%5Clambda%7D-a_%7B2%7D+e%5E%7B2+i+%5Clambda%7D%5Cright%7C%5E%7B2%7D%7D) 

### **（1）实根不相等情形**讨论：

设 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Clambda+_1%7D%2C%7B%5Clambda+_2%7D%5C%5D) 为 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Clambda+%5E2%7D+-+%7Ba_1%7D%5Clambda++-+%7Ba_2%7D+%3D+0%5C%5D) 的两个不相等实根，则自相关系数可以表示为

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk%7D%3Dc_%7B1%7D+%5Clambda_%7B1%7D%5E%7Bk%7D%2B%2Bc_%7B2%7D+%5Clambda_%7B2%7D%5E%7Bk%7D%2C+%5Cmathrm%7Bk%7D+%5Cgeq+0%5C%5C) 

其中待定的常数满足方程组

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bc%7D+c_%7B1%7D%2Bc_%7B2%7D%3D1+%5C%5C+c_%7B1%7D+%5Clambda_%7B1%7D%2Bc_%7B2%7D+%5Clambda_%7B2%7D%3D%5Crho_%7B1%7D+%5Cend%7Barray%7D%5Cright.%5C%5C) 

可以解得

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bl%7D+c_%7B1%7D%3D%5Cfrac%7B%5Clambda_%7B2%7D-%5Crho_%7B1%7D%7D%7B%5Clambda_%7B2%7D-%5Clambda_%7B1%7D%7D+%5C%5C+c_%7B2%7D%3D%5Cfrac%7B%5Crho_%7B1%7D-%5Clambda_%7B1%7D%7D%7B%5Clambda_%7B2%7D-%5Clambda_%7B1%7D%7D+%5Cend%7Barray%7D%5Cright.%5C%5C) 

而 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7B1%7D%3D%5Cfrac%7Ba_%7B1%7D%7D%7B1-a_%7B2%7D%7D%3D%5Cfrac%7B%5Clambda_%7B1%7D%2B%5Clambda_%7B2%7D%7D%7B1%2B%5Clambda_%7B1%7D+%5Clambda_%7B2%7D%7D) ，所以

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk%7D%3D%5Cfrac%7B%5Cleft%281-%5Clambda_%7B2%7D%5E%7B2%7D%5Cright%29+%5Clambda_%7B1%7D%5E%7Bk%2B1%7D-%5Cleft%281-%5Clambda_%7B1%7D%5E%7B2%7D%5Cright%29+%5Clambda_%7B2%7D%5E%7Bk%2B1%7D%7D%7B%5Cleft%28%5Clambda_%7B1%7D-%5Clambda_%7B2%7D%5Cright%29%5Cleft%281%2B%5Clambda_%7B1%7D+%5Clambda_%7B2%7D%5Cright%29%7D%2C+k+%5Cgeq+0%5C%5C) 

对应的谱密度为

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+f%28%5Clambda+%29+%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D+%5Ctimes+%5Cfrac%7B1%7D%7B%7B%7B%7B%5Cleft%7C+%7B1+-+%7B%5Clambda+_1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%7C%7D%5E2%7D+%5Ctimes+%7B%7B%5Cleft%7C+%7B1+-+%7B%5Clambda+_2%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%7C%7D%5E2%7D%7D%7D%5C%5C++%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D+%5Ctimes+%5Cfrac%7B1%7D%7B%7B%5Cleft%28+%7B1+%2B+%5Clambda+_1%5E2+-+2%7B%5Clambda+_1%7D%5Ccos+%5Clambda+%7D+%5Cright%29+%5Ctimes+%5Cleft%28+%7B1+%2B+%5Clambda+_2%5E2+-+2%7B%5Clambda+_2%7D%5Ccos+%5Clambda+%7D+%5Cright%29%7D%7D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

具体共有如图五种情形

![img](https://pic1.zhimg.com/80/v2-9704dc2f513fa479587dfc183d4dead4_720w.jpg)

以下介绍其中两个情形。

**当 a2>0, a1<0 时**：

考察 AR(2) 模型 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D-0.1+%2A+X_%7Bt-1%7D%2B0.3+%2A+X_%7Bt-2%7D%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+%5Cvarepsilon_%7Bt%7D+%5Csim+W+N%280%2C1%29) 

特征根为 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_%7B1%7D%3D-0.6%2C+%5Clambda_%7B2%7D%3D0.5) ，自相关系数为

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk%7D%3D%5Cfrac%7B45%7D%7B77%7D+%5Ctimes%28-0.6%29%5E%7Bk%7D%2B%5Cfrac%7B32%7D%7B77%7D+%5Ctimes+0.5%5E%7Bk%7D%2C+%5Cmathrm%7Bk%7D+%5Cgeq+0%5C%5C) 

谱密度为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi%281.36%2B1.2+%5Ccos+%5Clambda%29%281.25-%5Ccos+%5Clambda%29%7D%5C%5C) 

![img](https://pic2.zhimg.com/80/v2-b296b691e9ff31790c8227f6ca746d2d_720w.jpg)一次模拟结果

![img](https://pic4.zhimg.com/80/v2-b9f4ca20281398524f3cd7c34a6bfb6f_720w.jpg)自相关系数

![img](https://pic4.zhimg.com/80/v2-8e74c3baeaea6b32d44efe51bf5f4fc3_720w.jpg)谱密度函数

从谱密度的峰值可看出，具有周期 ![[公式]](https://www.zhihu.com/equation?tex=2%5Cpi%2F%5Cpi%3D2) 

**当 a2<0, a1>0 时**：

考察模型： ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D0.9+%2A+X_%7Bt-1%7D-0.2+%2A+X_%7Bt-2%7D%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+%5Cvarepsilon_%7Bt%7D+%5Csim+W+N%280%2C1%29) 

特征根为 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_%7B1%7D%3D0.5%2C+%5Clambda_%7B2%7D%3D0.4) ，自相关系数为

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk%7D%3D%5Cfrac%7B7%7D%7B2%7D+%5Ctimes+0.5%5E%7Bk%7D-%5Cfrac%7B5%7D%7B2%7D+%5Ctimes+0.4%5E%7Bk%7D%2C+%5Cmathrm%7Bk%7D+%5Cgeq+0%5C%5C) 

谱密度为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi%281.16-0.8+%5Ccos+%5Clambda%29%281.25-%5Ccos+%5Clambda%29%7D%5C%5C) 

![img](https://pic1.zhimg.com/80/v2-437a0a0376103610796544f77d97f040_720w.jpg)自相关系数单调衰减

![img](https://pic4.zhimg.com/80/v2-f3ba5ce98b26621dffe0b016c2061fb7_720w.jpg)谱密度峰值为0

由于谱密度的峰值只有 0，所以无周期性。

**注意**：谱密度应该是 ![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda+%29+%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D+%5Ctimes+%5Cfrac%7B1%7D%7B%7B%7B%7B%5Cleft%7C+%7B1+-+%7B%5Clambda+%5E%7B-1%7D_1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%7C%7D%5E2%7D+%5Ctimes+%7B%7B%5Cleft%7C+%7B1+-+%7B%5Clambda%5E%7B-1%7D+_2%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%7C%7D%5E2%7D%7D%7D) ，老师课件上写错了，后续模拟的图像应该还是对的。

### **（2）虚根情形讨论**：

设两个共轭虚根为 ![[公式]](https://www.zhihu.com/equation?tex=z_%7B1%7D%2C+z_%7B2%7D%3Db+e%5E%7B%5Cpm+i+%5Clambda_%7B0%7D%7D) ， ![[公式]](https://www.zhihu.com/equation?tex=b%3E1%2C+%5Clambda_%7B0%7D+%5Cneq+0%2C+%5Cpi) ，根据上一讲开头计算的那个式子（自协方差表示为 cos 形式）可得

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk%7D%3D%5Cfrac%7B%5Ccos+%5Cleft%28k+%5Clambda_%7B0%7D%2B%5Ctheta_%7B0%7D%5Cright%29%7D%7Bb%5E%7Bk%7D+%5Ccos+%5Cleft%28%5Ctheta_%7B0%7D%5Cright%29%7D%2C+%5Cquad+k+%5Cgeq+0%5C%5C) 

从上面这个形式可以看出，自相关系数指数衰减，并且有周期振荡特性，振荡的角频率为 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_0) 。相应的周期为 ![[公式]](https://www.zhihu.com/equation?tex=2%5Cpi%2F%5Clambda_0) 。

也可以从差分方程的角度推导自相关系数：

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+%7B%5Crho+_k%7D+%3D+%5Cleft%28+%7B%7Ba_1%7D+%2B+i%7Bb_1%7D%7D+%5Cright%29%7Bb%5E%7B+-+k%7D%7D%7Be%5E%7Bik%7B%5Clambda+_0%7D%7D%7D+%2B+%5Cleft%28+%7B%7Ba_2%7D+%2B+i%7Bb_2%7D%7D+%5Cright%29%7Bb%5E%7B+-+k%7D%7D%7Be%5E%7B+-+ik%7B%5Clambda+_0%7D%7D%7D%5C%5C++%3D+%5Cleft%5B+%7B%5Cleft%28+%7B%7Ba_1%7D+%2B+%7Ba_2%7D%7D+%5Cright%29%5Ccos+k%7B%5Clambda+_0%7D+%2B+%5Cleft%28+%7B%7Bb_2%7D+-+%7Bb_1%7D%7D+%5Cright%29%5Csin+k%7B%5Clambda+_0%7D%7D+%5Cright%5D%7Bb%5E%7B+-+k%7D%7D%5C%5C++%3D+%5Cleft%5B+%7B%7Bc_1%7D%5Ccos+k%7B%5Clambda+_0%7D+%2B+%7Bc_2%7D%5Csin+k%7B%5Clambda+_0%7D%7D+%5Cright%5D%7Bb%5E%7B+-+k%7D%7D%5C%5C++%3D+c%5Ccos+%5Cleft%28+%7Bk%7B%5Clambda+_0%7D+%2B+%7B%5Ctheta+_0%7D%7D+%5Cright%29%7Bb%5E%7B+-+k%7D%7D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

通过取 k=0 可以得到 c，结果和之前给出的一样。

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+f%28%5Clambda+%29+%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D+%5Ctimes+%5Cfrac%7B1%7D%7B%7B%7B%7B%5Cleft%7C+%7B1+-+z_1%5E%7B+-+1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%7C%7D%5E2%7D+%5Ctimes+%7B%7B%5Cleft%7C+%7B1+-+z_2%5E%7B+-+1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%7C%7D%5E2%7D%7D%7D%5C%5C++%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D+%5Ctimes+%5Cfrac%7B1%7D%7B%7B%5Cleft%28+%7B1+-+%7Bb%5E%7B+-+1%7D%7D%7Be%5E%7B+-+i%7B%5Clambda+_0%7D%7D%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%29+%5Ctimes+%5Cleft%28+%7B1+-+%7Bb%5E%7B+-+1%7D%7D%7Be%5E%7Bi%7B%5Clambda+_0%7D%7D%7D%7Be%5E%7B+-+i%5Clambda+%7D%7D%7D+%5Cright%29%7D%7D+%5Ctimes+%5Cfrac%7B1%7D%7B%7B%5Cleft%28+%7B1+-+%7Bb%5E%7B+-+1%7D%7D%7Be%5E%7Bi%7B%5Clambda+_0%7D%7D%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%29+%5Ctimes+%5Cleft%28+%7B1+-+%7Bb%5E%7B+-+1%7D%7D%7Be%5E%7B+-+i%7B%5Clambda+_0%7D%7D%7D%7Be%5E%7B+-+i%5Clambda+%7D%7D%7D+%5Cright%29%7D%7D%5C%5C++%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D+%5Ctimes+%5Cfrac%7B1%7D%7B%7B%5Cleft%28+%7B1+%2B+%7Bb%5E%7B+-+2%7D%7D+-+2%7Bb%5E%7B+-+1%7D%7D%5Ccos+%5Cleft%28+%7B%5Clambda++%2B+%7B%5Clambda+_0%7D%7D+%5Cright%29%7D+%5Cright%29%7D%7D%5Cfrac%7B1%7D%7B%7B%5Cleft%28+%7B1+%2B+%7Bb%5E%7B+-+2%7D%7D+-+2%7Bb%5E%7B+-+1%7D%7D%5Ccos+%5Cleft%28+%7B%5Clambda++-+%7B%5Clambda+_0%7D%7D+%5Cright%29%7D+%5Cright%29%7D%7D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B1+-+z_1%5E%7B+-+1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%2C1+-+z_2%5E%7B+-+1%7D%7Be%5E%7B+-+i%5Clambda+%7D%7D%5C%5D) 是共轭的，注意不是 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B1+-+z_1%5E%7B+-+1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%2C1+-+z_2%5E%7B+-+1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%5C%5D) ！

考察具体模型： ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7BX_t%7D+%3D+0.75++%7BX_%7Bt+-+1%7D%7D+-+0.5++%7BX_%7Bt+-+2%7D%7D+%2B+%7B%5Cvarepsilon+_t%7D%2C%7B%5Cvarepsilon+_t%7D%5Csim+WN%5Cleft%28+%7B0%2C%7B%5Csigma+%5E2%7D%7D+%5Cright%29%5C%5D) 

![img](https://pic1.zhimg.com/80/v2-894fe2c5ebdff22cf0b6ec27856965c4_720w.jpg)一次模拟结果

![img](https://pic1.zhimg.com/80/v2-7a26bf749673dceef8d29e1b094eb2ec_720w.jpg)自协方差函数振荡衰减

其中衰减的角频率为 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_0%3D0.9733) 

![img](https://pic3.zhimg.com/80/v2-e17dc82a5e93b349e9dfdb49942d2ea6_720w.jpg)谱密度函数

谱密度在 0.9733 处有峰值 。

## 第三章 MA 模型和 ARMA 模型

## 3.1 滑动平均模型

### （一）q 步相关（q 后截尾）

平稳序列的自协方差函数满足 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bq%7D+%5Cneq+0) 且 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D0%2C+k%3Eq) ，称该序列 q 步相关（q 步截尾）

现有一时间序列数据，其图像和自相关系数图像如下

![img](https://pic4.zhimg.com/80/v2-73ff408565a5c005c2bf7e6ec7edf757_720w.jpg)

![img](https://pic3.zhimg.com/80/v2-c52131ea9b96689fd1739bab11c9c42e_720w.jpg)

其自相关系数有衰减趋势，但并没有达到负指数的速度，我们对数据进行一阶差分得到

![img](https://pic2.zhimg.com/80/v2-6b4aed04d0986957adc5a9b1af89ac31_720w.jpg)

![img](https://pic2.zhimg.com/80/v2-0b5350b588fcc2a0e7166b64f15b7d65_720w.jpg)

其自相关系数一步截尾，因此可以拟合模型 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2B%5Chat%7Bb%7D+%5Cvarepsilon_%7Bt-1%7D%2C+t+%5Cin+%5Cmathbb%7BZ%7D) ，可得

![[公式]](https://www.zhihu.com/equation?tex=%7B%5Crho%7D_%7B1%7D%3D%5Cfrac%7B1%2Bb%5E2%7D%7Bb%7D%5CRightarrow%5Chat%7Bb%7D%3D%5Cfrac%7B1-%5Csqrt%7B1-4+%5Chat%7B%5Crho%7D_%7B1%7D%5E%7B2%7D%7D%7D%7B2+%5Chat%7B%5Crho%7D_%7B1%7D%7D%3D-0.5276%5C%5C) 

**注意**：由此可得 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_1%3C0.5) .

### （二）MA(q) 模型和 MA(q) 序列

定义 设 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%5C%7B+%7B%7B%5Cvarepsilon+_t%7D%7D+%5Cright%5C%7D%5C%5D) 是 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5BWN%5Cleft%28+%7B0%2C%7B%5Csigma+%5E2%7D%7D+%5Cright%29%5C%5D) ，如果实数 ![[公式]](https://www.zhihu.com/equation?tex=b_%7B1%7D%2C+b_%7B2%7D%2C+%5Cldots%2C+b_%7Bq%7D) 使得

![[公式]](https://www.zhihu.com/equation?tex=B%28z%29%3D1%2B%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+b_%7Bj%7D+z%5E%7Bj%7D+%5Cneq+0%2C%7Cz%7C%3C1%5C%5C) 

即特征多项式的根不在单位圆内，那么称

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+b_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

是 q 阶滑动平均模型，简称 MA(q) 模型。由上面式子决定的平稳序列，称为 MA(q) 序列。如果进一步要求单位圆上也没有零点，则称为可逆的 MA(q) 模型，相应的平稳序列为可逆的 MA(q) 序列。

**问**：根据定义，白噪声的线性和都是平稳序列，为什么要加条件？

**答**：对于根在单位圆内的，可以通过变换白噪声方差，使其满足根在单位圆外。

例如考察模型 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2B2+%5Cvarepsilon_%7Bt-1%7D%2C) ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cvarepsilon_t+%5Csim+WN%5Cleft%28+%7B0%2C%7B%5Csigma+%5E2%7D%7D+%5Cright%29%5C%5D) ，它的特征多项式的根在单位圆内

但是对于 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7BX_t%7D+%3D+%5Cvarepsilon+_t%5E%2A+%2B+%5Cfrac%7B1%7D%7B2%7D%5Cvarepsilon+_%7Bt+-+1%7D%5E%2A%2C%5C%5D) ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cvarepsilon_t%5E%2A+%5Csim+WN%5Cleft%28+%7B0%2C%7B4%5Csigma+%5E2%7D%7D+%5Cright%29%5C%5D) ，计算得两个模型的自协方差函数是一样的，而下面这个模型满足特征根不再单位圆内，所以是 MA(2) 模型。

### **（1）**可逆 MA 模型和 AR(∞) 

利用推移算子可将模型写为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3DB%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

由于根都在单位圆外，所以可以将特征多项式泰勒展开得到

![[公式]](https://www.zhihu.com/equation?tex=B%5E%7B-1%7D%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cphi_%7Bj%7D+z%5E%7Bj%7D%2C+%5Cquad%7Cz%7C+%5Cleq+1%2B%5Cdelta%28%5Cdelta%3E0%29%5C%5C) 

因此

![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D%3DB%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cphi_%7Bj%7D+X_%7Bt-j%7D%5C%5C) 

也就是说对于 MA 模型，用 AR 模型来建模也是可以的。

### （2）MA 序列的自协方差函数

记 ![[公式]](https://www.zhihu.com/equation?tex=b_0%3D1) ，则 MA(q) 序列的期望为 0 ，自协方差函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7Bk%7D+%26%3D%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%7D+X_%7Bt%2Bk%7D%5Cright%29+%5C%5C+%26%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7Bq-k%7D+b_%7Bj%7D+b_%7Bj%2Bk%7D%2C+%26+%26+0+%5Cleq+k+%5Cleq+q+%5C%5C+0%2C+%26+%26+k%3Eq+%5Cend%7Barray%7D%5Cright.+%5Cend%7Baligned%7D%5C%5C) 

### （3）MA 序列的谱密度

MA(q) 序列的自协方差函数是 q 后截尾的，并且有谱密度

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+f%28%5Clambda%29+%26%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7CB%5Cleft%28e%5E%7Bi+%5Clambda%7D%5Cright%29%5Cright%7C%5E%7B2%7D+%5C%5C+%26%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Csum_%7Bk%3D-q%7D%5E%7Bq%7D+%5Cgamma_%7Bk%7D+e%5E%7B-i+k+%5Clambda%7D%2C+%5Cquad+%5Clambda+%5Cin%5B-%5Cpi%2C+%5Cpi%5D+%5Cend%7Baligned%7D%5C%5C)  第一个等号为线性平稳序列的谱密度公式，第二个等号利用谱密度的自协方差反演公式。

下面来证明 MA(q) 序列和自协方差函数是 q 后截尾等价。首先给出一个引理，它表明谱密度公式的第二行**能倒推第一行**。

**引理** 假设有实常数 ![[公式]](https://www.zhihu.com/equation?tex=%5C%7Bc_j%5C%7D) 使得 ![[公式]](https://www.zhihu.com/equation?tex=c_q%5Cne0) ，且

![[公式]](https://www.zhihu.com/equation?tex=g%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Csum_%7Bj%3D-q%7D%5E%7Bq%7D+c_%7Bj%7D+e%5E%7B-i+j+%5Clambda%7D+%5Cgeq+0%2C+%5Clambda+%5Cin%5B-%5Cpi%2C+%5Cpi%5D%5C%5C) 

那么有唯一的实系数多项式满足单位圆内没根

![[公式]](https://www.zhihu.com/equation?tex=B%28z%29%3D1%2B%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+b_%7Bj%7D+z%5E%7Bj%7D+%5Cneq+0%2C%7Cz%7C%3C1%2C+b_%7Bq%7D+%5Cneq+0%5C%5C) 

并且

![[公式]](https://www.zhihu.com/equation?tex=g%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7CB%5Cleft%28e%5E%7Bi+%5Clambda%7D%5Cright%29%5Cright%7C%5E%7B2%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E2) 是某个常数。

**证明**：

**首先**常数 ![[公式]](https://www.zhihu.com/equation?tex=%5C%7Bc_j%5C%7D) 的对称性并不是显然的，但谱密度公式中自协方差函数是具有对称性的，所以先来证明 ![[公式]](https://www.zhihu.com/equation?tex=%5C%7Bc_j%5C%7D) 的对称性。

注意到 ![[公式]](https://www.zhihu.com/equation?tex=g%28%5Clambda%29) 是实数，所以对等式两边同取共轭复数得到

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cfrac%7B1%7D%7B%7B2%5Cpi+%7D%7D%5Csum%5Climits_%7Bj+%3D++-+q%7D%5Eq+%7B%7Bc_j%7D%7D+%7Be%5E%7B+-+ij%5Clambda+%7D%7D+%3D+%5Cfrac%7B1%7D%7B%7B2%5Cpi+%7D%7D%5Csum%5Climits_%7Bj+%3D++-+q%7D%5Eq+%7B%7Bc_j%7D%7D+%7Be%5E%7Bij%5Clambda+%7D%7D%5C%5C%5C%5D) 

等式右边用 j=-j 替代得到

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cfrac%7B1%7D%7B%7B2%5Cpi+%7D%7D%5Csum%5Climits_%7Bj+%3D++-+q%7D%5Eq+%7B%7Bc_j%7D%7D+%7Be%5E%7B+-+ij%5Clambda+%7D%7D+%3D+%5Cfrac%7B1%7D%7B%7B2%5Cpi+%7D%7D%5Csum%5Climits_%7Bj+%3D++-+q%7D%5Eq+%7B%7Bc_%7B+-+j%7D%7D%7D+%7Be%5E%7B+-+ij%5Clambda+%7D%7D%5C%5C%5C%5D) 

两者相减得到

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Csum%5Climits_%7Bj+%3D++-+q%7D%5Eq+%7B%5Cleft%28+%7B%7Bc_j%7D+-+%7Bc_%7B+-+j%7D%7D%7D+%5Cright%29%7D+%7Be%5E%7B+-+ij%5Clambda+%7D%7D+%3D+0%5C%5C%5C%5D) 

这个形式可以看成一个关于 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7Be%5E%7B+-+i%5Clambda+%7D%7D%5C%5D) 的多项式，它恒等于 0 ，等价于系数为 0，这就得到了 ![[公式]](https://www.zhihu.com/equation?tex=%5C%7Bc_j%5C%7D) 的对称性。

**接下来**令 ![[公式]](https://www.zhihu.com/equation?tex=G%28z%29%3D%5Csum_%7Bj%3D-q%7D%5E%7Bq%7D+c_%7Bj%7D+z%5E%7Bj%7D) ，则该多项式的 2q 个根中，每一个根的倒数也必然是根（因为 ![[公式]](https://www.zhihu.com/equation?tex=G%28z%29%3DG%28z%5E%7B-1%7D%29) ），我们把这 q 对根中，所有不在单位圆内的根取出来，就得到 q 个不在单位圆内的根，由这些根组合可得 B(z) 。

然后考虑 ![[公式]](https://www.zhihu.com/equation?tex=g%28%5Clambda%29) ，它的每一对互为倒数的**实根**对应的因子为 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%28+%7B1+-+%5Cfrac%7B%7B%7Be%5E%7Bi%5Clambda+%7D%7D%7D%7D%7B%7B%7Bz_1%7D%7D%7D%2C1+-+%7Bz_1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%29%5C%5D) ，而

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B1+-+%7Bz_1%7D%7Be%5E%7Bi%5Clambda+%7D%7D+%3D+%7Bz_1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%5Cleft%28+%7B+-+1+%2B+%5Cfrac%7B%7B%7Be%5E%7B+-+i%5Clambda+%7D%7D%7D%7D%7B%7B%7Bz_1%7D%7D%7D%7D+%5Cright%29%5C%5C%5C%5D) 

因此 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%28+%7B1+-+%5Cfrac%7B%7B%7Be%5E%7Bi%5Clambda+%7D%7D%7D%7D%7B%7B%7Bz_1%7D%7D%7D%2C1+-+%7Bz_1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%29%5C%5D) 是共轭的，两者相乘便得到引理中模平方的结构。

而对于每一对互为倒数的复根，我们需要找到与其共轭的另外一对互为倒数的复根，这样对应的 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%28+%7B1+-+%5Cfrac%7B%7B%7Be%5E%7Bi%5Clambda+%7D%7D%7D%7D%7B%7B%7Bz_1%7D%7D%7D%2C1+-+%7B%7B%5Cbar+z%7D_1%7D%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%29%5C%5D) 才是共轭的。，这是需要注意的地方。

而当 q 后截尾且自协方差绝对可和的时候，谱密度可以写为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B2+%5Cpi%7D+%5Csum_%7Bk%3D-q%7D%5E%7Bq%7D+%5Cgamma_%7Bk%7D+e%5E%7B-i+k+%5Clambda%7D%5C%5C) 

根据引理 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5Bf%28%5Clambda+%29+%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D%5Cmid+B%5Cleft%28+%7B%7Be%5E%7B+-+i%5Clambda+%7D%7D%7D+%5Cright%29%7B%7B%5Crm%7B%7C%7D%7D%5E2%7D%5C%5D) ，其中 ![[公式]](https://www.zhihu.com/equation?tex=B%28z%29) 在单位圆内没有根（这里严格来说还要讨论根在单位圆上的情形，但这比较复杂，就略去了，后面就假定单位圆上也没有根），利用线性滤波的谱密度公式可得

![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D%3DB%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%5C%5C) 

是白噪声序列，这就证明了 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 是 MA(q) 序列。

### （3）MA 序列系数的计算

### 线性迭代法：

自协方差函数可以写为

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Csigma%5E%7B2%7D%5Cleft%28b_%7B0%7D+b_%7Bk%7D%2Bb_%7B1%7D+b_%7Bk%2B1%7D%2B%5Ccdots%2Bb_%7Bq-k%7D+b_%7Bq%7D%5Cright%29%2C+%5Cquad+0+%5Cleq+k+%5Cleq+q%5C%5C) 

进而

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bc%7D+%5Csigma%5E%7B2%7D%3D%5Cfrac%7B%5Cgamma_%7B0%7D%7D%7B1%2Bb_%7B1%7D%5E%7B2%7D%2Bb_%7B2%7D%5E%7B2%7D%2B%5Ccdots%2Bb_%7Bq%7D%5E%7B2%7D%7D+%5C%5C+b_%7Bk%7D%3D%5Cfrac%7B%5Cgamma_%7Bk%7D%7D%7B%5Csigma%5E%7B2%7D%7D-%5Cleft%28b_%7B1%7D+b_%7Bk%2B1%7D%2Bb_%7B2%7D+b_%7Bk%2B2%7D%2B%5Ccdots%2Bb_%7Bq-k%7D+b_%7Bq%7D%5Cright%29%2C+1+%5Cleq+k+%5Cleq+q-1+%5C%5C+b_%7Bq%7D%3D%5Cfrac%7B%5Cgamma_%7Bq%7D%7D%7B%5Csigma%5E%7B2%7D%7D+%5Cend%7Barray%7D%5Cright.%5C%5C) 

### Newton-Raphson算法：

递推式为

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Baligned%7D+%5Cleft%281%2Bb_%7B1%7D%5E%7B2%7D%2Bb_%7B2%7D%5E%7B2%7D%2B%5Ccdots%2Bb_%7Bq%7D%5E%7B2%7D%5Cright%29+%5Csigma%5E%7B2%7D-%5Cgamma_%7B0%7D+%26%3D0+%5C%5C+%5Cleft%28b_%7Bk%7D%2Bb_%7B1%7D+b_%7Bk%2B1%7D%2Bb_%7B2%7D+b_%7Bk%2B2%7D%2B%5Ccdots%2Bb_%7Bq-k%7D+b_%7Bq%7D%5Cright%29+%5Csigma%5E%7B2%7D-%5Cgamma_%7Bk%7D+%26%3D0%2C1+%5Cleq+k+%5Cleq+q-1%2C+%5C%5C+b_%7Bq%7D+%5Csigma%5E%7B2%7D-%5Cgamma_%7Bq%7D%3D0+%5Cend%7Baligned%7D%5Cright.%5C%5C) 

利用牛顿法迭代解多元非线性方程组的公式

![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D%5E%7B%28k%2B1%29%7D%3D%5Cboldsymbol%7Bx%7D%5E%7B%28k%29%7D-%5Cboldsymbol%7BJ%7D%5E%7B-1%7D%5Cleft%28%5Cboldsymbol%7Bx%7D%5E%7B%28k%29%7D%5Cright%29+%5Cboldsymbol%7BF%7D%5Cleft%28%5Cboldsymbol%7Bx%7D%5E%7B%28k%29%7D%5Cright%29%5C%5C) 

### 教材介绍的方法（来自一篇研究生论文）：

记

![[公式]](https://www.zhihu.com/equation?tex=A%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bllllll%7D+0+%26+1+%26+0+%26+%5Ccdots+%26+0+%26+0+%5C%5C+0+%26+0+%26+1+%26+%5Ccdots+%26+0+%26+0+%5C%5C+%5Ccdots+%26+%5Ccdots+%26+%26+%5Ccdots+%26+%5Ccdots+%26+%5C%5C+0+%26+0+%26+0+%26+%5Ccdots+%26+0+%26+1+%5C%5C+0+%26+0+%26+0+%26+%5Ccdots+%26+0+%26+0+%5Cend%7Barray%7D%5Cright%29_%7Bq+%5Ctimes+q%7D%2C+%5Cquad+C%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+1+%5C%5C+0+%5C%5C+%5Cvdots+%5C%5C+0+%5Cend%7Barray%7D%5Cright%29_%7Bq+%5Ctimes+1%7D%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5COmega_%7Bk%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bcccc%7D+%5Cgamma_%7B1%7D+%26+%5Cgamma_%7B2%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bk%7D+%5C%5C+%5Cgamma_%7B2%7D+%26+%5Cgamma_%7B3%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bk%2B1%7D+%5C%5C+%5Ccdots+%26+%5Ccdots+%26+%5Ccdots+%26+%5Ccdots+%5C%5C+%5Cgamma_%7Bq%7D+%26+%5Cgamma_%7Bq%2B1%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bq%2Bk-1%7D+%5Cend%7Barray%7D%5Cright%29%2C+%5Cquad+%5Cgamma_%7Bq%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cgamma_%7B1%7D+%5C%5C+%5Cgamma_%7B2%7D+%5C%5C+%5Cvdots+%5C%5C+%5Cgamma_%7Bq%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

MA 序列的系数可由下面的公式计算得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bb%7D_%7Bq%7D%3D%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cleft%28%5Cgamma_%7Bq%7D-A+%5CPi+C%5Cright%29%2C+%5Cquad+%5Csigma%5E%7B2%7D%3D%5Cgamma_%7B0%7D-C%5E%7BT%7D+%5CPi+C%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5CPi%3D%5Clim+_%7Bk+%5Crightarrow+%5Cinfty%7D+%5COmega_%7Bk%7D+%5CGamma_%7Bk%7D%5E%7B-1%7D+%5COmega_%7Bk%7D%5E%7BT%7D) 

**例** 考察模型 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D-0.36+%5Cvarepsilon_%7Bt-1%7D%2B0.85+%5Cvarepsilon_%7Bt-2%7D) 

首先计算两个特征根得到 ![[公式]](https://www.zhihu.com/equation?tex=1.084652+e%5E%7B%5Cpm+i+1.374297%7D) ，然后计算自协方差函数

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+%7B%5Cgamma+_0%7D+%3D+%7B%5Csigma+%5E2%7D%5Cleft%28+%7B1+%2B+b_1%5E2+%2B+b_2%5E2%7D+%5Cright%29+%3D+7.4084%5C%5C+%7B%5Cgamma+_1%7D+%3D+%7B%5Csigma+%5E2%7D%5Cleft%28+%7B%7Bb_1%7D+%2B+%7Bb_1%7D%7Bb_2%7D%7D+%5Cright%29+%3D++-+2.664%5C%5C+%7B%5Cgamma+_2%7D+%3D+%7B%5Csigma+%5E2%7D%7Bb_2%7D+%3D+3.4%5C%5C+%7B%5Cgamma+_k%7D+%3D+0%2C%5Cquad+k+%3E+2+%5Cend%7Barray%7D%5C%5C%5C%5D) 

现在我们从自协方差函数出发，求解 MA(2) 模型的系数。

利用公式

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+b_%7B1%7D+%5C%5C+b_%7B2%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cleft%28%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+%5Cgamma_%7B1%7D+%5C%5C+%5Cgamma_%7B2%7D+%5Cend%7Barray%7D%5Cright%29-A+%5CPi+C%5Cright%29+%5Cquad+%5Csigma%5E%7B2%7D%3D%5Cgamma_%7B0%7D-C%5E%7BT%7D+%5CPi+C%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5CPi%3D%5Clim+_%7Bk+%5Crightarrow+%5Cinfty%7D+%5COmega_%7Bk%7D+%5CGamma_%7Bk%7D%5E%7B-1%7D+%5COmega_%7Bk%7D%5E%7BT%7D) ，以下给出不同 k 值的程序运行结果

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7B%7Cc%7Cc%7Cc%7Cc%7Cc%7Cc%7Cc%7C%7D+%5Chline+k+%26+6+%26+12+%26+20+%26+30+%26+40+%26+%3E%3D51+%5C%5C+%5Chline+b_%7B1%7D+%26+-0.3367+%26+-0.3527+%26+-0.3587+%26+-0.3597+%26+-0.3599+%26+-0.3600+%5C%5C+%5Chline+b_%7B2%7D+%26+0.7515+%26+0.8234+%26+0.8421+%26+0.8487+%26+0.8497+%26+0.8500+%5C%5C+%5Chline+%5Csigma%5E%7B2%7D+%26+4.5243+%26+4.1292+%26+4.0374+%26+4.0062+%26+4.0014+%26+4.0002+%5C%5C+%5Chline+%5Cend%7Barray%7D%5C%5C) 

### （4）MA(1) 序列讨论

考察可逆的 MA(1) 模型

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2Bb+%5Cvarepsilon_%7Bt-1%7D%2C+%5Cquad+%5Cvarepsilon_%7Bt%7D+%5Csim+%5Cmathrm%7BWN%7D%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29%2C+%5Cquad%7Cb%7C%3C1%5C%5C) 

自协方差和自相关系数如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bl%7D+%5Cgamma_%7B0%7D%3D%5Csigma%5E%7B2%7D%5Cleft%281%2Bb%5E%7B2%7D%5Cright%29+%5C%5C+%5Cgamma_%7B1%7D%3D%5Csigma%5E%7B2%7D+b+%5C%5C+%5Cgamma_%7Bk%7D%3D0%2C+%5Cquad+k+%5Cgeq+2+%5Cend%7Barray%7D+%5Cquad%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bl%7D+%5Crho_%7B1%7D%3D%5Cfrac%7Bb%7D%7B1%2Bb%5E%7B2%7D%7D+%5C%5C+%5Crho_%7Bk%7D%3D0%2C+%5Cquad+k+%5Cgeq+2+%5Cend%7Barray%7D%5Cright.%5Cright.%5C%5C) 

谱密度为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+f%28%5Clambda%29+%26%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C1%2Bb+e%5E%7Bi+%5Clambda%7D%5Cright%7C%5E%7B2%7D+%5C%5C+%26%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%281%2Bb%5E%7B2%7D%2B2+b+%5Ccos+%5Clambda%5Cright%29%2C+%5Clambda+%5Cin%5B-%5Cpi%2C+%5Cpi%5D+%5Cend%7Baligned%7D%5C%5C) 

下面利用 Y-W 方程求解偏相关系数

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%28+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B1+%2B+%7Bb%5E2%7D%7D%26%7B+-+b%7D%260%26+%5Ccdots+%260%5C%5C+%7B+-+b%7D%26%7B1+%2B+%7Bb%5E2%7D%7D%26%7B+-+b%7D%26+%5Ccdots+%260%5C%5C++%5Cvdots+%26+%5Cvdots+%26+%5Cvdots+%26+%5Cvdots+%26+%5Cvdots+%5C%5C+0%260%26%7B+-+b%7D%26%7B1+%2B+%7Bb%5E2%7D%7D%26%7B+-+b%7D%5C%5C+0%260%260%26%7B+-+b%7D%26%7B1+%2B+%7Bb%5E2%7D%7D+%5Cend%7Barray%7D%7D+%5Cright%29%5Cleft%28+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B%7Ba_%7Bn1%7D%7D%7D%5C%5C+%7B%7Ba_%7Bn2%7D%7D%7D%5C%5C++%5Cvdots+%5C%5C+%7B%7Ba_%7Bn%2Cn+-+1%7D%7D%7D%5C%5C+%7B%7Ba_%7Bnn%7D%7D%7D+%5Cend%7Barray%7D%7D+%5Cright%29+%3D+%5Cleft%28+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B+-+b%7D%5C%5C+0%5C%5C++%5Cvdots+%5C%5C+0%5C%5C+0+%5Cend%7Barray%7D%7D+%5Cright%29%5C%5C%5C%5D) 

利用克莱姆法则求解，记左边系数行列式为 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta_n) ，则由递推式

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5CDelta_%7B1%7D%3D1%2Bb%5E%7B2%7D+%5C%5C+%5CDelta_%7B2%7D%3D%5Cleft%7C%5Cbegin%7Barray%7D%7Bcc%7D+1%2Bb%5E%7B2%7D+%26+-b+%5C%5C+-b+%26+1%2Bb%5E%7B2%7D+%5Cend%7Barray%7D%5Cright%7C%3D1%2Bb%5E%7B2%7D%2Bb%5E%7B4%7D+%5C%5C+%5CDelta_%7Bn%7D%3D%5Cleft%281%2Bb%5E%7B2%7D%5Cright%29+%5CDelta_%7Bn%3D1%7D-b%5E%7B2%7D+%5CDelta_%7Bn-2%7D%2C+%5Cquad+n+%5Cgeq+3+%5Cend%7Barray%7D%5C%5C) 

求解这个差分方程可得

![[公式]](https://www.zhihu.com/equation?tex=%5CDelta_%7Bn%7D%3D%5Cfrac%7B1-b%5E%7B2+n%2B2%7D%7D%7B1-b%5E%7B2%7D%7D%2C+%5Cquad+n+%5Cgeq+1%5C%5C) 

继而用克莱姆法则解得偏相关系数为

![[公式]](https://www.zhihu.com/equation?tex=a_%7Bn+n%7D%3D%5Cfrac%7B%28-1%29%5E%7Bn-1%7D%28-b%29%5E%7Bn%7D%7D%7B%5CDelta_%7Bn%7D%7D%3D%28-1%29%5E%7Bn%2B1%7D+b%5E%7Bn%7D%5Cleft%281-b%5E%7B2%7D%5Cright%29%5Cleft%281-b%5E%7B2+n%2B2%7D%5Cright%29%5E%7B-1%7D%2C+%5Cquad+n+%5Cgeq+1%5C%5C) 





### （5）特殊的 MA 序列

考察模型 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7BX_t%7D+%3D+3%7B%5Cvarepsilon+_t%7D+%2B+4%7B%5Cvarepsilon+_%7Bt+-+1%7D%7D%2C%7B%5Cvarepsilon+_t%7D+%5Csim+WN%5Cleft%28+%7B0%2C%7B%5Csigma+%5E2%7D%7D+%5Cright%29%5C%5D) ，它并不是“直观”的 MA 模型，但我们可以计算得到它的自协方差函数为

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+%7B%5Cgamma+_0%7D+%3D+EX_t%5E2+%3D+25%7B%5Csigma+%5E2%7D%5C%5C+%7B%5Cgamma+_1%7D+%3D+E%7BX_t%7D%7BX_%7Bt+-+1%7D%7D+%3D+12%7B%5Csigma+%5E2%7D%5C%5C+%7B%5Cgamma+_k%7D+%3D+0%2C%5C%3B%5C%3B%5C%3B%5C%3Bk+%5Cgeq+2+%5Cend%7Barray%7D%5C%5C%5C%5D) 

其自协方差函数是 1 步截尾的，所以它是 MA(1) 序列。

因此存在 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cvarepsilon+_t%5E%2A+%5Csim+WN%5Cleft%28+%7B0%2C%5Csigma+_%2A%5E2%7D+%5Cright%29%5C%5D) ，使得

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7BX_t%7D+%3D+%5Cvarepsilon+_t%5E%2A+%2B+b%5Cvarepsilon+_%7Bt+-+1%7D%5E%2A%2C%5C%3B%5C%3B%5C%3B%5C%3B%7Cb%7C+%5Cleq+1%5C%5C%5C%5D) 

为了求 b 以及白噪声方差，我们计算新模型的自协方差函数得到

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+%7B%5Cgamma+_0%7D+%3D+EX_t%5E2+%3D+%5Cleft%28+%7B1+%2B+%7Bb%5E2%7D%7D+%5Cright%29%5Csigma+_%2A%5E2+%3D+25%7B%5Csigma+%5E2%7D%5C%5C+%7B%5Cgamma+_1%7D+%3D+E%7BX_t%7D%7BX_%7Bt+-+1%7D%7D+%3D+b%5Csigma+_%2A%5E2+%3D+12%7B%5Csigma+%5E2%7D%5C%5C+%7B%5Cgamma+_k%7D+%3D+0%2C%5C%3B%5C%3B%5C%3B%5C%3Bk+%5Cge+2+%5Cend%7Barray%7D%5C%5C%5C%5D) 

由此可得 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B12%5Cleft%28+%7B1+%2B+%7Bb%5E2%7D%7D+%5Cright%29+%3D+25b%5C%5D) ，解之得

![[公式]](https://www.zhihu.com/equation?tex=%5C%5Bb+%3D+3%2F4%5C%3B%5C%3Bor%5C%3B%5C%3B4%2F3%28%E8%88%8D%E5%8E%BB%29%5C%5C%5C%5D) 

将 b 回代可得白噪声方差为 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Csigma+_%2A%5E2+%3D+16%7B%5Csigma+%5E2%7D%5C%5D) 

从 b 的解有两个能够看出，如果我们不施加**最小相位条件**，那么得到的模型表示可能不唯一。

### （6）MA(2) 序列

对于可逆的 MA(2) 序列

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2Bb_%7B1%7D+%5Cvarepsilon_%7Bt-1%7D%2Bb_%7B2%7D+%5Cvarepsilon_%7Bt-2%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

满足特征多项式的根不在单位圆内，即

![[公式]](https://www.zhihu.com/equation?tex=B%28z%29%3D1%2Bb_%7B1%7D+z%2Bb_%7B2%7D+z%5E%7B2%7D+%5Cneq+0%2C%7Cz%7C+%5Cleq+1%5C%5C) 

那么系数的取值范围是

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26%5Cleft%5C%7B%5Cleft%28b_%7B1%7D%2C+b_%7B2%7D%5Cright%29%3A+B%28z%29+%5Cneq+0%2C%7Cz%7C+%5Cleq+1%5Cright%5C%7D+%5C%5C+%3D%26%5Cleft%5C%7B%5Cleft%28b_%7B1%7D%2C+b_%7B2%7D%5Cright%29%3A+b_%7B2%7D+%5Cpm+b_%7B1%7D%3E-1%2C%5Cleft%7Cb_%7B2%7D%5Cright%7C%3C1%5Cright%5C%7D+%5Cend%7Baligned%7D%5C%5C) 

这里利用 AR(2) 序列的稳定域的结论，令其中的 a1=-b1, a2=-b2 即得该范围。这个范围也称为 MA(2) 序列的**可逆域**。

其自协方差函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bll%7D+%5Cgamma_%7B0%7D%3D%5Csigma%5E%7B2%7D%5Cleft%281%2Bb_%7B1%7D%5E%7B2%7D%2Bb_%7B2%7D%5E%7B2%7D%5Cright%29+%26+%5Cgamma_%7B2%7D%3D%5Csigma%5E%7B2%7D+b_%7B2%7D+%5C%5C+%5Cgamma_%7B1%7D%3D%5Csigma%5E%7B2%7D%5Cleft%28b_%7B1%7D%2Bb_%7B1%7D+b_%7B2%7D%5Cright%29+%26+%5Cgamma_%7Bk%7D%3D0%2C+%5Cquad+k%3E2+%5Cend%7Barray%7D%5C%5C) 

自相关系数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Crho_%7B1%7D%3D%5Cfrac%7Bb_%7B1%7D%2Bb_%7B1%7D+b_%7B2%7D%7D%7B1%2Bb_%7B1%7D%5E%7B2%7D%2Bb_%7B2%7D%5E%7B2%7D%7D%2C+%5Cquad+%5Crho_%7B2%7D%3D%5Cfrac%7Bb_%7B2%7D%7D%7B1%2Bb_%7B1%7D%5E%7B2%7D%2Bb_%7B2%7D%5E%7B2%7D%7D+%5C%5C+%5Crho_%7Bk%7D%3D0%2C+%5Cquad+k%3E2+%5Cend%7Barray%7D%5C%5C) 

谱密度为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C1%2Bb_%7B1%7D+e%5E%7Bi+%5Clambda%7D%2Bb_%7B2%7D+e%5E%7Bi+2+%5Clambda%7D%5Cright%7C%5E%7B2%7D%5C%5C) 

## 3.2 自回归滑动平均 ARMA 模型

主要介绍**四个内容**并介绍一些例子：

- 模型定义及平稳解
- 自协方差函数
- 可识别性
- 谱密度和可逆性

### （一）ARMA 模型

设 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Cvarepsilon+_t%7D+%5Csim+WN%5Cleft%28+%7B0%2C%7B%5Csigma+%5E2%7D%7D+%5Cright%29%5C%5D) ，实系数多项式 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%2CB%28z%29) **无公共根（否则模型可简化）**，且满足 ![[公式]](https://www.zhihu.com/equation?tex=b_0%3D1%2Ca_pb_q+%5Cne+0) （保证多项式为 p,q 阶），且满足**最小相位条件**（为了模型的唯一性）

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+A%28z%29%3D1-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+z%5E%7Bj%7D+%5Cneq+0%2C%7Cz%7C+%5Cleq+1+%5C%5C+B%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+b_%7Bj%7D+z%5E%7Bj%7D+%5Cneq+0%2C%7Cz%7C%3C1+%5Cend%7Barray%7D%5C%5C) 

称

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%2B%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+b_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

为自回归滑动平均模型，简称 **ARMA(p,q) 模型**。其平稳序列称为 **ARMA(p,q) 序列**。

为了求平稳解，先介绍一个引理（实际上 AR 序列部分已经介绍）

**引理** 设实系数多项式 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+%5Cphi_%7Bj%7D+z%5E%7Bj%7D) 满足最小相位条件，则存在 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdelta%3E0) 

![[公式]](https://www.zhihu.com/equation?tex=A%5E%7B-1%7D%28z%29+%5Ctriangleq+%5Cfrac%7B1%7D%7BA%28z%29%7D%3D%5Csum_%7Bi%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+z%5E%7Bj%7D%2C+%5Cquad%7Cz%7C+%5Cleq+1%2B%5Cdelta%5C%5C) 

且对有界数列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7By_%7Bt%7D%5Cright%5C%7D) 和平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 有

![[公式]](https://www.zhihu.com/equation?tex=y_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+A%28%5Cmathscr%7BB%7D%29+y_%7Bt%7D%3DA%28%5Cmathscr%7BB%7D%29+A%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+y_%7Bt%7D%5C%5CX_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DA%28%5Cmathscr%7BB%7D%29+A%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%2C+%5Cquad+%5Ctext+%7B+a.s.+%7D%5C%5C) 

### （二）ARMA 模型平稳解

将模型记为 ![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DB%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D) ，由于定义中要求多项式满足最小相位条件，所以根据引理有泰勒展开式

![[公式]](https://www.zhihu.com/equation?tex=%5CPsi%28z%29+%5Ctriangleq+A%5E%7B-1%7D%28z%29+B%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+z%5E%7Bj%7D%2C+%5Cquad%7Cz%7C+%5Cleq+%5Crho%5C%5C) 

因为级数收敛，所以系数是负指数趋于 0 的（这里的系数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cpsi_%7Bj%7D%5Cright%5C%7D) 称为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 的**wold系数**），同时作用 ![[公式]](https://www.zhihu.com/equation?tex=A%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29) 可得

![[公式]](https://www.zhihu.com/equation?tex=A%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+B%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%3D%5CPsi%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5C%5C) 

是线性平稳列（因为是白噪声的组合且系数负指数趋于0）并且是**差分方程的平稳解**。

**唯一性**：如果有另外一个解 Yt 也满足差分方程，那么

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+A%28%5Cmathscr%7BB%7D%29+Y_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+B%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%3D%5Cpsi%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%5C%5C) 

所以上面推导得到的是差分方程的唯一平稳解。

### （三）ARMA 模型方程通解

模型的任意解具有以下形式

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3DX_%7Bt%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+%5Csum_%7Bl%3D0%7D%5E%7Br%28j%29-1%7D+V_%7BI%2C+j%7D+t%5E%7Bl%7D+%5Crho_%7Bj%7D%5E%7B-t%7D+%5Ccos+%5Cleft%28%5Clambda_%7Bj%7D+t-%5Ctheta_%7Bl%2C+j%7D%5Cright%29%2C+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

即 特解+齐次差分方程通解，这里的齐次差分方程就是 ![[公式]](https://www.zhihu.com/equation?tex=X_t%3DA%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D) ，这里最后能化成三角函数的形式，与第 04 讲中“自协方差函数的周期性”是一致的，自协方差函数也是齐次差分方程的解。

**说明**：齐次差分方程通解当 t 很大的时候，是趋于 0 的，不影响差分方程的平稳解。所以模拟的时候，只要去掉前面的 m 项就可以了，当 A(z) 的根靠近单位圆时，m 要取大一点。一般来说去掉前 100 项就基本没问题了。

### （四）ARMA 序列自协方差函数

根据线性序列的自协方差函数公式，有

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cpsi_%7Bj%2Bk%7D%2C+%5Cquad+k%3D0%2C1%2C2%2C+%5Cldots%5C%5C) 

其中 wold 系数 是负指数趋于 0 的，因此**自协方差函数也是负指数趋于 0**.（推导在第 01 讲：系数绝对可和，那么自协方差函数趋于 0）

### （五）wold 系数递推式

可以看出，自协方差函数中有 wold 系数，而根据定义 wold 系数是由级数展开得到的，为了便于编程，给出下面的递推式

![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi_%7Bj%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+1%2C+%26+j%3D0+%5C%5C+b_%7Bj%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bk%7D+%5Cpsi_%7Bj-k%7D%2C+%26+j%3D1%2C2%2C+%5Cldots+%5Cend%7Barray%7D%5Cright.%5C%5C) 

其中 bj 和 ak 为 ARMA 模型中的参数，并记

![[公式]](https://www.zhihu.com/equation?tex=b_%7Bj%7D%3D0%2C+j%3C0+%5Ctext+%7B+%E6%88%96+%7D+j%3Eq%2C+b_%7B0%7D%3D1+%3B+%5Cquad+%5Cpsi_%7Bj%7D%3D0%2C+j%3C0+%5C%5C) 

**推导**：利用定义，比较系数。

记 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D1-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+z%5E%7Bj%7D%3D%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+%5Cphi_%7Bj%7D+z%5E%7Bj%7D) ，则

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+A%28z%29%5CPsi+%28z%29+%3D+%5Csum%5Climits_%7Bk+%3D+0%7D%5Ep+%7B%7B%5Cphi+_k%7D%7D+%7Bz%5Ek%7D%5Csum%5Climits_%7Bj+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cpsi+_j%7D%7D+%7Bz%5Ej%7D+%3D+%5Csum%5Climits_%7Bk+%3D+0%7D%5Ep+%7B%5Csum%5Climits_%7Bj+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cphi+_k%7D%7B%5Cpsi+_j%7D%7Bz%5E%7Bk+%2B+j%7D%7D%7D+%7D+%5C%5C++%3D+%5Csum%5Climits_%7Bk+%3D+0%7D%5Ep+%7B%5Csum%5Climits_%7Bm+%3D+j%7D%5E%5Cinfty++%7B%7B%5Cphi+_k%7D%7B%5Cpsi+_%7Bm+-+k%7D%7D%7Bz%5Em%7D%7D+%7D++%3D+%5Csum%5Climits_%7Bk+%3D+0%7D%5Ep+%7B%5Csum%5Climits_%7Bm+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cphi+_k%7D%7B%5Cpsi+_%7Bm+-+k%7D%7D%7Bz%5Em%7D%7D+%7D+%5C%5C++%3D+%5Csum%5Climits_%7Bm+%3D+0%7D%5E%5Cinfty++%7B%5Csum%5Climits_%7Bk+%3D+0%7D%5Ep+%7B%7B%5Cphi+_k%7D%7B%5Cpsi+_%7Bm+-+k%7D%7D%7Bz%5Em%7D%7D+%7D++%3D+%5Csum%5Climits_%7Bm+%3D+0%7D%5E%5Cinfty++%7B%7Bb_m%7D%7Bz%5Em%7D%7D++%5Cend%7Barray%7D%5C%5C%5C%5D) 

其中第四个等号利用 wold 系数下标非负。因此

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bk%3D0%7D%5E%7Bp%7D+%5Cphi_%7Bk%7D+%5Cpsi_%7Bj-k%7D%3Db_%7Bj%7D%2C+%5Cquad+j+%5Cgeq+1%5C%5C) 

### （六）可识别性

**此处将证明**：ARMA 模型的自协方差函数与模型参数可以相互导出。

为了后续反证法需要，先介绍以下引理。

引理 如果 Xt 是 ARMA(p,q) 序列，且有实系数多项式 ![[公式]](https://www.zhihu.com/equation?tex=C%28%5Cmathscr%7BB%7D%29%2C+D%28%5Cmathscr%7BB%7D%29) 和白噪声 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Ceta_%7Bt%7D%5Cright%5C%7D) 使得

![[公式]](https://www.zhihu.com/equation?tex=C%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DD%28%5Cmathscr%7BB%7D%29+%5Ceta_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

那么多项式 C 的阶数不小于 p，D 的阶数不小于 q。

**直观上**看引理说明的是： 之前介绍的 ARMA 模型是最简单的。

### （1）ARMA 序列的 Y-W 方程

前面我们求得了平稳解：

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5C%5C) 

根据这个解的形式可知

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28%5Cvarepsilon_%7Bt%2Bk%7D+X_%7Bt%7D%5Cright%29%3D0%2C+%5Cquad+k%3E0%5C%5C) 

即当前时点与未来的白噪声不相关。

由差分方程

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%2B%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+b_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5C%5C) 

两边同乘 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt-k%7D) 并求期望得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%7D+X_%7Bt-k%7D%5Cright%29%3D%5Csum_%7Bj%3D1%7D%5E%7BP%7D+a_%7Bj%7D+%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt-j%7D+X_%7Bt-k%7D%5Cright%29%2B%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+b_%7Bj%7D+%5Cmathrm%7BE%7D%5Cleft%28%5Cvarepsilon_%7Bt-j%7D+X_%7Bt-k%7D%5Cright%29%5C%5C) 

即

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7Bk%7D+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bk-j%7D%2B%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+b_%7Bj%7D+%5Cmathrm%7BE%7D%5Cleft%28%5Cvarepsilon_%7Bt-j%7D+%5Csum_%7Bl%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bi%7D+%5Cvarepsilon_%7Bt-k-l%7D%5Cright%29+%5C%5C+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bk-j%7D%2B%5Csigma%5E2%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+b_%7Bj%7D+%5Cpsi_%7Bj-k%7D%2C+%5Cquad+k+%5Cin+%5Cmathbb%7BZ%7D+%5Cend%7Baligned%7D%5C%5C) 

先讨论 q<k 情形，此时 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi_%7Bj-k%7D%3D0%2C+j%3D0%2C1%2C+%5Cldots%2C+q) ，上式变为

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bk-j%7D%2C+%5Cquad+k+%5Cgeq+q%2B1%5C%5C) 

 这和 AR 序列很像，AR 序列是取 q = 0.

事实上对于 q<k, q=k, q>k分别有

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bk-j%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D%5Cmax+%280%2C+k%29%7D%5E%7Bq%7D+b_%7Bj%7D+%5Cpsi_%7Bj-k%7D%2C+%26+k%3Cq+%5C%5C+%5Csigma%5E%7B2%7D+b_%7Bq%7D%2C+%26+k%3Dq+%5C%5C+0+%26+k%3Eq+%5Cend%7Barray%7D%5Cright.%5C%5C) 

q=k 时，右边只保留  ![[公式]](https://www.zhihu.com/equation?tex=b_q) ，q>k时，右边保留 j≥k 的项。

对于 k > q，该方程可写为如下矩阵形式

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D+%5Cgamma_%7Bq%2B1%7D+%5C%5C+%5Cgamma_%7Bq%2B2%7D+%5C%5C+%5Cvdots+%5C%5C+%5Cgamma_%7Bq%2Bp%7D+%5Cend%7Barray%7D%5Cright%5D%3D%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+%5Cgamma_%7Bq%7D+%26+%5Cgamma_%7Bq-1%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bq-p%2B1%7D+%5C%5C+%5Cgamma_%7Bq%2B1%7D+%26+%5Cgamma_%7Bq%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bq-p%2B2%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+%5Cgamma_%7Bq%2Bp-1%7D+%26+%5Cgamma_%7Bq%2Bp-2%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bq%7D+%5Cend%7Barray%7D%5Cright%5D%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D+a_%7B1%7D+%5C%5C+a_%7B2%7D+%5C%5C+%5Cvdots+%5C%5C+a_%7Bp%7D+%5Cend%7Barray%7D%5Cright%5D%5C%5C) 

这里写 p 个方程是因为我们需要解 ![[公式]](https://www.zhihu.com/equation?tex=a_1%2C...%2Ca_p) .

**小tips**：如果要编程，这个系数矩阵可以表示为 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bp%2C+q%7D%3D%5Cleft%28%5Cgamma_%7B%7Cq%2Bi-j%7C%7D%5Cright%29_%7Bi%2C+j%3D1%2C2%2C+%5Cldots%2C+p%7D) 

只要系数矩阵可逆，那么就可以解出 ![[公式]](https://www.zhihu.com/equation?tex=a_1%2C...%2Ca_p) 。我们先假定可逆（后面会证明），那就可以得到 AR 部分的系数 ![[公式]](https://www.zhihu.com/equation?tex=a_1%2C...%2Ca_p) 。

现在解得了 AR 部分的系数，令

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3DA%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DB%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

那么 Y 是 MA(q) 序列（自协方差 q 步截尾），其自协方差函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7By%7D%28k%29+%26%3D%5Cmathrm%7BE%7D%5Cleft%28Y_%7Bt%7D+Y_%7Bt-k%7D%5Cright%29+%5C%5C+%26%3D%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+%5Csum_%7Bl%3D0%7D%5E%7Bp%7D+a_%7Bj%7D+a_%7Bl%7D+%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt-j%7D+X_%7Bt-l-k%7D%5Cright%29+%5C%5C+%26%3D%5Csum_%7Bj%3D0%7D%5E%7Bp%7D+%5Csum_%7Bl%3D0%7D%5E%7Bp%7D+a_%7Bj%7D+a_%7Bl%7D+%5Cgamma_%7Bk%2Bl-j%7D%2C+%5Cquad+0+%5Cleq+k+%5Cleq+q+%5Cend%7Baligned%7D%5C%5C) 

前面介绍过，可以由 MA 序列的自协方差函数导出系数以及白噪声方差。到此就完成了由 ARMA 模型自协方差函数导出参数的工作。

### （2）系数矩阵正定（会证！）

**定理** 当 m≥p 时， ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bm%2C+q%7D) （m行m列）可逆。（对于 m=p 当然也成立）

**反证**：设 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bm%2C+q%7D) 不满秩，则 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bm%2C+q%7D+%5Cboldsymbol%7B%5Cbeta%7D%3D0) ，其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Cbeta%7D%5Cne0) ，即矩阵的每一行乘该向量都为0，用记号写出来就是

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bl%3D0%7D%5E%7Bm-1%7D+%5Cbeta_%7BI%7D+%5Cgamma_%7Bq%2Bk-l%7D%3D0%2C+%5Cquad+k%3D0%2C1%2C+%5Cldots%2C+m-1%5C%5C) 

记（用向量写会方便）

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbb%7BW%7D_%7Bk%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bllll%7D+%5Cgamma_%7Bq%2Bk-1%7D+%26+%5Cgamma_%7Bq%2Bk-2%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bq%2Bk-m%7D+%5Cend%7Barray%7D%5Cright%29%2C+%5Cmathbf%7Bk%7D%3D1%2C2%2C+%5Ccdots%2C%5C%5C%5Cmathbb%7BP%7D%3D%5Cleft%28%5Cbeta_%7B0%7D+%5Cquad+%5Cbeta_%7B1%7D+%5Cquad+%5Ccdots+%5Cquad+%5Cbeta_%7Bm-1%7D%5Cright%29%5E%7BT%7D%5C%5C) 

那么就有

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbb%7BW%7D_%7Bk%7D+%5Cmathbb%7BP%7D%3D%5Cmathbf%7B0%7D%2C+%5Cmathbf%7Bk%7D%3D%5Cmathbf%7B1%7D%2C+%5Cmathbf%7B2%7D%2C+%5Ccdots%2C+%5Cmathbf%7Bm%7D%5C%5C) 

现在要证明**上式对所有非负整数 k 都成立**。

想象一下，如果系数矩阵下面添加了一行

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+%5Cleft%5B+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B%7B%5Cgamma+_q%7D%7D%26%7B%7B%5Cgamma+_%7Bq+-+1%7D%7D%7D%26+%5Ccdots+%26%7B%7B%5Cgamma+_%7Bq+-+m+%2B+1%7D%7D%7D%5C%5C+%7B%7B%5Cgamma+_%7Bq+%2B+1%7D%7D%7D%26%7B%7B%5Cgamma+_q%7D%7D%26+%5Ccdots+%26%7B%7B%5Cgamma+_%7Bq+-+m+%2B+2%7D%7D%7D%5C%5C++%5Cvdots+%26+%5Cvdots+%26%7B%7D%26+%5Cvdots+%5C%5C+%7B%7B%5Cgamma+_%7Bq+%2B+m+-+1%7D%7D%7D%26%7B%7B%5Cgamma+_%7Bq+%2B+m+-+2%7D%7D%7D%26+%5Ccdots+%26%7B%7B%5Cgamma+_q%7D%7D+%5Cend%7Barray%7D%7D+%5Cright%5D%5C%5C+%5C%3B%5C%3B%5C%3B%5Cleft%5B+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B%7B%5Cgamma+_%7Bq+%2B+m%7D%7D%7D%26%7B%7B%5Cgamma+_%7Bq+%2B+m+-+1%7D%7D%7D%26+%5Ccdots+%26%7B%7B%5Cgamma+_%7Bq+%2B+1%7D%7D%7D+%5Cend%7Barray%7D%7D+%5Cright%5D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

根据 Y-W 方程中 k>q 情形，添加的**这一行中每个分量都可以由原有矩阵中的列上的前 p 个元素线性表出**，并且表出的系数是一样的（都是 ![[公式]](https://www.zhihu.com/equation?tex=a_1%2C...%2Ca_p) ），所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbb%7BW%7D_%7Bm%2B1%7D) 可以由前 p 行表出，表出系数就是 ![[公式]](https://www.zhihu.com/equation?tex=a_1%2C...%2Ca_p) ，所以自然就有了

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbb%7BW%7D_%7Bm%2B1%7D%5Cmathbb%7BP%7D%3D0%5C%5C) 

递推可知对任意 k≥0 有 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbb%7BW%7D_%7Bk%7D+%5Cmathbb%7BP%7D%3D%5Cmathbf%7B0%7D) ，也就有

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bl%3D0%7D%5E%7Bm-1%7D+%5Cbeta_%7Bl%7D+%5Cgamma_%7Bq%2Bk-1%7D%3D0%2C+%5Cquad+%5Cboldsymbol%7Bk%7D+%5Cgeq+%5Cmathbf%7B0%7D%5C%5C) 

令 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Csum_%7Bl%3D0%7D%5E%7Bm-1%7D+%5Cbeta_%7Bl%7D+X_%7Bt-l%7D) ，那么它也是零均值平稳序列，利用上式有

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28Y_%7Bt%7D+X_%7Bt-q-k%7D%5Cright%29%3D%5Csum_%7Bl%3D0%7D%5E%7Bm-1%7D+%5Cbeta_%7Bl%7D+%5Cgamma_%7Bq%2Bk-l%7D%3D0%2C+%5Cquad+k+%5Cgeq+0%5C%5C) 

进而

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Crm%7BE%7D%7D%5Cleft%28+%7B%7BY_t%7D%7BY_%7Bt+-+q%7D%7D%7D+%5Cright%29%7B%5Crm%7B+%3D+E%7D%7D%5Cleft%28+%7B%7BY_t%7D%5Csum%5Climits_%7Bl+%3D+0%7D%5E%7Bm+-+1%7D+%7B%7B%5Cbeta+_l%7D%7BX_%7Bt+-+q+-+l%7D%7D%7D+%7D+%5Cright%29+%3D+0%5C%5C%5C%5D) 

可知 Yt 的自协方差函数是 q-1 步截尾的，所以它为 MA(q-1) 序列。因此存在白噪声 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Ceta_%7Bt%7D%5Cright%5C%7D+%5Csim+%5Cmathrm%7BWN%7D%5Cleft%280%2C+s%5E%7B2%7D%5Cright%29) 使得

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bl%3D0%7D%5E%7Bm-1%7D+%5Cbeta_%7Bl%7D+X_%7Bt-l%7D%3D%5Csum_%7Bj%3D0%7D%5E%7Bq-1%7D+d_%7Bl%7D+%5Ceta_%7Bt-j%7D%5C%5C) 

注意到右边推移算子对应的多项式只有 q-1 阶，与引理矛盾。

### （七）ARMA 模型的一个充分条件

假设零均值平稳序列 Xt 有自协方差函数， ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D1-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+z%5E%7Bj%7D) 满足最小相位条件，并且有

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bk-j%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+c+%5Cneq+0%2C+%26+k%3Dq+%5C%5C+0%2C+%26+k%3Eq+%5Cend%7Barray%7D%5Cright.%5C%5C) 

则 Xt 为 ARMA(p',q') 模型，其中 p'≤p, q'≤q。

**证明**：

先引入 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7BY_t%7D+%3D+%7BX_t%7D+-+%5Csum%5Climits_%7Bj+%3D+1%7D%5Ep+%7B%7Ba_j%7D%7D+%7BX_%7Bt+-+j%7D%7D%5C%5D) ，它是零均值平稳序列。配凑条件如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28Y_%7Bt%7D+X_%7Bt-k%7D%5Cright%29%3D%5Cgamma_%7Bk%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bk-j%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+c+%5Cneq+0%2C+%26+k%3Dq+%5C%5C+0%2C+%26+k%3Eq+%5Cend%7Barray%7D%5Cright.%5C%5C) 

再计算 Yt 的自协方差函数如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cgamma_%7By%7D%28k%29+%26%3D%5Cmathrm%7BE%7D%5Cleft%28Y_%7Bt%7D+Y_%7Bt-k%7D%5Cright%29%3D%5Cmathrm%7BE%7D%5Cleft%5BY_%7Bt%7D%5Cleft%28X_%7Bt-k%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-k-j%7D%5Cright%29%5Cright%5D+%5C%5C+%26%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+c+%5Cneq+0%2C+%26+k%3Dq+%5C%5C+0%2C+%26+k%3Eq+%5Cend%7Barray%7D%5Cright.+%5Cend%7Baligned%7D%5C%5C) 

自协方差 q 后截尾，Yt 是 MA(q) 序列。所以存在多项式 B 满足最小相位条件，且

![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DY_%7Bt%7D%3DB%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%2C%5C%5C) 

如果 A,B 没有公共根，则上述模型为 ARMA(p,q)，否则设公因子为 C(z)（C当然也满足最小相位条件），则

![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3DC%28z%29+A%5E%7B%5Cprime%7D%28z%29%2C+B%28z%29%3DC%28z%29+B%5E%7B%5Cprime%7D%28z%29%5C%5C) 

模型可写为

![[公式]](https://www.zhihu.com/equation?tex=C%28%5Cmathscr%7BB%7D%29+A%5E%7B%5Cprime%7D%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DC%28%5Cmathscr%7BB%7D%29+B%5E%7B%5Cprime%7D%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%5C%5C) 

两边同乘 ![[公式]](https://www.zhihu.com/equation?tex=C%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29) 可知 Xt  为 ARMA(p',q') 序列，其中，p'<p, q'<q

### （八）有理谱密度

ARMA 序列自协方差函数绝对可和，其谱密度函数计算如下

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+f%28%5Clambda+%29+%3D+%5Cfrac%7B1%7D%7B%7B2%5Cpi+%7D%7D%5Csum%5Climits_%7Bk+%3D++-+%5Cinfty+%7D%5E%5Cinfty++%7B%7B%5Cgamma+_k%7D%7D+%7Be%5E%7B+-+ik%5Clambda+%7D%7D%5C%5C++%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D%5Csum%5Climits_%7Bk+%3D++-+%5Cinfty+%7D%5E%5Cinfty++%7B%5Csum%5Climits_%7Bm+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cpsi+_m%7D%7Be%5E%7Bim%5Clambda+%7D%7D%7B%5Cpsi+_%7Bm+%2B+k%7D%7D%7D+%7D+%7Be%5E%7B+-+i%5Cleft%28+%7Bm+%2B+k%7D+%5Cright%29%5Clambda+%7D%7D%5C%5C++%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D%5Csum%5Climits_%7Bm+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cpsi+_m%7D%7Be%5E%7Bim%5Clambda+%7D%7D%7D+%5Csum%5Climits_%7Bk+%3D++-+%5Cinfty+%7D%5E%5Cinfty++%7B%7B%5Cpsi+_%7Bm+%2B+k%7D%7D%7Be%5E%7B+-+i%5Cleft%28+%7Bm+%2B+k%7D+%5Cright%29%5Clambda+%7D%7D%7D+%5C%5C++%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D%5Csum%5Climits_%7Bm+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cpsi+_m%7D%7Be%5E%7Bim%5Clambda+%7D%7D%7D+%5Csum%5Climits_%7Bn+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cpsi+_n%7D%7Be%5E%7B+-+in%5Clambda+%7D%7D%7D+%5C%5C++%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D%7B%5Cleft%7C+%7B%5Csum%5Climits_%7Bj+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cpsi+_j%7D%7D+%7Be%5E%7Bij%5Clambda+%7D%7D%7D+%5Cright%7C%5E2%7D+%3D+%5Cfrac%7B%7B%7B%5Csigma+%5E2%7D%7D%7D%7B%7B2%5Cpi+%7D%7D%7B%5Cleft%7C+%7B%5Cfrac%7B%7BB%5Cleft%28+%7B%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%29%7D%7D%7B%7BA%5Cleft%28+%7B%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%29%7D%7D%7D+%5Cright%7C%5E2%7D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

最后一个等号利用 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cpsi+%5Cleft%28+z+%5Cright%29+%3D+%5Cfrac%7B%7BB%5Cleft%28+z+%5Cright%29%7D%7D%7B%7BA%5Cleft%28+z+%5Cright%29%7D%7D%5C%5D) ，进而

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%7C+%7B%5Cpsi+%5Cleft%28+%7B%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%29%7D+%5Cright%7C+%3D+%5Cleft%7C+%7B%5Cfrac%7B%7BB%5Cleft%28+%7B%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%29%7D%7D%7B%7BA%5Cleft%28+%7B%7Be%5E%7Bi%5Clambda+%7D%7D%7D+%5Cright%29%7D%7D%7D+%5Cright%7C%5C%5C%5C%5D) 

形如这样的谱密度，称为**有理谱密度**。

### （九）可逆的 ARMA 模型

如果进一步要求 **B(z) 在单位圆上无根**，则原 ARMA 模型变为可逆的 ARMA 模型。

对于可逆的 ARMA 模型，可以对 ![[公式]](https://www.zhihu.com/equation?tex=B%5E%7B-1%7D%28z%29+A%28z%29) 泰勒展开得到

![[公式]](https://www.zhihu.com/equation?tex=B%5E%7B-1%7D%28z%29+A%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cvarphi_%7Bj%7D+z%5E%7Bj%7D%2C+%5Cquad%7Cz%7C+%5Cleq+%5Crho%5C%5C) 

继而

![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D%3DB%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cvarphi_%7Bj%7D+X_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

表明可逆 ARMA 序列和它的白噪声序列可以相互线性表出。

## 例一

给定 ARMA(4,2) 模型，参数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+a_%7B1%7D%3D-0.9%2C+%26+a_%7B2%7D%3D-1.4%2C+%5C%5C+a_%7B3%7D%3D-0.7%2C+%26+a_%7B4%7D%3D-0.6+%5C%5C+b_%7B1%7D%3D0.5%2C+%26+b_%7B2%7D%3D-0.4+.+%5Cend%7Baligned%7D%5C%5C) 

则 A(z) 的根为 ![[公式]](https://www.zhihu.com/equation?tex=1.1380+e%5E%7B%5Cpm+2.2062+i%7D%2C+1.1344+e%5E%7B%5Cpm+1.4896+i%7D) ，B(z) 的根为 ![[公式]](https://www.zhihu.com/equation?tex=2.3252%2C-1.0752) 

谱密度函数图像如下

![img](https://pic1.zhimg.com/80/v2-6cfb19356526bbb90b12d784bc01c7e0_720w.jpg)

自协方差函数如下

![img](https://pic2.zhimg.com/80/v2-ecff18d4bd3e315abab00b0f66932e6d_720w.jpg)

## 例二

已知 ARMA(2,2) 的自协方差函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cgamma_%7B0%7D%2C+%5Cgamma_%7B1%7D%2C+%5Ccdots%2C+%5Cgamma_%7B4%7D%5Cright%29%3D%284.61%2C-1.06%2C0.29%2C0.69%2C-0.12%29%5C%5C) 

反解其参数。

### （1）根据延伸 Y-W 方程解 a1,a2

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+%5Cgamma_%7B3%7D+%5C%5C+%5Cgamma_%7B4%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bll%7D+%5Cgamma_%7B2%7D+%26+%5Cgamma_%7B1%7D+%5C%5C+%5Cgamma_%7B3%7D+%26+%5Cgamma_%7B2%7D+%5Cend%7Barray%7D%5Cright%29%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+a_%7B1%7D+%5C%5C+a_%7B2%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28a_%7B1%7D%2C+a_%7B2%7D%5Cright%29%3D%280.0894%2C-0.6265%29%5C%5C) 

### （2）引进 Y 序列，并计算其自协方差

设 ![[公式]](https://www.zhihu.com/equation?tex=a%5E%7BT%7D%3D%5Cleft%28-1%2C+a_%7B1%7D%2C+%5Ccdots%2C+a_%7Bp%7D%5Cright%29) ，那么

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7By%7D%28k%29%3Da%5E%7BT%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bccc%7D+%5Cgamma_%7Bk%7D+%26+%5Cgamma_%7Bk%2B1%7D+%26+%5Cgamma_%7Bk%2B2%7D+%5C%5C+%5Cgamma_%7Bk-1%7D+%26+%5Cgamma_%7Bk%7D+%26+%5Cgamma_%7Bk%2B1%7D+%5C%5C+%5Cgamma_%7Bk-2%7D+%26+%5Cgamma_%7Bk-1%7D+%26+%5Cgamma_%7Bk%7D+%5Cend%7Barray%7D%5Cright%29+a%2C%7Ck%7C+%5Cleq+2%5C%5C) 

得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cgamma_%7By%7D%280%29%2C+%5Cgamma_%7By%7D%281%29%2C+%5Cgamma_%7By%7D%282%29%5Cright%29%3D%287.1278-2.4287+%5Cquad+3.2729%29%5C%5C) 

### （3）根据自协方差，利用公式求 b1,b2

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+b_%7B1%7D+%5C%5C+b_%7B2%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cleft%28%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+%5Cgamma_%7B1%7D+%5C%5C+%5Cgamma_%7B2%7D+%5Cend%7Barray%7D%5Cright%29-A+%5CPi+C%5Cright%29+%5Cquad+%5Csigma%5E%7B2%7D%3D%5Cgamma_%7B0%7D-C%5E%7BT%7D+%5CPi+C%5C%5C) 

其中

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7D+%5CPi%3D%5Clim+_%7Bk+%5Crightarrow+%5Cinfty%7D+%5COmega_%7Bk%7D+%5CGamma_%7Bk%7D%5E%7B-1%7D+%5COmega_%7Bk%7D%5E%7BT%7D%2C+A%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bcc%7D+0+%26+1+%5C%5C+0+%26+0+%5Cend%7Barray%7D%5Cright%29+%5C%5C+C%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+1+%5C%5C+0+%5Cend%7Barray%7D%5Cright%29%2C+%5Cquad+%5COmega_%7Bk%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bccc%7D+%5Cgamma_%7B1%7D+%5Ccdots+%26+%5Cgamma_%7Bk%7D+%5C%5C+%5Cgamma_%7B2%7D+%5Ccdots+%26+%5Cgamma_%7Bk%2B1%7D+%5Cend%7Barray%7D%5Cright%29_%7B2+%5Ctimes+k%7D+%5Cend%7Barray%7D%5C%5C) 

计算得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E%7B2%7D%3D4.0119) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28b_%7B1%7D%2C+b_%7B2%7D%5Cright%29%3D%28-0.3334%2C0.8158%29) ，过程如下图

![img](https://pic1.zhimg.com/80/v2-71ba4f7d6c4e4880f5e5cf2e744a20f4_720w.jpg)

### （4）得到所要的模型

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+X_%7Bt%7D+%26%3D0.0894%5E%7B%2A%7D+X_%7Bt-1%7D-0.6265+%2A+X_%7Bt-2%7D+%5C%5C+%26%2B%5Cvarepsilon_%7Bt%7D-0.3334%5E%7B%2A%7D+%5Cvarepsilon_%7Bt-1%7D%2B0.8158%5E%7B%2A%7D+%5Cvarepsilon_%7Bt-2%7D+%5Cend%7Baligned%7D%2C+%5Cquad+t+%5Cin+Z%5C%5C) 

其中白噪声为 ![[公式]](https://www.zhihu.com/equation?tex=W+N%280%2C4.0119%29) 

## 推广的 ARMA 模型

如果定义中的**最小相位条件去掉**，就成了广义的 ARMA 模型。

如果此时 A(z) 在单位圆上有根，则不存在平稳解。

如果此时 A(z) 在单位圆上没有根，则有唯一平稳解。

这一部分下一讲再具体说明。



## 3.3 广义 ARMA 模型和 ARIMA 模型介绍

### 一、广义 ARMA 模型

### （1）定义

我们把 ARMA 模型中关于多项式 A(z),B(z) 的最小相位条件去掉（即允许有单位圆内的根），其余定义相同，得到的就是广义 ARMA 模型。

### （2）平稳解情况

如果 A(z) 在**单位圆上有根**，那么广义 ARMA 模型没有平稳解。

如果 A(z) 在**单位圆上没有根**，则有 ![[公式]](https://www.zhihu.com/equation?tex=0%3C%5Crho_%7B1%7D%3C1%3C%5Crho_%7B2%7D) ，使得 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5BB%28z%29%2FA%28z%29%5C%5D) 在圆环

![[公式]](https://www.zhihu.com/equation?tex=%5C%5BD+%3D+%5Cleft%5C%7B+%7Bz%3A%7B%5Crho+_1%7D+%5Cle+z+%5Cle+%7B%5Crho+_2%7D%7D+%5Cright%5C%7D%5C%5C%5C%5D) 

内解析，可以进行 Laurent 级数展开（在单位圆内按正常展开，单位圆外则用倒数来替代）得到

![[公式]](https://www.zhihu.com/equation?tex=A%5E%7B-1%7D%28z%29+B%28z%29%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D+c_%7Bj%7D+z%5E%7Bj%7D%2C+z+%5Cin+D%5C%5C) 

其中两头系数通项都负指数趋于 0，所以整体系数也负指数趋于 0，进而由唯一平稳解

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3DA%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+%5Cmathrm%7BB%7D%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%3D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D+c_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+t+%5Cin+Z%5C%5C) 

但这个平稳解中，现在的观察值会与将来的白噪声有关，并**没有实际意义**。此外，根据齐次差分方程理论，对于

![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+X_t%3D0%5C%5C) 

其特征多项式有单位圆内的根，因此通解是趋于无穷的，所以这时广义 ARMA 的其他解（通解）会趋于无穷，称为**爆炸模型**。

### 二、求和 ARIMA(p,d,q) 模型

### （1）定义

设 d 是一个正整数，如果 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%5C%7B+%7B%7BX_t%7D%7D+%5Cright%5C%7D%5C%5D) 的 d 阶差分

![[公式]](https://www.zhihu.com/equation?tex=%7BY%7D_%7Bt%7D%3D%5Cnabla%5E%7Bd%7D+X_%7Bt%7D%3D%281-%5Cmathscr%7BB%7D%29%5E%7Bd%7D+X_%7Bt%7D%3D%5Csum_%7Bk%3D0%7D%5E%7Bd%7D+C_%7Bd%7D%5E%7Bk%7D%28-1%29%5E%7Bk%7D+X_%7Bt-k%7D%2C+t+%5Cin+Z%5C%5C) 

是一个 ARMA(p,q) 序列（最后一个等号利用二项式定理展开），则称 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%5C%7B+%7B%7BX_t%7D%7D+%5Cright%5C%7D%5C%5D) 是一个求和 ARIMA(p,d,q) 序列。它满足如下差分方程

![[公式]](https://www.zhihu.com/equation?tex=%5C%5BA%28%7B%5Ccal+B%7D%29%7B%281+-+%7B%5Ccal+B%7D%29%5Ed%7D%7BX_t%7D+%3D+B%28%7B%5Ccal+B%7D%29%7B%5Cvarepsilon+_t%7D%2Ct+%5Cin+Z%5C%5C%5C%5D) 

其中 A(z),B(z) 都按照 ARMA 模型的定义。

**注**：通常取 d=1,2，且该模型不存在平稳解

### （2）非平稳解的讨论

**情形 d=1**：即 ARIMA(p,1,q) 模型，这时 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7BY_t%7D+%3D+%7BX_t%7D+-+%7BX_%7Bt+-+1%7D%7D%5C%5D) 是 ARMA(p,q) 序列，给定初值可以得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+X_%7Bt%7D%3DX_%7Bt-1%7D%2BY_%7Bt%7D%3DX_%7Bt-2%7D%2BY_%7Bt-1%7D%2BY_%7Bt%7D+%5C%5C+%3D%5Ccdots+%5Ccdots+%5C%5C+%3DX_%7B0%7D%2B%5Csum_%7Bj%3D0%7D%5E%7Bt%7D+Y_%7Bj%7D%2C+t+%5Cgeq+1+%5Cend%7Barray%7D%5C%5C) 

可以通过产生 ARMA(p,q) ，进而利用该递推式来得到 ARIMA(p,1,q) 序列。该模型也称为**单位根模型**，当样本数据不太大时，与平稳序列差异不大，不容易区分。

将单位根模型与如下趋势模型进行对比：

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3Dc_%7B0%7D%2Bc_%7B1%7D+t%2BY_%7Bt%7D%5C%5C) 

其中 Y 是 ARMA(p,q) 序列。

单位根模型与趋势模型得到的都是非平稳序列，单位根模型通过一次差分后，序列变为平稳；趋势模型通过减去趋势项，序列也变为平稳。但单位根模型减去趋势项，仍非平稳。

**情形 d=2**：即 ARIMA(p,2,q) 模型，这时

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%281-%5Cmathscr%7BB%7D%29%5E%7B2%7D+X_%7Bt%7D%3DX_%7Bt%7D-2+X_%7Bt-1%7D%2BX_%7Bt-2%7D%5C%5C) 

是一个 ARMA(p,q) 序列。由此可以得到递推关系如下

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D-X_%7Bt-1%7D%3DX_%7Bt-1%7D-X_%7Bt-2%7D%2BY_%7Bt%7D%2C+t+%5Cgeq+1%5C%5C) 

两边对 t 求和（从 1 到 n1）得到

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn_%7B1%7D%7D-X_%7B0%7D%3DX_%7Bn_%7B1%7D-1%7D-X_%7B-1%7D%2B%5Csum_%7Bt%3D1%7D%5E%7Bn_%7B1%7D%7D+Y_%7Bt%7D%5C%5C) 

到这里就得到了**类似 ARIMA(p,1,q) 模型**，移项得到

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn_%7B1%7D%7D-X_%7Bn_%7B1%7D-1%7D%3DX_%7B0%7D-X_%7B-1%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bn_%7B1%7D%7D+Y_%7Bj%7D%5C%5C) 

再对 n1 求和（从 1 到 t ）得到

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3DX_%7B0%7D%2Bt%5Cleft%28X_%7B0%7D-X_%7B-1%7D%5Cright%29%2B%5Csum_%7Bn_%7B1%7D%3D1%7D%5E%7Bt%7D+%5Csum_%7Bj%3D1%7D%5E%7Bn_%7B1%7D%7D+Y_%7Bj%7D%2C%2C+t+%5Cgeq+1%5C%5C) 

从这可以看出有一部分**线性趋势**，但如果减掉，剩下的还是一个类似 ARIMA(p,1,q) 序列，仍然是非平稳的。其通解可以写为如下形式

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3Dc_%7B0%7D%2Bc_%7B1%7D+t%2B%5Csum_%7Bn_%7B1%7D%3D1%7D%5E%7Bt%7D+%5Csum_%7Bj%3D1%7D%5E%7Bn_%7B1%7D%7D+Y_%7Bj%7D%2C%2C+t+%5Cgeq+1%5C%5C) 

类似地可以推广到 ARIMA(p,d,q) 情形，其通解为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3Dc_%7B0%7D%2Bc_%7B1%7D+t%2B%5Ccdots%2Bc_%7Bd-1%7D+t%5E%7Bd-1%7D%2B%5Csum_%7Bn_%7Bd-1%7D%7D%5E%7Bt%7D+%5Ccdots+%5Csum_%7Bn_%7B1%7D%3D1%7D%5E%7Bn_%7B2%7D%7D+%5Csum_%7Bj%3D1%7D%5E%7Bn_%7B1%7D%7D+Y_%7Bj%7D%2C+t+%5Cgeq+1%5C%5C) 

形式上看，它的通解为 ARMA 序列的 **d 重求和**，加上一个**多项式的趋势**。

### （3）几种特殊情形

**a. ARI(1,1) 模型**（即 ARIMA(1,1,0)），差分后得到 AR(1) 序列

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7BX_t%7D+-+%7BX_%7Bt+-+1%7D%7D+%3D+a%5Cleft%28+%7B%7BX_%7Bt+-+1%7D%7D+-+%7BX_%7Bt+-+2%7D%7D%7D+%5Cright%29+%2B+%7B%5Cvarepsilon+_t%7D%5C%5C%5C%5D) 

或

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%281%2Ba%29+X_%7Bt-1%7D-a+X_%7Bt-2%7D%2B%5Cvarepsilon_%7Bt%7D%5C%5C) 

其中 a 的模小于 1，看上去是 AR(2) 但并不是，因为根在单位圆内了！

将其非平稳解表示成 wold 系数的形式

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bk%3D0%7D%5E%7B%2B%5Cinfty%7D+%5Cpsi_%7Bk%7D+%5Cepsilon_%7Bt-k%7D%2C+%5Cpsi%28%5Cmathrm%7Bz%7D%29%3D%5Csum_%7Bk%3D0%7D%5E%7B%2B%5Cinfty%7D+%5Cpsi_%7Bk%7D+z%5E%7Bk%7D%5C%5C) 

将 wold 系数形式代回原模型，可以得到 wold 系数的递推关系（此处不要求，步骤略写，但思想需要掌握）

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Cpsi+_k%7D+%3D+%281+%2B+a%29%7B%5Cpsi+_%7Bk+-+1%7D%7D+-+a%7B%5Cpsi+_%7Bk+-+2%7D%7D%2Ck+%5Cge+2%5C%5C%5C%5D) 

结合初值得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi_%7Bk%7D%3D%5Cfrac%7B1-a%5E%7Bk%2B1%7D%7D%7B1-a%7D%2C+k+%5Cgeq+0%5C%5C) 

可以看出 wold 系数并不收敛于 0，所以 X_t 是非平稳的。

**b. IMA(1,1) 模型**（即 ARIMA(0,1,1)）--商业和经济中常用

模型为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3DX_%7Bt-1%7D%2B%5Cvarepsilon_%7Bt%7D-b+%5Cvarepsilon_%7Bt-1%7D%5C%5C) 

设序列首次观测的时间为 -m ，则在此之前（ t<-m ）没有观测值，都记为 0.

那么由模型不断递推得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+X_%7Bt%7D+%26%3DX_%7Bt-2%7D%2B%5Cvarepsilon_%7Bt%7D%2B%281-b%29+%5Cvarepsilon_%7Bt-1%7D-b+%5Cvarepsilon_%7Bt-2%7D+%5C%5C+%26%3D%5Ccdots+%5Ccdots+%5C%5C+%26%3D%5Cvarepsilon_%7Bt%7D%2B%281-b%29+%5Cvarepsilon_%7Bt-1%7D%2B%5Ccdots%2B%281-b%29+%5Cvarepsilon_%7B-m%7D-b+%5Cvarepsilon_%7B-m-1%7D+%5Cend%7Baligned%7D%5C%5C) 

这时一个 MA(t+m+1) 模型。

其方差为系数的平方和

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BVar%7D%5Cleft%28X_%7Bt%7D%5Cright%29%3D%5Cleft%5B1%2Bb%5E%7B2%7D%2B%281-b%29%5E%7B2%7D%28t%2Bm%29%5Cright%5D+%5Csigma%5E%7B2%7D%5C%5C) 

对于较大的 m 和中等大小的 k，相关系数近似为

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BCorr%7D%5Cleft%28X_%7Bt%7D%2C+X_%7Bt%2Bk%7D%5Cright%29+%5Capprox+%5Csqrt%7B%5Cfrac%7Bt%2B%5Cmathrm%7B~m%7D%7D%7Bt%2Bm%2Bk%7D%7D+%5Cdot%7B%5Capprox%7D+1%5C%5C) 

其中协方差与 X_t 的方差只在 ε_t 的系数部分有差别。

可见，当 t 增大时，方差会无限增大。并且对于多个滞后期数 k， ![[公式]](https://www.zhihu.com/equation?tex=X_t) 和 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%2Bk%7D) 高度正相关。这种周期性符合现实经济和商业的特性。

### 三、季节 ARMA 模型

### （1）季节 MA 模型

例如我们拿到了 2000-2020 年每个月份的数据，那么我们将数据按月份分为 12 组，对每组的数据用 MA 模型来建模，就得到季节 MA 模型。如果数据是按季度分的，也是同理。

此时模型为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2B%5CTheta+%5Cvarepsilon_%7Bt-12%7D%2C%7C%5CTheta%7C+%5Cleq+%5Cmathbf%7B1%7D%5C%5C) 

计算自协方差函数如下

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BCov%7D%5Cleft%28X_%7Bt%7D%2C+X_%7Bt%2Bk%7D%5Cright%29%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bl%7D+1%2B%5CTheta%5E%7B2%7D%5Csigma%5E2%2C+k%3D0+%5C%5C+%5CTheta+%5Csigma%5E%7B2%7D%2C+k%3D%5Cpm+12+%5C%5C+0%2C+k+%5Cneq+0%2C%5Cpm+12+%5Cend%7Barray%7D%5Cright.%5C%5C) 

序列是平稳的，并且仅在滞后 12 处才有非零的自相关性。这样得到的每一个月份都是同一个 MA 模型。

现在我们考察周期为 s 的 MA(Q) 模型：

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2B%5CTheta_%7B1%7D+%5Cvarepsilon_%7Bt-s%7D%2B%5CTheta_%7B2%7D+%5Cvarepsilon_%7Bt-2+s%7D%2B%5Ccdots%2B%5CTheta_%7BQ%7D+%5Cvarepsilon_%7Bt-Q+s%7D%5C%5C) 

从形式上看，季节 MA(Q) 模型也就是 MA(Qs) ，只不过其中很多系数都是 0。

同样地，它也是平稳序列，并且自相关系数只在 s, 2s, 3s, ... , Qs 处非零，具体表达式如下

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk+s%7D%3D%5Cfrac%7B%5CTheta_%7Bk%7D%2B%5Ctheta_%7B1%7D+%5CTheta_%7Bk%2B1%7D%2B%5Ctheta_%7B2%7D+%5Ctheta_%7Bk%2B2%7D%2B%5Ccdots%2B%5Ctheta_%7BQ-k%7D+%5CTheta_%7BQ%7D%7D%7B1%2B%5Ctheta_%7B1%7D%5E%7B2%7D%2B%5Ctheta_%7B2%7D%5E%7B2%7D%2B%5Ccdots%2B%5Ctheta_%7BQ%7D%5E%7B2%7D%7D%2C+k%3D1%2C2%2C+%5Ccdots%2C+Q%5C%5C) 

分母是系数的平方和，分子是系数错一位的乘积和。

### （2）季节 AR 模型

类似地，季节 AR(1) 模型为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5CPhi+X_%7Bt-12%7D%2B%5Cvarepsilon_%7Bt%7D%2C%7C%5CPhi%7C%3C1%5C%5C) 

因为根在单位圆外，所以将来的白噪声和过去的观察值是不相关的。两边同乘 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt-k%7D) ，然后取数学期望得到

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk%7D%3D%5CPhi+%5Crho_%7Bk-12%7D%2C+k+%5Cgeq+1%5C%5C) 

递推可得

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Crho_%7B12+k%7D%3D%5CPhi%5E%7Bk%7D%2C+k%3D0%2C1%2C+%5Ccdots+%5C%5C+%5Crho_%7B12+k%2Bl%7D%3D0%2C+k%3D0%2C1%2C+%5Ccdots%2C+1+%5Cleq+l+%5Cleq+11+%5Cend%7Barray%7D%5C%5C) 

其中第二行利用 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk%7D%3D%5Crho_%7B-k%7D%2C+%5Crho_%7B1%7D%3D%5CPhi+%5Crho_%7B11%7D%2C+%5Crho_%7B11%7D%3D%5CPhi+%5Crho_%7B1%7D) 

利用 AR 模型的方法可以得到季节 AR(1) 模型的平稳解为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bk%3D0%7D%5E%7B%2B%5Cinfty%7D+%5CPhi%5E%7Bk%7D+%5Cvarepsilon_%7Bt-12+k%7D%5C%5C) 

同样可以推广到季节 AR(p) 模型

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5CPhi_%7B1%7D+X_%7Bt-s%7D%2B%5CPhi_%7B2%7D+X_%7Bt-2+s%7D%2B%5Ccdots%2B%5CPhi_%7BP%7D+X_%7Bt-P+s%7D%2B%5Cvarepsilon_%7Bt%7D%5C%5C) 

特征多项式满足

![[公式]](https://www.zhihu.com/equation?tex=%5C%5BA%28z%29+%3D+1+-+%7B%5CPhi+_1%7D%7Bz%5Es%7D+-+%7B%5CPhi+_2%7D%7Bz%5E%7B2s%7D%7D+-++%5Ccdots++-+%7B%5CPhi+_p%7D%7Bz%5E%7BPs%7D%7D+%5Cne+0%2C%7Cz%7C+%5Cle+1%5C%5C%5C%5D) 

### （3）季节 ARMA 模型

定义周期为 s 的季节 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Crm%7BARMA%7D%7D%28p%2Cq%29+%5Ctimes+%7B%28P%2CQ%29_s%7D%5C%5D) 模型为

![[公式]](https://www.zhihu.com/equation?tex=A_%7B0%7D%28%5Cmathscr%7BB%7D%29+%5Cmathrm%7BA%7D%5Cleft%28%5Cmathcal%7BB%7D%5E%7Bs%7D%5Cright%29+X_%7Bt%7D%3DB_%7B0%7D%28%5Cmathcal%7BB%7D%29+B%5Cleft%28%5Cmathcal%7BB%7D%5E%7Bs%7D%5Cright%29+%5Cvarepsilon_%7Bt%7D%5C%5C) 

这里的 p,q 为 ![[公式]](https://www.zhihu.com/equation?tex=A_0%28z%29%2CB_0%28z%29) 的阶数，P,Q 为 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%2CB%28z%29) 的阶数。一般 p,q 不超过 3。

**问**：这里为什么要多出 ![[公式]](https://www.zhihu.com/equation?tex=A_0%28z%29%2CB_0%28z%29) 呢？

**答**：如果没有 ![[公式]](https://www.zhihu.com/equation?tex=A_0%28z%29%2CB_0%28z%29) ，那么某一季节的数据只与该季节中不同年份的数据有关，而与其它季节的数据无关，与实际不符。

如果按之前（1）（2）来建立模型

![[公式]](https://www.zhihu.com/equation?tex=+%5Cmathrm%7BA%7D%5Cleft%28%5Cmathcal%7BB%7D%5E%7Bs%7D%5Cright%29+X_%7Bt%7D%3DB%5Cleft%28%5Cmathcal%7BB%7D%5E%7Bs%7D%5Cright%29+%5Cvarepsilon_%7Bt%7D%5C%5C) 

这时白噪声不应该是白噪声，而应该是一个 ARMA(p,q) 序列，这就得到了上面的定义。

**例**：考虑季节 ARMA 模型 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%281-%5Cmathbf%7Bb%7D+%5Cmathcal%7BB%7D%29%5Cleft%281-%5CTheta+B%5E%7B12%7D%5Cright%29+%5Cvarepsilon_%7Bt%7D) 

将后移算子展开得到

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7BX_t%7D+%3D+%7B%5Cvarepsilon+_t%7D+-+b%7B%5Cvarepsilon+_%7Bt+-+1%7D%7D+-+%5CTheta+%7B%5Cvarepsilon+_%7Bt+-+12%7D%7D+%2B+b%5CTheta+%7B%5Cvarepsilon+_%7Bt+-+13%7D%7D%5C%5C%5C%5D) 

计算自协方差和自相关系数如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7D+%5Cgamma_%7B0%7D%3D%5Cleft%281%2Bb%5E%7B2%7D%5Cright%29%5Cleft%281%2B%5CTheta%5E%7B2%7D%5Cright%29+%5Csigma%5E%7B2%7D+%5C%5C+%5Crho_%7B1%7D%3D-%5Cfrac%7Bb%7D%7B%5Cleft%281%2Bb%5E%7B2%7D%5Cright%29%7D+%5C%5C+%5Crho_%7B11%7D%3D%5Crho_%7B13%7D%3D%5Cfrac%7Bb+%5Ctheta%7D%7B%5Cleft%281%2Bb%5E%7B2%7D%5Cright%29%5Cleft%281%2B%5Ctheta%5E%7B2%7D%5Cright%29%7D+%5C%5C+%5Crho_%7B12%7D%3D-%5Cfrac%7B%5Ctheta%7D%7B%5Cleft%281%2B%5Ctheta%5E%7B2%7D%5Cright%29%7D+%5Cend%7Barray%7D%5C%5C) 

**一个小发现**： ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_0) 的形式与模型很像，把所有的 B 换成平方，减号换加号。虽然我没有证明，但直觉上这是成立的，或者二者之间至少有某种关系。先挖个坑，之后填 。

其自协方差函数不会很快趋于0，而是具有一定的周期性。

**例**：考察模型 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5CPhi+X_%7Bt-12%7D%2B%5Cvarepsilon_%7Bt%7D-b+%5Cvarepsilon_%7Bt-1%7D) 

两边同乘   ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt-k%7D) 并取数学期望得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Cgamma_%7B1%7D%3D%5CPhi+%5Cgamma_%7B11%7D-b+%5Csigma%5E%7B2%7D+%5C%5C+%5Cgamma_%7Bk%7D%3D%5CPhi+%5Cgamma_%7Bk-12%7D%2C+k+%5Cgeq+2+%5Cend%7Barray%7D%5C%5C) 

经常用到：将来的白噪声和现在的观测值不相关。

由第二行同除 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_0) 可得

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7B12+k%7D%3D%5CPhi%5E%7Bk%7D%2C+k+%5Cgeq+1%5C%5C) 

由第二行取 k = 11，并结合第一行可以解得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_1%2C%5Cgamma_%7B11%7D) ，然后再利用第二行得到

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7B12+k-1%7D%3D%5Crho_%7B12+k%2B1%7D%3D%5Cleft%28-%5Cfrac%7Bb%7D%7B1%2Bb%5E%7B2%7D%7D+%5CPhi%5E%7Bk%7D%5Cright%29%2C+k%3D0%2C1%2C2%2C+%5Ccdots%5C%5C) 

对于其余的 k（例如 2），第二行分别用 2 和 10 来代，解得两个自协方差函数都是 0，进而自相关函数都是 0.

### （4）非平稳季节 ARIMA 模型

如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7BY%7D_%7B%5Cboldsymbol%7Bt%7D%7D%3D%5Cboldsymbol%7B%5Cnabla%7D%5E%7Bd%7D+%5Cnabla_%7B%5Cboldsymbol%7Bs%7D%7D%5E%7BD%7D+%5Cboldsymbol%7BX%7D_%7B%5Cboldsymbol%7Bt%7D%7D) 是周期为 s 的季节 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Crm%7BARMA%7D%7D%28p%2Cq%29+%5Ctimes+%7B%28P%2CQ%29_s%7D%5C%5D) 模型，那么称 Xt 为季节周期 s，非季节阶数为 p,d,q ，季节阶数为 P,D,Q 的季节 ARIMA 模型，或称周期为 s的 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Crm%7BARIMA%7D%7D%28p%2Cd%2Cq%29+%5Ctimes+%7B%28P%2CD%2CQ%29_s%7D%5C%5D) 模型。

**说明**： ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Cnabla%7D%5E%7Bd%7D+) 为某个 d 阶多项式作用后移算子，表示横向趋势（即不同季节之间）， ![[公式]](https://www.zhihu.com/equation?tex=%5Cnabla_%7B%5Cboldsymbol%7Bs%7D%7D%5E%7BD%7D) 为某个 D 阶多项式作用后移算子的 s 次方，表示纵向趋势（同一季节不同年份之间）。

实际问题中 d 和 D 都很小，一般 D=0 或 1，如果取更大，那么上升速度就过快了，不是爆发的阶段一般不这么取。

**回顾建模步骤**：

考察如下的周期 12 ， N 年的数据

![img](https://pic4.zhimg.com/80/v2-a6a3ed91fd55db7127f98c38baec9723_720w.jpg)

对第 j 列数据，将其中心化（减去均值，记为 Z ）后，可以拟合一个 ARMA(p,q) 序列。

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BA%7D%5Cleft%28B%5E%7B12%7D%5Cright%29+Z_%7Bj%2B12+t%7D%3D%5Cmathrm%7BB%7D%5Cleft%28B%5E%7B12%7D%5Cright%29+%5Cvarepsilon_%7Bj%2B12+t%7D%2C+%5Cvarepsilon_%7Bj%2B12+t%7D+%5Csim+W+N%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29%5C%5C) 

之前提到，如果这里的白噪声真的就是白噪声，那么不同季节之间不相关，显然不合理。

所以假设这时的 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%5C%7B+%7B%7B%5Cvarepsilon+_t%7D%7D+%5Cright%5C%7D%5C%5D) 也是一个 ARMA 序列，建立一个较低阶的 ARMA(p0,q0) 模型。

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D_%7B0%7D%28B%29+%5Cvarepsilon_%7Bt%7D%3D%5Cmathrm%7BB%7D_%7B0%7D%28B%29+%5Cvarepsilon_%7Bt%7D%5E%7B%2A%7D%5C%5C) 

进而得到季节 ARMA 模型

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BA%7D_%7B0%7D%28B%29+%5Cmathrm%7B~A%7D%5Cleft%28B%5E%7B12%7D%5Cright%29+Z_%7Bt%7D%3D%5Cmathrm%7BB%7D%28B%29+%5Cmathrm%7BB%7D%5Cleft%28B%5E%7B12%7D%5Cright%29+%5Cvarepsilon_%7Bt%7D%5E%7B%2A%7D%2C+t%3D1%2C2%2C+%5Ccdots%5C%5C) 

但这样的模型没有考虑随年份，随季节的递增趋势，所以上面的 Z 实际上应该要经过差分才能得到，而不仅仅是中心化。

![[公式]](https://www.zhihu.com/equation?tex=Z_%7Bt%7D%3D%281-B%29%5E%7Bd%7D%5Cleft%281-B%5E%7B12%7D%5Cright%29%5E%7BD%7D+Y_%7Bt%7D%2C+t%3D12+D%2Bd%2B1%2C+%5Ccdots%2C+12%2B12+N%5C%5C) 

由差分后得到的 Z 结合之前的季节 ARMA 模型，可以得到关于 Y 的季节 ARIMA 模型

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BA%7D_%7B0%7D%28B%29+%5Cmathrm%7B~A%7D%5Cleft%28B%5E%7B12%7D%5Cright%29%281-B%29%5E%7Bd%7D%5Cleft%281-B%5E%7B12%7D%5Cright%29%5E%7BD%7D+Y_%7Bt%7D%3D%5Cmathrm%7BB%7D%28B%29+%5Cmathrm%7BB%7D%5Cleft%28B%5E%7B12%7D%5Cright%29+%5Cvarepsilon_%7Bt%7D%5E%7B%2A%7D%2C+t%3D1%2C2%2C+%5Ccdots%5C%5C) 

## 第四章 均值和自协方差函数的估计

## 4.1 均值的估计

通过之前对不同模型的介绍，我们了解到 AR,MA,ARMA 模型的参数都可以由其自协方差函数唯一确定。因此如何由样本来估计自协方差函数是关键的。

估计量是自然的：用样本均值估计总体均值，样本自协方差函数估计总体自协方差函数。

但这里需要考虑几个问题：相合性、渐近分布、收敛速度。

### （一）相合性

**定理**：平稳序列的自协方差函数收敛到0，那么样本均值是总体均值的相合估计。

根据定义，求样本均值与总体均值的均方误差

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28%5Cbar%7BX%7D_%7BN%7D-%5Cmu%5Cright%29%5E%7B2%7D%3D%5Cmathrm%7BE%7D%5Cleft%5B%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bk%3D1%7D%5E%7BN%7D%5Cleft%28X_%7Bk%7D-%5Cmu%5Cright%29%5Cright%5D%5E%7B2%7D%5C%5C%5Cbegin%7Barray%7D%7Bl%7D+%3D%5Cfrac%7B1%7D%7BN%5E%7B2%7D%7D+%5Cmathrm%7BE%7D%5Cleft%5B%5Csum_%7Bj%3D1%7D%5E%7BN%7D+%5Csum_%7Bk%3D1%7D%5E%7BN%7D%5Cleft%28X_%7Bk%7D-%5Cmu%5Cright%29%5Cleft%28X_%7Bj%7D-%5Cmu%5Cright%29%5Cright%5D%3D%5Cfrac%7B1%7D%7BN%5E%7B2%7D%7D+%5Csum_%7Bj%3D1%7D%5E%7BN%7D+%5Csum_%7Bk%3D1%7D%5E%7BN%7D+%5Cgamma_%7Bk-j%7D+%5C%5C+%3D%5Cfrac%7B1%7D%7BN%5E%7B2%7D%7D+%5Csum_%7Bj%3D1%7D%5E%7BN%7D+%5Csum_%7Bm%3D1-j%7D%5E%7BN-j%7D+%5Cgamma_%7Bm%7D+%5Cquad%28%5Ctext+%7B+%E4%BB%A4+%7D+m%3Dk-j%29+%5C%5C+%3D%5Cfrac%7B1%7D%7BN%5E%7B2%7D%7D+%5Csum_%7Bm%3D-N%2B1%7D%5E%7BN-1%7D+%5Csum_%7Bj%3D%281-m%29+%5Cvee+1%7D%5E%7B%28N-m%29+%5Cwedge+N%7D+%5Cgamma_%7Bm%7D%3D%5Cfrac%7B1%7D%7BN%5E%7B2%7D%7D+%5Csum_%7Bm%3D-N%2B1%7D%5E%7BN-1%7D%28N-%7Cm%7C%29+%5Cgamma_%7Bm%7D+%5Cend%7Barray%7D%5C%5C%5Cleq+%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bm%3D-N%7D%5E%7BN%7D%5Cleft%7C%5Cgamma_%7Bm%7D%5Cright%7C+%5Crightarrow+0%2C+%5Cquad+%5Ctext+%7B+%E5%BD%93+%7D+N+%5Crightarrow+%5Cinfty) 

**第二个等号**把求和平方写成双重求和，然后得到自协方差函数（**第三个等号**），再做求和指标的变换。**第四个等号**：类似二重积分的交换次序，先考虑 m 的范围，容易得到 1-N 到 N-1 。然后利用 m 原本的范围 1-j 到 N-j 可以得到 j 的范围是 1-m 到 N-m ，但 j 一开始已经固定在 1 到 N 中，取交集就得到这个结果。**第五个等号**通过对 m 的正负讨论来计数。最后一步，利用数学分析中“数列平均的极限等于通项的极限”的结论。

进而利用切比雪夫不等式

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BPr%7D%5Cleft%28%5Cleft%7C%5Cbar%7BX%7D_%7BN%7D-%5Cmu%5Cright%7C+%5Cgeq+%5Cdelta%5Cright%29+%5Cleq+%5Cfrac%7BE%5Cleft%28%5Cbar%7BX%7D_%7BN%7D-%5Cmu%5Cright%29%5E%7B2%7D%7D%7B%5Cdelta%5E%7B2%7D%7D+%5Crightarrow+0%2C+%5Cquad%28%5Cdelta%3E0%29%5C%5C) 

得到样本均值的相合性。

此外，如果平稳序列是**严平稳且遍历**的，那么样本均值是**强相合**的。

回顾一下，严平稳遍历序列有强大数律：

![[公式]](https://www.zhihu.com/equation?tex=%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bt%3D1%7D%5E%7Bn%7D+X_%7Bt%7D%3DE+X_%7B1%7D%2C+%5Ctext+%7B+a.s.+%7D%5C%5C) 

### （二）中心极限定理

我们知道如果时间序列数据中每个样本点是独立同分布的，那么 

![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Cbar%7BX%7D_%7BN%7D-%5Cmu%5Cright%29+%5Cstackrel%7B%5Cmathrm%7Bd%7D%7D%7B%5Crightarrow%7D+%5Cmathrm%7BN%7D%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29%5C%5C) 

有了渐近分布，计算参数的置信区间就容易了。下面讨论一般的平稳列的中心极限定理。

**定理** 对于线性平稳列，如果白噪声时同分布的

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cmu%2B%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bk%7D+%5Cvarepsilon_%7Bt-k%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

其中白噪声的系数**平方可和**（绝对可和当然更加成立），则只要平稳列的谱密度

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bk%7D+e%5E%7B-i+k+%5Clambda%7D%5Cright%7C%5E%7B2%7D%5C%5C) 

**在 0 处连续**并且 ![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29+%5Cne+0) ，那么有如下渐近分布：

![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Cbar%7BX%7D_%7BN%7D-%5Cmu%5Cright%29+%5Cstackrel%7B%5Cmathrm%7Bd%7D%7D%7B%5Crightarrow%7D+%5Cmathrm%7BN%7D%280%2C2+%5Cpi+f%280%29%29%5C%5C) 

 其中渐近方差的计算如下（与之前相合性证明的过程一样）:![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Cqquad+%5Cbegin%7Baligned%7D+N+E+%26%5Cleft%28%5Cbar%7BX%7D_%7BN%7D-%5Cmu%5Cright%29%5E%7B2%7D%3DN+E%5Cleft%5B%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bk%3D1%7D%5E%7BN%7D%5Cleft%28X_%7Bk%7D-%5Cmu%5Cright%29%5Cright%5D%5E%7B2%7D+%5C%5C+%26%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bm%3D-N%2B1%7D%5E%7BN-1%7D%28N-%7Cm%7C%29+%5Cgamma_%7Bm%7D+%5C%5C+%26%3D%5Csum_%7Bm%3D-N%7D%5E%7BN%7D+%5Cgamma_%7Bm%7D-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bm%3D-N%7D%5E%7BN%7D%7Cm%7C+%5Cgamma_%7Bm%7D+%5Crightarrow+%5Csum_%7Bm%3D-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D+%5Cgamma_%7Bm%7D+%5Cend%7Baligned%7D+%5Cend%7Barray%7D%5C%5C) 

然后利用自协方差函数与谱密度的关系，可以得到定理中的 ![[公式]](https://www.zhihu.com/equation?tex=2+%5Cpi+f%280%29) ，此外也可以用平稳序列的自协方差函数公式来得到，具体步骤如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Csum_%7Bm%3D-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D+%5Cgamma_%7Bm%7D+%26%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bm%3D-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D+%5Csum_%7Bt%3D-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D+%5Cpsi_%7Bt%7D+%5Cpsi_%7Bt%2Bm%7D+%5C%5C+%26%3D%5Csigma%5E%7B2%7D%5Cleft%5B%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%2B%5Cinfty%7D+%5Cpsi_%7Bk%7D%5Cright%5D%5E%7B2%7D%3D2+%5Cpi+f%280%29+%5Cend%7Baligned%7D%5C%5C) 

**注意**：如果考试让证明某个平稳列的中心极限定理，不能直接用这个定理来得到。过程应该是：把 X1+X2+...+Xt 用白噪声来表示，利用白噪声的独立性，由不同分布的中心极限定理来得到渐近正态性。



## 4.1 均值的估计

### （三）收敛速度

一般来说，重对数律满足时，收敛速度为

![[公式]](https://www.zhihu.com/equation?tex=O%5Cleft%28%5Csqrt%7B%5Cfrac%7B2+%5Cln+%5Cln+N%7D%7BN%7D%7D%5Cright%29%5C%5C) 

**定理** 线性平稳序列 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D) 定义如下，其谱密度在 0 处非 0

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cmu%2B%5Csum_%7Bk%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bk%7D+%5Cvarepsilon_%7Bt-k%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

当以下条件成立一个时：

- ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi_%7B%7Ck%7C%7D) 负指数趋于 0
- 谱密度在 0 处连续且 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%7C%5Cvarepsilon_%7Bt%7D%5Cright%7C%5E%7Br%7D%3C%5Cinfty) 对某个 r > 2 成立

那么有重对数律

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Climsup+_%7BN+%5Crightarrow+%5Cinfty%7D+%5Csqrt%7B%5Cfrac%7BN%7D%7B2+%5Cln+%5Cln+N%7D%7D%5Cleft%28%5Cbar%7BX%7D_%7BN%7D-%5Cmu%5Cright%29%3D%5Csqrt%7B2+%5Cpi+f%280%29%7D%2C+%5Cquad+%5Ctext+%7B+a.s.+%7D+%5C%5C+%5Climinf+_%7BN+%5Crightarrow+%5Cinfty%7D+%5Csqrt%7B%5Cfrac%7BN%7D%7B2+%5Cln+%5Cln+N%7D%7D%5Cleft%28%5Cbar%7BX%7D_%7BN%7D-%5Cmu%5Cright%29%3D-%5Csqrt%7B2+%5Cpi+f%280%29%7D%2C+%5Cquad+%5Ctext+%7B+a.s.+%7D+%5Cend%7Barray%7D%5C%5C) 

从中可得

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbar%7BX%7D_%7Bn%7D-%5Cmu%5Cright%29+%5Ccdot+o%281%29%3Do%5Cleft%28%5Csqrt%7B%5Cfrac%7B%5Cln+%5Cln+N%7D%7BN%7D%7D%5Cright%29%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7B%5Cfrac%7BN%7D%7B2+%5Cln+%5Cln+N%7D%7D%5Cleft%28%5Cbar%7BX%7D_%7Bn%7D-%5Cmu%5Cright%29+%2F+o%281%29%E4%B8%8D%E6%94%B6%E6%95%9B%5C%5C) 

这个结果非常的好，因为即使序列是独立同分布的，也不过是这个结果。

### （四）AR(2) 均值的计算

令 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D%5Cleft%281-%5Crho+e%5E%7Bi+%5Ctheta%7D+%5Ccdot+z%5Cright%29%5Cleft%281-%5Crho+e%5E%7B-i+%5Ctheta%7D+%5Ccdot+z%5Cright%29) ，考虑如下 AR(2) 模型

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D+%26%3D%5Cvarepsilon_%7Bt%7D+%5C%5C+X_%7Bt%7D+%26%3D2+%5Crho+%5Ccos+%5Ctheta+X_%7Bt-1%7D-%5Crho%5E%7B2%7D+X_%7Bt-2%7D%2B%5Cvarepsilon_%7Bt%7D+%5Cend%7Baligned%7D%5C%5C) 

为模拟方便，假定 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D+%5Ctext+%7B+iid+%7D+%5Csim+N%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29) 

将样本均值记为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbar%7Bx%7D_%7BN%7D%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7BN%7D+x_%7Bt%7D%2C+%5Cquad+%5Cbar%7B%5Cvarepsilon%7D_%7BN%7D%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7BN%7D+%5Cvarepsilon_%7Bt%7D%5C%5C) 

对模型两边求和再取平均得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cbar%7Bx%7D_%7BN%7D%3D%26+2+%5Crho+%5Ccos+%5Ctheta+%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bk%3D0%7D%5E%7BN-1%7D+x_%7Bk%7D-%5Crho%5E%7B2%7D+%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bk%3D-1%7D%5E%7BN-2%7D+x_%7Bk%7D%2B%5Cbar%7B%5Cvarepsilon%7D_%7BN%7D+%5C%5C+%3D%26+2+%5Crho+%5Ccos+%5Ctheta+%5Cbar%7Bx%7D_%7BN%7D-%5Crho%5E%7B2%7D+%5Cbar%7Bx%7D_%7BN%7D%2B%5Cbar%7B%5Cvarepsilon%7D_%7BN%7D+%5C%5C+%26%2B2+%5Crho+%5Ccos+%5Ctheta+%5Cfrac%7B1%7D%7BN%7D%5Cleft%28x_%7B0%7D-x_%7BN%7D%5Cright%29-%5Crho%5E%7B2%7D+%5Cfrac%7B1%7D%7BN%7D%5Cleft%28x_%7B-1%7D%2Bx_%7B0%7D-x_%7BN-1%7D-x_%7BN-2%7D%5Cright%29+%5C%5C+%5Capprox+%26+2+%5Crho+%5Ccos+%5Ctheta+%5Cbar%7Bx%7D_%7BN%7D-%5Crho%5E%7B2%7D+%5Cbar%7Bx%7D_%7BN%7D%2B%5Cbar%7B%5Cvarepsilon%7D_%7BN%7D+%5Cend%7Baligned%7D%5C%5C) 

第二个等号是配凑样本均值，最后一步令 N 趋于无穷，后面两项几乎处处趋于 0.

进而 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbar%7Bx%7D_%7BN%7D+%5Capprox+%5Cfrac%7B1%7D%7BA%281%29%7D+%5Cbar%7B%5Cvarepsilon%7D_%7BN%7D%3D%5Cfrac%7B1%7D%7B1-2+%5Crho+%5Ccos+%5Ctheta%2B%5Crho%5E%7B2%7D%7D+%5Cbar%7B%5Cvarepsilon%7D_%7BN%7D) ，可见当 N 趋于无穷时，线性平稳序列的样本均值 与 白噪声 的样本均值**近似成正比**。

### （五）估计收敛性的模拟

为了直观理解上面“近似成正比”的结果，我们取定参数进行随机模拟，结果如下。

![img](https://pic4.zhimg.com/80/v2-0d424bf0d20dbc982920578a921b96b7_720w.jpg)

![img](https://pic4.zhimg.com/80/v2-f6f58460299139b79192acfabb9f574f_720w.jpg)

可见，线性平稳序列的样本均值 与 白噪声 的样本均值非常的接近。

现在我们重复上述过程，得到 M = 1000 个序列，也就得到了 1000 个样本均值。

现在研究这 1000 个样本均值的均值和方差，结果如下表。

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7B%7Cl%7Cl%7Cl%7Cl%7Cl%7Cl%7Cl%7C%7D+%5Chline+N+%26+10+%26+20+%26+40+%26+100+%26+400+%26+600+%26+1000+%5C%5C+%5Chline+A+v+e%28%5Chat%7B%5Cmu%7D%29+%26+-0.0055+%26+-0.0032+%26+-0.0029+%26+-0.0009+%26+-0.0008+%26+-0.0003+%26+0.0001+%5C%5C+%5Chline+A+v+e%28%5Chat%7Be%7D%29+%26+-0.0168+%26+-0.0135+%26+-0.0060+%26+-0.0037+%26+-0.0024+%26+-0.0008+%26+0.0003+%5C%5C+%5Chline+S+t+d%28%5Chat%7B%5Cmu%7D%29+%26+0.1922+%26+0.1068+%26+0.0616+%26+0.0347+%26+0.0154+%26+0.0128+%26+0.0102+%5C%5C+%5Chline+S+t+d%28%5Chat%7Be%7D%29+%26+0.3511+%26+0.2351+%26+0.1575+%26+0.0967+%26+0.0464+%26+0.0388+%26+0.0312+%5C%5C+%5Chline+%5Cend%7Barray%7D) 

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cmu%7D) 为平稳序列的样本均值序列， ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7Be%7D) 为白噪声的样本均值序列。

根据收敛速度的定理，样本均值的收敛速度为 ![[公式]](https://www.zhihu.com/equation?tex=o%5Cleft%28%5Csqrt%7B%5Cfrac%7B%5Cln+%5Cln+MN%7D%7BMN%7D%7D%5Cright%29) ，样本标准差的收敛速度为 ![[公式]](https://www.zhihu.com/equation?tex=o%5Cleft%28%5Csqrt%7B%5Cfrac%7B1%7D%7BN%7D%7D%5Cright%29) ，取不同的 N ，结果是吻合的。

**ps**：这一部分主要是提供一种分析数据的角度。

## 4.2 自协方差函数的估计

估计量是自然的（样本协方差函数）：

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cgamma%7D_%7Bk%7D%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7BN-k%7D%5Cleft%28x_%7Bj%7D-%5Cbar%7Bx%7D_%7BN%7D%5Cright%29%5Cleft%28x_%7Bj%2Bk%7D-%5Cbar%7Bx%7D_%7BN%7D%5Cright%29%2C+%5Cquad+0+%5Cleq+k+%5Cleq+N-1%5C%5C) 

自相关系数的估计为 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Crho%7D_%7Bk%7D%3D%5Cfrac%7B%5Chat%7B%5Cgamma%7D_%7Bk%7D%7D%7B%5Chat%7B%5Cgamma%7D_%7B0%7D%7D%2C+%5Cquad%7Ck%7C+%5Cleq+N-1) 

**注**：这里不除 N-k，**一方面**我们不对较大的 k 求自协方差函数，**另一方面（更重要）**只有除以 N 才能保证自协方差函数正定。

下面说明样本自协方差函数的正定性。

### （一）样本自协方差函数的正定性

只要样本观测值 ![[公式]](https://www.zhihu.com/equation?tex=x_%7B1%7D%2C+x_%7B2%7D%2C+%5Cldots%2C+x_%7BN%7D) 不全相同

那么 

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5CGamma%7D_%7BN%7D%3D%5Cleft%28%5Chat%7B%5Cgamma%7D_%7Bk-j%7D%5Cright%29_%7Bk%2C+j%3D1%2C2%2C+%5Cldots%2C+N%7D%E6%AD%A3%E5%AE%9A%5C%5C) 

令 ![[公式]](https://www.zhihu.com/equation?tex=y_%7Bj%7D%3Dx_%7Bj%7D-%5Cbar%7Bx%7D_%7BN%7D) ，记

![[公式]](https://www.zhihu.com/equation?tex=A%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bcccccccc%7D+0+%26+%5Ccdots+%26+0+%26+y_%7B1%7D+%26+y_%7B2%7D+%26+%5Ccdots+%26+y_%7BN-1%7D+%26+y_%7BN%7D+%5C%5C+0+%26+%5Ccdots+%26+y_%7B1%7D+%26+y_%7B2%7D+%26+y_%7B3%7D+%26+%5Ccdots+%26+y_%7BN%7D+%26+0+%5C%5C+%5Cvdots+%26+%5Ccdots+%26+%5Cvdots+%26+%5Cvdots+%26+%5Cvdots+%26+%5Ccdots+%26+%5Cvdots+%26+%5Cvdots+%5C%5C+y_%7B1%7D+%26+%5Ccdots+%26+y_%7BN-1%7D+%26+y_%7BN%7D+%26+0+%26+%5Ccdots+%26+0+%26+0+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

则 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5CGamma%7D_%7BN%7D%3D%5Cfrac%7B1%7D%7BN%7D+A+A%5E%7BT%7D) ，只要 ![[公式]](https://www.zhihu.com/equation?tex=y_i) 不全为 0，则 A 秩为 N，进而样本自协方差阵满秩。

**秩为 N 的说明**：不妨设 ![[公式]](https://www.zhihu.com/equation?tex=y_1) 不为 0 ，观察第 1 到 第 N 列，它们是线性无关的。对于其它的 ![[公式]](https://www.zhihu.com/equation?tex=y_i) 也是同理的（找一个非零斜面）。

### （二）相合性

**定理1** 估计量是渐近无偏的

![[公式]](https://www.zhihu.com/equation?tex=%5Clim+_%7BN+%5Crightarrow+%5Cinfty%7D+%5Cmathrm%7BE%7D+%5Chat%7B%5Cgamma%7D_%7Bk%7D%3D%5Cgamma_%7Bk%7D%5C%5C) 

**证明**：首先记原序列中心化后的序列为 ![[公式]](https://www.zhihu.com/equation?tex=%5C%7BY_t%5C%7D) ，其样本均值为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbar%7BY%7D_%7BN%7D%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7BN%7D+Y_%7Bj%7D%3D%5Cbar%7BX%7D_%7BN%7D-%5Cmu%5C%5C) 

进而根据样本自协方差函数的定义（中心化前后样本自协方差函数一样）![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Chat%7B%5Cgamma%7D_%7Bk%7D+%26%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7BN-k%7D%5Cleft%28Y_%7Bj%7D-%5Cbar%7BY%7D_%7BN%7D%5Cright%29%5Cleft%28Y_%7Bj%2Bk%7D-%5Cbar%7BY%7D_%7BN%7D%5Cright%29+%5C%5C+%26%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7BN-k%7D%5Cleft%5BY_%7Bj%7D+Y_%7Bj%2Bk%7D-%5Cbar%7BY%7D_%7BN%7D%5Cleft%28Y_%7Bj%2Bk%7D%2BY_%7Bj%7D%5Cright%29%2B%5Cbar%7BY%7D_%7BN%7D%5E%7B2%7D%5Cright%5D+%5Cend%7Baligned%7D%5C%5C) 

之前在均值估计相合性中我们得到 ![[公式]](https://www.zhihu.com/equation?tex=E+%5Cbar%7BY%7D_%7BN%7D%5E%7B2%7D%3DE%5Cleft%28%5Cbar%7BX%7D_%7BN%7D-%5Cmu%5Cright%29%5E%7B2%7D+%5Crightarrow+0) ，对于中间那项，利用柯西不等式

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%7C%5Cbar%7BY%7D_%7BN%7D%5Cleft%28Y_%7Bj%2Bk%7D%2BY_%7Bj%7D%5Cright%29%5Cright%7C+%5Cleq%5Cleft%5B%5Cmathrm%7BE%7D+%5Cbar%7BY%7D_%7BN%7D%5E%7B2%7D+%5Cmathrm%7BE%7D%5Cleft%28Y_%7Bj%2Bk%7D%2BY_%7Bj%7D%5Cright%29%5E%7B2%7D%5Cright%5D%5E%7B1+%2F+2%7D+%5Cleq%5Cleft%5B4+%5Cmathrm%7BE%7D+%5Cbar%7BY%7D_%7BN%7D%5E%7B2%7D+%5Cgamma_%7B0%7D%5Cright%5D%5E%7B1+%2F+2%7D+%5Crightarrow+0%5C%5C) 

第二步利用 ![[公式]](https://www.zhihu.com/equation?tex=%28a%2Bb%29%5E2+%5Cleq+2%28a%5E2%2Bb%5E2%29) 

所以

![[公式]](https://www.zhihu.com/equation?tex=E+%5Chat%7B%5Cgamma%7D_%7Bk%7D%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7BN-k%7D+E%5Cleft%28Y_%7Bj%7D+Y_%7Bj%2Bk%7D%5Cright%29%2Bo%281%29%3D%5Cfrac%7BN-k%7D%7BN%7D+%5Cgamma_%7Bk%7D%2Bo%281%29+%5Crightarrow+%5Cgamma_%7Bk%7D%5C%5C) 

**定理2** 如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 是严平稳遍历序列，则有强相合性

![[公式]](https://www.zhihu.com/equation?tex=%5Clim+_%7BN+%5Crightarrow+%5Cinfty%7D+%5Chat%7B%5Cgamma%7D_%7Bk%7D%3D%5Cgamma_%7Bk%7D%2C+%5Ctext+%7B+a.s.%2C+%7D+%5Cquad+%5Clim+_%7BN+%5Crightarrow+%5Cinfty%7D+%5Chat%7B%5Crho%7D_%7Bk%7D%3D%5Crho_%7Bk%7D%2C+%5Ctext+%7B+a.s.+%7D%5C%5C) 

**证明** 由严平稳遍历可得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbar%7BY%7D_%7BN%7D+%5Crightarrow+%5Cmathrm%7BE%7D+Y_%7B1%7D%3D0%2C+%5Cmathrm%7Ba.s.%7D) 

考虑上面定理证明中的中间那项

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7BN-k%7D%5Cleft%28Y_%7Bj%2Bk%7D%2BY_%7Bj%7D%5Cright%29%3D%5Cfrac%7B1%7D%7BN%7D%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7BN%7D+Y_%7Bj%7D-%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+Y_%7Bj%7D%2B%5Csum_%7Bj%3D1%7D%5E%7BN-k%7D+Y_%7Bj%7D%5Cright%29+%5C%5C%26+%3D%5Cbar%7BY%7D_%7BN%7D-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+Y_%7Bj%7D%2B%5Cfrac%7BN-k%7D%7BN%7D+%5Cbar%7BY%7D_%7BN-k%7D+%5Crightarrow+0%2C+%5Cmathrm%7Ba.s.%7D+%5Cend%7Baligned%7D%5C%5C) 

所以

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cgamma%7D_%7Bk%7D%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7BN-k%7D+Y_%7Bj%7D+Y_%7Bj%2Bk%7D%2Bo%281%29+%5Crightarrow+E%5Cleft%28Y_%7B1%7D+Y_%7B1%2Bk%7D%5Cright%29%3D%5Cgamma_%7Bk%7D%2C+%5Ctext+%7B+a.s.+%7D%5C%5C) 

### （三）渐近分布--证明不要求，会用即可

下面讨论白噪声四阶矩存在、独立同分布，并且系数平方可和的平稳列。

令

![[公式]](https://www.zhihu.com/equation?tex=%5Cmu_%7B4%7D%3D%5Cmathrm%7BE%7D+%5Cvarepsilon_%7B1%7D%5E%7B4%7D%2C+%5Cquad+M_%7B0%7D%3D%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cleft%28%5Cmu_%7B4%7D-%5Csigma%5E%7B4%7D%5Cright%29%5E%7B1+%2F+2%7D%3E0%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5Cmu_%7B4%7D-%5Csigma%5E%7B4%7D)实际上是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7B1%7D%5E%7B2%7D) 的方差。设 ![[公式]](https://www.zhihu.com/equation?tex=%5C%7BW_t%5C%7D) 是独立同分布的标准正态分布

定义（第一眼看上去有点不知所以）

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Cxi_%7Bj%7D%3D%5Cleft%28M_%7B0%7D+%5Cgamma_%7Bj%7D%5Cright%29+W_%7B0%7D%2B%5Csum_%7Bt%3D1%7D%5Cleft%28%5Cgamma_%7Bt%2Bj%7D%2B%5Cgamma_%7Bt-j%7D%5Cright%29+W_%7Bt%7D%2C+%5Cquad+j+%5Cgeq+0+%5C%5C+R_%7Bj%7D%3D%5Csum_%7Bt%3D1%7D%5E%7B%5Cinfty%7D%5Cleft%28%5Crho_%7Bt%2Bj%7D%2B%5Crho_%7Bt-j%7D-2+%5Crho_%7Bt%7D+%5Crho_%7Bj%7D%5Cright%29+W_%7Bt%7D%2C+%5Cquad+j+%5Cgeq+1+%5Cend%7Barray%7D%5C%5C) 

不过最基本的“正态分布”还是能够看出来的。其中均值为 0，方差为诸 W 前**系数的平方和**。

**定理** 如果独立同分布白噪声的**四阶矩存在**，并且平稳列的谱密度**平方可积**

![[公式]](https://www.zhihu.com/equation?tex=%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+f%28%5Clambda%29%5E%7B2%7D+d+%5Clambda%3C%5Cinfty%5C%5C) 

那么对任何正整数 h，当 N 充分大时有以下依分布收敛结果：

- ![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Chat%7B%5Cgamma%7D_%7B0%7D-%5Cgamma_%7B0%7D%2C+%5Chat%7B%5Cgamma%7D_%7B1%7D-%5Cgamma_%7B1%7D%2C+%5Cldots%2C+%5Chat%7B%5Cgamma%7D_%7Bh%7D-%5Cgamma_%7Bh%7D%5Cright%29%5Crightarrow%5Cleft%28%5Cxi_%7B0%7D%2C+%5Cxi_%7B1%7D%2C+%5Cldots%2C+%5Cxi_%7Bh%7D%5Cright%29) 
- ![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Chat%7B%5Crho%7D_%7B1%7D-%5Crho_%7B1%7D%2C+%5Chat%7B%5Crho%7D_%7B2%7D-%5Crho_%7B2%7D%2C+%5Cldots%2C+%5Chat%7B%5Crho%7D_%7Bh%7D-%5Crho_%7Bh%7D%5Cright%29%5Crightarrow%5Cleft%28R_%7B1%7D%2C+R_%7B2%7D%2C+%5Cldots%2C+R_%7Bh%7D%5Cright%29) 

根据前面相合性的结果，有

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Chat+%5Cgamma+_k%7D+-+%7B%5Cgamma+_k%7D+%3D+%5Cfrac%7B1%7D%7BN%7D%5Csum%5Climits_%7Bj+%3D+1%7D%5E%7BN+-+k%7D+%7B%5Cleft%28+%7B%7BY_j%7D%7BY_%7Bj+%2B+k%7D%7D+-+E%7BY_j%7D%7BY_%7Bj+%2B+k%7D%7D%7D+%5Cright%29%7D++%2B+o%5Cleft%28+1+%5Cright%29%5C%5C%5C%5D) 

渐近正态性由中心极限定理可知，只要比较两边的协方差矩阵是否相等即可，但比较复杂，不做要求。

### （四）自相关检验例子-- MA(q) 序列

当 m > q 时，总体的自相关系数为 0，根据上面的定理， ![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D+%5Chat%7B%5Crho%7D_%7Bm%7D) 依分布收敛到 ![[公式]](https://www.zhihu.com/equation?tex=R_m) 的分布，其中

![[公式]](https://www.zhihu.com/equation?tex=R_%7Bm%7D%3D%5Csum_%7Bt%3D1%7D%5E%7B%5Cinfty%7D%5Cleft%28%5Crho_%7Bt%2Bm%7D%2B%5Crho_%7Bt-m%7D-2+%5Crho_%7Bt%7D+%5Crho_%7Bm%7D%5Cright%29+W_%7Bt%7D%2C+%5Cquad+m+%5Cgeq+q%2B1%5C%5C) 

注意到当 m > q 时， ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bm%7D%3D0%2C+%5Crho_%7Bt%2Bm%7D%3D0) ，并且 t-m 应该在 -q 到 q 之间，令 l=t-m ，可以将上式化简为

![[公式]](https://www.zhihu.com/equation?tex=R_%7Bm%7D%3D%5Csum_%7Bl%3D-q%7D%5E%7Bq%7D+%5Crho_%7Bl%7D+W_%7Bl%2Bm%7D%5C%5C) 

即 

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Csqrt+N+%7B%5Chat+%5Crho+_m%7D+%5Cto+N%5Cleft%28+%7B0%2C1+%2B+2%5Crho+_1%5E2+%2B++%5Ccdots++%2B+2%5Crho+_q%5E2%7D+%5Cright%29%2Cm%3Eq%5C%5C%5C%5D) 

这个式子可以**用于假设检验**。试想，如果我们已经确定了 q，那么 m > q 时，根据渐近正态分布，可以给出自相关系数 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat+%5Crho+_m) 的置信区间，如果根据样本得到的样本自相关系数没有落在这个区间中，就可以认为该序列不是 MA(q) 序列。

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BPr%7D%5Cleft%28%5Cfrac%7B%5Csqrt%7BN%7D%5Cleft%7C%5Chat%7B%5Crho%7D_%7Bm%7D%5Cright%7C%7D%7B%5Csqrt%7B1%2B2+%5Crho_%7B1%7D%5E%7B2%7D%2B2+%5Crho_%7B2%7D%5E%7B2%7D%2B%5Ccdots%2B2+%5Crho_%7Bq%7D%5E%7B2%7D%7D%7D+%5Cgeq+1.96%5Cright%29+%5Capprox+0.05%5C%5C) 

当然，也可以利用这个渐近分布来确定 q，具体做法为：q 从 1 开始逐渐增大，观察当 m > q 时，样本自相关系数是否都落在置信区间中。

### 例子-- AR(1) 序列

同样利用定理可得

![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Chat%7B%5Crho%7D_%7Bm%7D-%5Crho_%7Bm%7D%5Cright%29%5Crightarrow+N%5Cleft%280%2C+%5Cfrac%7B%5Cleft%281%2Ba%5E%7B2%7D%5Cright%29%5Cleft%281-a%5E%7B2+m%7D%5Cright%29%7D%7B1-a%5E%7B2%7D%7D-2+m+a%5E%7B2+m%7D%5Cright%29%5C%5C) 

利用 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7Bk%7D%3Da%5E%7B%7Ck%7C%7D) ，方差部分计算如下

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+ER_m%5E2+%3D+%5Csum%5Climits_%7Bi+%3D+1%7D%5E%5Cinfty++%7B%7B%7B%5Cleft%28+%7B%7B%5Crho+_%7Bt+%2B+m%7D%7D+%2B+%7B%5Crho+_%7Bt+-+m%7D%7D+-+2%7B%5Crho+_t%7D%7B%5Crho+_m%7D%7D+%5Cright%29%7D%5E2%7D%7D++%3D+%5Csum%5Climits_%7Bi+%3D+1%7D%5E%5Cinfty++%7B%7B%7B%5Cleft%28+%7B%7Ba%5E%7B%7Ct+-+m%7C%7D%7D+-+%7Ba%5E%7Bt+%2B+m%7D%7D%7D+%5Cright%29%7D%5E2%7D%7D+%5C%5C++%3D+%5Csum%5Climits_%7Bt+%3D+m%7D%5E%5Cinfty++%7B%7B%7B%5Cleft%28+%7B%7Ba%5E%7Bt+-+m%7D%7D+-+%7Ba%5E%7Bt+%2B+m%7D%7D%7D+%5Cright%29%7D%5E2%7D%7D++%2B+%5Csum%5Climits_%7Bi+%3D+1%7D%5E%7Bm+-+1%7D+%7B%7B%7B%5Cleft%28+%7B%7Ba%5E%7Bm+-+t%7D%7D+-+%7Ba%5E%7Bt+%2B+m%7D%7D%7D+%5Cright%29%7D%5E2%7D%7D+%5C%5C+%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bl%7D%7D+%7B+%3D+%7B%7B%5Cleft%28+%7B%7Ba%5E%7B+-+m%7D%7D+-+%7Ba%5Em%7D%7D+%5Cright%29%7D%5E2%7D%5Csum%5Climits_%7Bi+%3D+m%7D%5E%5Cinfty++%7B%7Ba%5E%7B2t%7D%7D%7D++%2B+%7Ba%5E%7B2m%7D%7D%5Csum%5Climits_%7Bi+%3D+1%7D%5E%7Bm+-+1%7D+%7B%7B%7B%5Cleft%28+%7B%7Ba%5E%7B+-+t%7D%7D+-+%7Ba%5Et%7D%7D+%5Cright%29%7D%5E2%7D%7D+%7D%5C%5C+%7B+%3D+%5Cfrac%7B%7B%7B%7B%5Cleft%28+%7B1+-+%7Ba%5E%7B2m%7D%7D%7D+%5Cright%29%7D%5E2%7D%7D%7D%7B%7B1+-+%7Ba%5E2%7D%7D%7D+%2B+%7Ba%5E%7B2m%7D%7D%5Cleft%5B+%7B%5Cfrac%7B%7B%7Ba%5E%7B+-+2%7D%7D+-+%7Ba%5E%7B+-+2m%7D%7D%7D%7D%7B%7B1+-+%7Ba%5E%7B+-+2%7D%7D%7D%7D+-+2%28m+-+1%29+%2B+%5Cfrac%7B%7B%7Ba%5E2%7D+-+%7Ba%5E%7B2m%7D%7D%7D%7D%7B%7B1+-+%7Ba%5E2%7D%7D%7D%7D+%5Cright%5D%7D%5C%5C+%7B+%3D+%5Cfrac%7B%7B%5Cleft%28+%7B1+%2B+%7Ba%5E2%7D%7D+%5Cright%29%5Cleft%28+%7B1+-+%7Ba%5E%7B2m%7D%7D%7D+%5Cright%29%7D%7D%7B%7B%5Cleft%28+%7B1+-+%7Ba%5E2%7D%7D+%5Cright%29%7D%7D+-+2m%7Ba%5E%7B2m%7D%7D%7D+%5Cend%7Barray%7D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

### （五）谱密度平方可积的等价条件

实际工作时**很难验证定理中“谱密度平方可积”的条件**，于是希望能把平方可积的条件改加在自协方差的收敛速度上。

**定理** 对平稳序列，自协方差函数平方可和的充分必要条件是谱密度平方可积。

### （六）定理中四阶矩条件放宽

四阶矩存在的条件太强了，可以改为对白噪声系数的要求：

对某个常数 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha%3E0.5) 

![[公式]](https://www.zhihu.com/equation?tex=m%5E%7B%5Calpha%7D+%5Csum_%7B%7Ck%7C+%5Cgeq+m%7D+%5Cpsi_%7Bk%7D%5E%7B2%7D+%5Crightarrow+0%2C+%5Cquad+m+%5Crightarrow+%5Cinfty%5C%5C) 

这个条件比较容易满足，特别是当系数本身是负指数趋于 0 的。

### （七）白噪声情形--得到非常好的结论

### （1）渐近分布介绍

**推论** 利用定理，如果 ![[公式]](https://www.zhihu.com/equation?tex=%5C%7BX_t%5C%7D) 是独立同分布的白噪声序列，自相关系数的估计还是

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Crho%7D_%7Bk%7D%3D%5Cfrac%7B%5Csum_%7Bt%3D1%7D%5E%7BN-k%7D%5Cleft%28x_%7Bt%7D-%5Cbar%7Bx%7D_%7BN%7D%5Cright%29%5Cleft%28x_%7Bt%2Bk%7D-%5Cbar%7Bx%7D_%7BN%7D%5Cright%29%7D%7B%5Csum_%7Bt%3D1%7D%5E%7BN%7D%5Cleft%28x_%7Bt%7D-%5Cbar%7Bx%7D_%7BN%7D%5Cright%29%5E%7B2%7D%7D%5C%5C) 

那么对于任何正整数 h， ![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Chat%7B%5Crho%7D_%7B1%7D%2C+%5Chat%7B%5Crho%7D_%7B2%7D%2C+%5Ccdots%2C+%5Chat%7B%5Crho%7D_%7Bh%7D%5Cright%29) 依分布收敛于**多元标准正态分布**。

利用这个结论，可以检验一个序列是否为白噪声。思路具体有如下两个：

- 利用多元正态性检验，构造卡方检验统计量
- 将 ![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Chat%7B%5Crho%7D_%7B1%7D%2C+%5Chat%7B%5Crho%7D_%7B2%7D%2C+%5Ccdots%2C+%5Chat%7B%5Crho%7D_%7Bh%7D%5Cright%29) 看做来自一元标准正态的样本，构造 U 检验统计量

同样利用定理，如果四阶矩存在，那么 ![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Chat%7B%5Cgamma%7D_%7B0%7D-%5Csigma%5E%7B2%7D%2C+%5Chat%7B%5Cgamma%7D_%7B1%7D%2C+%5Cldots%2C+%5Chat%7B%5Cgamma%7D_%7Bh%7D%5Cright%29) 依分布收敛于

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E2%5Cleft%28M_%7B0%7D+W_%7B0%7D%2C+W_%7B1%7D%2C+%5Cldots%2C+W_%7Bh%7D%5Cright%29%5C%5C) 

**验证** 设白噪声方差为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7B0%7D%3D%5Csigma%5E%7B2%7D) ，根据定理写出

![[公式]](https://www.zhihu.com/equation?tex=R_%7Bj%7D%3D%5Csum_%7Bt%3D1%7D%5E%7B%5Cinfty%7D%5Cleft%28%5Crho_%7Bt%2Bj%7D%2B%5Crho_%7Bt-j%7D-2+%5Crho_%7Bt%7D+%5Crho_%7Bj%7D%5Cright%29+W_%7Bt%7D%3DW_%7Bj%7D%2C+j+%5Cgeq+1%5C%5C) 

上面式子中， ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_k%3D0%2Ck+%5Cne+0) 

同样地

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cxi_%7Bj%7D+%26%3D%5Cleft%28M_%7B0%7D+%5Cgamma_%7Bj%7D%5Cright%29+W_%7B0%7D%2B%5Csum_%7Bt%3D1%7D%5E%7B%5Cinfty%7D%5Cleft%28%5Cgamma_%7Bt%2Bj%7D%2B%5Cgamma_%7Bt-j%7D%5Cright%29+W_%7Bt%7D+%5C%5C+%26%3D%5Cgamma_%7B0%7D+W_%7Bj%7D%3D%5Csigma%5E%7B2%7D+W_%7Bj%7D+%5C%5C+%5Cxi_%7B0%7D+%26%3D%5Cleft%28M_%7B0%7D+%5Cgamma_%7B0%7D%5Cright%29+W_%7B0%7D%2B%5Csum_%7Bt%3D1%7D%5E%7B%5Cinfty%7D%5Cleft%28%5Cgamma_%7Bt%2B0%7D%2B%5Cgamma_%7Bt-0%7D%5Cright%29+W_%7Bt%7D+%5C%5C+%26%3DM_%7B0%7D+%5Cgamma_%7B0%7D+W_%7B0%7D%3D%5Csigma%5E%7B2%7D+M_%7B0%7D+W_%7B0%7D+%5Cend%7Baligned%7D%5C%5C) 

所以根据前面的定理，有依分布收敛的结果。

### （2）AR(2) 模型实例

令 ![[公式]](https://www.zhihu.com/equation?tex=A%28z%29%3D%5Cleft%281-%5Crho+e%5E%7Bi+%5Ctheta%7D+%5Ccdot+z%5Cright%29%5Cleft%281-%5Crho+e%5E%7B-i+%5Ctheta%7D+%5Ccdot+z%5Cright%29) ，考虑如下 AR(2) 模型

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D+%26%3D%5Cvarepsilon_%7Bt%7D+%5C%5C+X_%7Bt%7D+%26%3D2+%5Crho+%5Ccos+%5Ctheta+X_%7Bt-1%7D-%5Crho%5E%7B2%7D+X_%7Bt-2%7D%2B%5Cvarepsilon_%7Bt%7D+%5Cend%7Baligned%7D%5C%5C) 

为模拟方便，假定 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D+%5Ctext+%7B+iid+%7D+%5Csim+N%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29) 

模拟得到理论的自协方差函数及其估计量如下图。

![img](https://pic1.zhimg.com/80/v2-67eca0c6957e6d7deed8672280f61080_720w.jpg)

估计量的收敛速度难以在理论上推导出来，所以采用模拟的方法，模拟 1000 次，得到 1000 个自协方差函数的估计量，然后计算标准差（称为标准误差）。

![img](https://pic2.zhimg.com/80/v2-203e2bdc5ac51588970e8523472dbaa5_720w.jpg)

## 4.3 白噪声检验

我们将模型建好后，最后都要取残差序列，检验它是否为白噪声。

### （一）卡方检验

根据推论， ![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Chat%7B%5Crho%7D_%7B1%7D%2C+%5Chat%7B%5Crho%7D_%7B2%7D%2C+%5Cldots%2C+%5Chat%7B%5Crho%7D_%7Bm%7D%5Cright%29) 服从多元标准正态分布。构造卡方检验统计量如下：

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cchi%7D%5E%7B2%7D%28m%29+%5Ctriangleq+N%5Cleft%28%5Chat%7B%5Crho%7D_%7B1%7D%5E%7B2%7D%2B%5Chat%7B%5Crho%7D_%7B2%7D%5E%7B2%7D%2B%5Ccdots%2B%5Chat%7B%5Crho%7D_%7Bm%7D%5E%7B2%7D%5Cright%29%5C%5C) 

在白噪声假设成立的条件下，该统计量近似自由度为 m 的卡方分布。

其中 m 并不是越大越好，因为自相关系数本身会很快趋于 0（即使不是白噪声），实际应用中取 m 不超过 10。

**注意**：这个自相关系数是残差序列的，而不是原来的 AR、MA 等序列。

### （二）样本自相关置信区间检验法

考察单个自相关系数，它可以看做是来自一元正态总体的样本，所以

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BPr%7D%5Cleft%28%5Csqrt%7BN%7D%5Cleft%7C%5Chat%7B%5Crho%7D_%7Bk%7D%5Cright%7C%3E1.96%5Cright%29+%5Capprox+0.05%5C%5C) 

如果有超过 5% 的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7C%5Chat%7B%5Crho%7D_%7Bj%7D%5Cright%7C+%5Cgeq+1.96+%2F+%5Csqrt%7Bn%7D) ，就否定白噪声假设。

同样地，m 不能取太大，理由与卡方检验相同。

![img](https://pic2.zhimg.com/80/v2-7d5f77944656dd8b7145a334c2118925_720w.jpg)

![img](https://pic3.zhimg.com/80/v2-9c7291cde7bfc7f5c15464d77c53953a_720w.jpg)

![img](https://pic1.zhimg.com/80/v2-1dbde73b0bef76d860b039e85ab5f0dc_720w.jpg)

- 对标准白噪声检验一般可以成功
- 对 MA(1) 序列如果取 m = 20 则很可能不成功，因为一般只有第一个超出界限
- 对 AR(2) 序列检验一般成功，其自协方差函数不截尾

## 第五章 时间序列的预报

简单定义一下最佳线性预测。设 Y 是你要预测的，现在已知的是 X，X 是一组向量数据。如果存在向量 ![[公式]](https://www.zhihu.com/equation?tex=a) ，对任意向量 ![[公式]](https://www.zhihu.com/equation?tex=b) 使得

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28Y-%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D+%5Cleq+%5Cmathrm%7BE%7D%5Cleft%28Y-%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D%5C%5C) 

则称 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D) 为最佳线性预测，记作 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D%3DL%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3D%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D) 

其几何意义如下图，在 X 张成的平面中寻找一个向量，使得它离 Y 的距离最小（也就是残量与 Y 垂直）

![img](https://pic2.zhimg.com/80/v2-e2a5155e76fc4095ee99154b72f61c2d_720w.jpg)

> 当然，也可以用绝对值或其他方式来度量距离，那就是另一套理论了

如果 Y 和 X 的均值不是 0，可以作如下变换

![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3DL%28Y-b+%5Cmid+%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%2Bb%5C%5C) 

所以之后总假设序列的均值为 0 。

用 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma%3D%5Cmathrm%7BE%7D%5Cleft%28%5Cmathrm%7BXX%7D%5E%7BT%7D%5Cright%29) 表示 X 的自协方差矩阵， ![[公式]](https://www.zhihu.com/equation?tex=+%5CSigma_%7B%5Cmathbf%7BX%7D+Y%7D%3D%5Cmathrm%7BE%7D%28%5Cmathbf%7BX%7D+Y%29) 表示 X 和 Y 的协方差向量。

### （一）性质一

如果 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma+%5Cmathbf%7Ba%7D%3D%5CSigma_%7B%5Cmathbf%7BX%7D+Y%7D) ，那么最佳线性预测为 ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3D%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D) ，并且

![[公式]](https://www.zhihu.com/equation?tex=E%28Y-L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%29%5E%7B2%7D%3DE+Y%5E%7B2%7D-E%5BL%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%5D%5E%7B2%7D%3DE+Y%5E%7B2%7D-%5Cmathbf%7Ba%7D%5E%7BT%7D+%5CGamma+%5Cmathbf%7Ba%7D%5C%5C) 

在 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma) 和 ![[公式]](https://www.zhihu.com/equation?tex=+%5CSigma_%7B%5Cmathbf%7BX%7D+Y%7D)已知时，以 ![[公式]](https://www.zhihu.com/equation?tex=a) 为系数e 的![[公式]](https://www.zhihu.com/equation?tex=%5CGamma+%5Cmathbf%7Ba%7D%3D%5CSigma_%7B%5Cmathbf%7BX%7D+Y%7D) 被称为**预测方程**。（**背熟！！！**）

它可以通过几何意义导出，考虑下图

![img](https://pic4.zhimg.com/80/v2-e842f761b55b9d4933f34572f70884e3_720w.jpg)

其中内积 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%5Clangle+%7BY+-+%7Ba%5ET%7DX%2CX%7D+%5Cright%5Crangle++%3D+0%5C%5D) ，而在这里内积就是乘积的数学期望。而性质一中那个式子，从图上看就是勾股定理！（帮助建立直观概念）

**具体证明**：

首先证明最佳线性预测，类似这种证明套路都是加一项减一项，然后证明交叉项为 0 。这里交叉项为

![[公式]](https://www.zhihu.com/equation?tex=%5C%5BE%5Cleft%5B+%7B%5Cleft%28+%7B%7B%7B%5Cbf%7Ba%7D%7D%5ET%7D+-+%7B%7B%5Cbf%7Bb%7D%7D%5ET%7D%7D+%5Cright%29%7B%5Cbf%7BX%7D%7D%5Cleft%28+%7BY+-+%7B%7B%5Cbf%7Ba%7D%7D%5ET%7D%7B%5Cbf%7BX%7D%7D%7D+%5Cright%29%7D+%5D%5Cright.+%3D+%5Cleft%28+%7B%7Ba%5ET%7D+-+%7Bb%5ET%7D%7D+%5Cright%29%5Cleft%5B+%7BE%28XY%29+-+E%5Cleft%28+%7BX%7BX%5ET%7D%7D+%5Cright%29a%7D+%5Cright%5D%5C%5C%5C%5D) 

根据预测方程可知交叉项为 0 。

同样地，利用预测方程，对均方误差进行整理

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+E%5BY-L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%5D%5E%7B2%7D%3DE%5Cleft%28Y-%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D+%5C%5C+%3D%26+E+Y%5E%7B2%7D%2B%5Cmathbf%7Ba%7D%5E%7BT%7D+E%5Cleft%28%5Cmathbf%7BX%7D+%5Cmathbf%7BX%7D%5E%7BT%7D%5Cright%29+%5Cmathbf%7Ba%7D-2+%5Cmathbf%7Ba%7D%5E%7BT%7D+E%28%5Cmathbf%7BX%7D+Y%29+%5C%5C+%3D%26+E+Y%5E%7B2%7D%2B%5Cmathbf%7Ba%7D%5E%7BT%7D+%5CGamma+%5Cmathbf%7Ba%7D-2+%5Cmathbf%7Ba%7D%5E%7BT%7D+%5CGamma+%5Cmathbf%7Ba%7D+%5C%5C+%3D%26+E+Y%5E%7B2%7D-%5Cmathbf%7Ba%7D%5E%7BT%7D+%5CGamma+%5Cmathbf%7Ba%7D+%5Cend%7Baligned%7D%5C%5C) 

第三个等号用到预测方程。

后续还将给出一共 9 条性质。



## 5.1 最佳线性预测的基本性质

一共有十条性质，下面是其直观上的说明：

- **性质1**：满足预测方程的就是最佳线性预测，并且给出误差估计式
- **性质2**：说明预测方程的解一定存在，当自协方差矩阵可逆时，与用极大无关组来预测等价
- **性质3**：尽管预测方程解可能不唯一，但最佳线性预测在几乎处处的意义下是唯一的
- **性质4**：考察两种特殊情况（ Y 在 X 空间中以及 Y 垂直 X 空间）的最佳线性预测
- **性质5**：最佳线性预测关于 Y 是线性运算
- **性质6**：用不相关的 X,Z 来预测 Y，相当于用 X 和 Z 分别预测 Y 再相加
- **性质7**：最佳线性预测向量满足预测方程
- **性质8**：如果 X 包含更多信息，那么预测效果更好
- **性质9**：非零均值的最佳线性预测定义的确是“最佳”的
- **性质10**：如果 X,Y 互相能表示，那么用 X 来预测 Z 等价于用 Y 来预测 Z

### （二）性质二

此条性质表明预测方程解的存在性。

首先当![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5CGamma++%3D+%7B%5Crm%7BE%7D%7D%5Cleft%28+%7B%7B%5Crm%7BX%7D%7D%7B%7B%5Crm%7BX%7D%7D%5ET%7D%7D+%5Cright%29%5C%5D)可逆时，显然有解 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D%3D%5CGamma%5E%7B-1%7D+E%28%5Cmathbf%7BX%7D+Y%29) 使得 ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3D%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D) 。下面说明不可逆情形，此时将 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5CGamma++%3D+%7B%5Crm%7BE%7D%7D%5Cleft%28+%7B%7B%5Crm%7BX%7D%7D%7B%7B%5Crm%7BX%7D%7D%5ET%7D%7D+%5Cright%29%5C%5D) 用正交矩阵 ![[公式]](https://www.zhihu.com/equation?tex=A) 来对角化得到

![[公式]](https://www.zhihu.com/equation?tex=A+%5CGamma+A%5E%7BT%7D%3D%5Coperatorname%7Bdiag%7D%5Cleft%28%5Clambda_%7B1%7D%2C+%5Clambda_%7B2%7D%2C+%5Ccdots%2C+%5Clambda_%7Br%7D%2C+0%2C+%5Cldots%2C+0%5Cright%29%2C+%5Cquad+%5Clambda_%7Bj%7D%3E0%2C+j%3D1%2C+%5Cldots%2C+r%5C%5C) 

考虑到 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5BA%5CGamma+%7BA%5ET%7D%7B%5Crm%7B+%3D+E%7D%7D%7B%5Cleft%28+%7BAX%7D+%5Cright%29%5E2%7D%5C%5D) ，令 

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Cbf%7BZ%7D%7D+%3D+A%7B%5Cbf%7BX%7D%7D+%3D+%7B%5Cleft%28+%7B%7BZ_1%7D%2C%7BZ_2%7D%2C+%5Cldots+%2C%7BZ_n%7D%7D+%5Cright%29%5ET%7D%7B%5Crm%7B+%3D+%7D%7D%7B%5Cleft%28+%7B%7BZ_1%7D%2C%7BZ_2%7D%2C+%5Cldots+%2C%7BZ_r%7D%2C0%2C+%5Cldots+%2C0%7D+%5Cright%29%5ET%7D%5C%5C%5C%5D) 

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cxi++%3D+%7B%5Cleft%28+%7B%7BZ_1%7D%2C%7BZ_2%7D%2C+%5Cldots+%2C%7BZ_r%7D%7D+%5Cright%29%5ET%7D%5C%5C%5C%5D) 

> ![[公式]](https://www.zhihu.com/equation?tex=A+%5CGamma+A%5E%7BT%7D) 为 ![[公式]](https://www.zhihu.com/equation?tex=%7B%5Cbf%7BZ%7D%7D) 的自协方差矩阵， ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_i) 为 ![[公式]](https://www.zhihu.com/equation?tex=Z_i) 平方的期望，为 0 说明 ![[公式]](https://www.zhihu.com/equation?tex=Z_i) 几乎处处为 0
>  ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi++) 相当于极大线性无关子组

![[公式]](https://www.zhihu.com/equation?tex=%5Cxi++) 的自协方差矩阵正定，由对于 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi++) 的预测方程解得

![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Calpha%7D%3D%5Cleft%5BE%5Cleft%28%5Cxi+%5Cxi%5E%7BT%7D%5Cright%29%5Cright%5D%5E%7B-1%7D+E%28%5Cxi+Y%29%5C%5C) 

用 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi++) 来预测 ![[公式]](https://www.zhihu.com/equation?tex=Y) 的最佳线性预测为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Calpha%7D%5E%7B%5Ctop%7D+%5Cboldsymbol%7B%5Cxi%7D) ，我们虽然无法直接得到 ![[公式]](https://www.zhihu.com/equation?tex=a) ，但是可以说明

![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3DL%28Y+%5Cmid+%5Cxi%29%3D%5Cboldsymbol%7B%5Calpha%7D%5E%7BT%7D+%5Cxi%5C%5C) 

按照预测方程定义

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bccc%7D+%5Clambda_%7B1%7D+%26+%5Ccdots+%26+0+%5C%5C+%26+%5Cddots+%26+%5C%5C+0+%26+%5Ccdots+%26+%5Clambda_%7Br%7D+%5Cend%7Barray%7D%5Cright%29+%5Cboldsymbol%7B%5Calpha%7D%3DE%28%5Cboldsymbol%7B%5Cxi%7D+Y%29%5C%5C) 

> 注意这里右边的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi) 实际上就是 ![[公式]](https://www.zhihu.com/equation?tex=AX) ，最多再添几个 0

下面推导 ![[公式]](https://www.zhihu.com/equation?tex=a) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha) 的关系，比较两个预测方程，可以配凑得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+A+%5CGamma+A%5E%7BT%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Calpha+%5C%5C+0+%5Cend%7Barray%7D%5Cright%29+%26%3D%5Coperatorname%7Bdiag%7D%5Cleft%28%5Clambda_%7B1%7D%2C+%5Cldots%2C+%5Clambda_%7Br%7D%2C+0%2C+%5Cldots%2C+0%5Cright%29%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Calpha+%5C%5C+%5Cmathbf%7B0%7D+%5Cend%7Barray%7D%5Cright%29+%5C%5C+%26%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cmathrm%7BE%7D%28%5Cboldsymbol%7B%5Cxi%7D+Y%29+%5C%5C+%5Cmathbf%7B0%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cmathrm%7BE%7D%5Cleft%28%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cboldsymbol%7B%5Cxi%7D+%5C%5C+%5Cmathbf%7B0%7D+%5Cend%7Barray%7D%5Cright%29+Y%5Cright%29+%5C%5C+%26%3D%5Cmathrm%7BE%7D%28%5Cmathbf%7BZ%7D+Y%29%3D%5Cmathrm%7BE%7D%28A+%5Cmathbf%7BX%7D+Y%29%3DA+%5Cmathrm%7BE%7D%28%5Cmathbf%7BX%7D+Y%29%3DA+%5CSigma_%7B%5Cmathbf%7BX%7D+Y%7D+%5Cend%7Baligned%7D%5C%5C) 

然后左右同乘 A 的转置，就得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D%3DA%5E%7BT%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Calpha+%5C%5C+%5Cmathbf%7B0%7D+%5Cend%7Barray%7D%5Cright%29) ，它满足 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma+%5Cmathbf%7Ba%7D%3D%5CSigma_%7B%5Cmathbf%7BX%7D+Y%7D) ，根据性质1，满足预测方程的为最佳线性预测，所以

![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3D%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%3D%5Cleft%28%5Calpha%5E%7BT%7D%2C+0%2C+%5Cldots%2C+0%5Cright%29+A+%5Cmathbf%7BX%7D%3D%5Calpha%5E%7BT%7D+%5Cxi%5C%5C) 

### （三）性质三

> 尽管预测方程解可能不唯一，但最佳线性预测在几乎处处的意义下是唯一的

**证明**：设 a 和 b 都是解，那么它们都是最佳线性预测，根据性质一的证明过程有

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28Y-%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D%3D%5Cmathrm%7BE%7D%5Cleft%28Y-%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D%2B%5Cmathrm%7BE%7D%5Cleft%28%28%5Cmathbf%7Ba%7D-%5Cmathbf%7Bb%7D%29%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D%5C%5C%5Cmathrm%7BE%7D%5Cleft%28Y-%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D%3D%5Cmathrm%7BE%7D%5Cleft%28Y-%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D%2B%5Cmathrm%7BE%7D%5Cleft%28%28%5Cmathbf%7Ba%7D-%5Cmathbf%7Bb%7D%29%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D%5C%5C) 

就得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28%28%5Cmathrm%7Ba%7D-%5Cmathrm%7Bb%7D%29%5E%7BT%7D+%5Cmathrm%7BX%7D%5Cright%29%5E%7B2%7D%3D0) ，即 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%3D%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%2C+%5Cquad+%5Ctext+%7B+a.s.+%7D) 

### （四）性质四

- 如果 ![[公式]](https://www.zhihu.com/equation?tex=E%28%5Cmathbf%7BX%7D+Y%29%3D0) ，则 ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3D0) 
- 如果 ![[公式]](https://www.zhihu.com/equation?tex=Y%3D%5Csum_%7Bj%3D1%7D%5E%7Bm%7D+b_%7Bj%7D+X_%7Bj%7D) ，则 ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3DY) 

几何上看是很直观的，最佳线性预测就是 Y 在 X 空间中的投影，如果 Y 与 X 空间垂直，那么投影为 0 向量；如果 Y 在 X 空间中，那么投影就是 Y 本身。

**按照最佳线性预测的定义**来证：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathrm%7BE%7D%5Cleft%28Y-%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B2%7D+%26%3D%5Cmathrm%7BE%7D+Y%5E%7B2%7D%2B%5Cmathbf%7Bb%7D%5E%7BT%7D+%5CGamma+%5Cmathbf%7Bb%7D-2+%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathrm%7BE%7D%28%5Cmathbf%7BX%7D+Y%29+%5C%5C+%26%3D%5Cmathrm%7BE%7D+Y%5E%7B2%7D%2B%5Cmathbf%7Bb%7D%5E%7BT%7D+%5CGamma+%5Cmathbf%7Bb%7D+%5Cgeq+%5Cmathrm%7BE%7D+Y%5E%7B2%7D%3D%5Cmathrm%7BE%7D%28Y-0%29%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=Y%3D%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%2C+%5Cmathrm%7BE%7D%28Y-%5Cmathbf%7Bb%7D+%5Cmathbf%7BX%7D%29%5E%7B2%7D%3D0%5C%5C) 

> 把误差估计式写出来，然后说明当 Y 取给定值的时候，误差最小

从**预测方程的**角度：

- 当 ![[公式]](https://www.zhihu.com/equation?tex=E%28%5Cmathbf%7BX%7D+Y%29%3D0) 时，0 就是预测方程的解，所以最佳线性预测为 0
- 当 ![[公式]](https://www.zhihu.com/equation?tex=Y%3D%5Csum_%7Bj%3D1%7D%5E%7Bm%7D+b_%7Bj%7D+X_%7Bj%7D%3Db%5ETX) 时， ![[公式]](https://www.zhihu.com/equation?tex=E%28%5Cmathbf%7BX%7D+Y%29%3Db%5ET%5CGamma) ， ![[公式]](https://www.zhihu.com/equation?tex=b%5ET) 为预测方程的解

### （五）性质五

> 和的最佳线性预测为最佳线性预测的和

如果 ![[公式]](https://www.zhihu.com/equation?tex=Y%3D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D+b_%7Bi%7D+Y_%7Bi%7D) ，那么 ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3D%5Csum_%7Bj%3D1%7D%5E%7Bm%7D+b_%7Bj%7D+L%5Cleft%28Y_%7Bj%7D+%5Cmid+%5Cmathbf%7BX%7D%5Cright%29) 

**证明**：写出单个的预测方程 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma+%5Cmathbf%7Ba%7D_%7Bi%7D%3D%5Cmathrm%7BE%7D%5Cleft%28%5Cmathbf%7BX%7D+Y_%7Bi%7D%5Cright%29) ，然后取 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D%3D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D+b_%7Bi%7D+%5Cmathbf%7Ba%7D_%7Bi%7D) ，说明 a 满足 Y 的预测方程如下：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5CGamma+%5Cmathbf%7Ba%7D+%26%3D%5CGamma%5Cleft%28%5Csum_%7Bi%3D1%7D%5E%7Bm%7D+b_%7Bi%7D+%5Cmathbf%7Ba%7D_%7Bi%7D%5Cright%29%3D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D+b_%7Bi%7D%5Cleft%28%5CGamma+%5Cmathbf%7Ba%7D_%7Bi%7D%5Cright%29%3D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D+b_%7Bi%7D+%5Cmathrm%7BE%7D%5Cleft%28%5Cmathbf%7BX%7D+Y_%7Bi%7D%5Cright%29+%5C%5C+%26%3D%5Cmathrm%7BE%7D%5Cleft%28%5Cmathbf%7BX%7D+%5Csum_%7Bi%3D1%7D%5E%7Bm%7D+b_%7Bi%7D+Y_%7Bi%7D%5Cright%29%3D%5Cmathrm%7BE%7D%28%5Cmathbf%7BX%7D+Y%29+%5Cend%7Baligned%7D%5C%5C) 

> 主要利用期望和矩阵运算的线性性质、

所以根据性质一，满足预测方程就是最佳线性预测

![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3D%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%3D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D+b_%7Bi%7D+%5Cmathbf%7Ba%7D_%7Bi%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%3D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D+b_%7Bi%7D+L%5Cleft%28Y_%7Bi%7D+%5Cmid+%5Cmathbf%7BX%7D%5Cright%29%5C%5C) 

### （六）性质六

> 用不相关的 X,Z 来预测 Y，相当于用 X 和 Z 分别预测 Y 再相加

设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D%3D%5Cleft%28X_%7B1%7D%2C+X_%7B2%7D%2C+%5Ccdots%2C+X_%7Bn%7D%5Cright%29%5E%7BT%7D) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BZ%7D%3D%5Cleft%28Z_%7B1%7D%2C+Z_%7B2%7D%2C+%5Ccdots%2C+Z_%7Bm%7D%5Cright%29%5E%7BT%7D) ，两者不相关，那么

![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%2C+%5Cmathbf%7BZ%7D%29%3DL%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%2BL%28Y+%5Cmid+%5Cmathbf%7BZ%7D%29%5C%5C) 

> 先把右边的预测方程的解表示出来，由此组合得到 X,Z 整体的预测方程的解

**证明**：记 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+%5Cmathrm%7BX%7D+%5C%5C+%5Cmathrm%7BZ%7D+%5Cend%7Barray%7D%5Cright%29) ， ![[公式]](https://www.zhihu.com/equation?tex=%5CSigma_%7BX+X%7D%3D%5Cmathrm%7BE%7D%5Cleft%28%5Cmathrm%7BXX%7D%5E%7BT%7D%5Cright%29%2C+%5CSigma_%7B%5Cmathrm%7BZZ%7D%7D%3D%5Cmathrm%7BE%7D%5Cleft%28%5Cmathrm%7BZZ%7D%5E%7BT%7D%5Cright%29) ，因为 X,Z 不相关，所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi) 的自协方差矩阵分块对角：

![[公式]](https://www.zhihu.com/equation?tex=%5CSigma+%5Ctriangleq+%5Cmathrm%7BE%7D%5Cleft%28%5Cxi+%5Cxi%5E%7BT%7D%5Cright%29%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bcc%7D+%5CSigma_%7BX+X%7D+%26+0+%5C%5C+0+%26+%5CSigma_%7BZ+Z%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

设 a,b 分别为 X,Z 的预测方程的解，取 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bc%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+%5Cmathbf%7Ba%7D+%5C%5C+%5Cmathbf%7Bb%7D+%5Cend%7Barray%7D%5Cright%29) ，那么

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5CSigma+%5Cmathbf%7Bc%7D+%26%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5CSigma_%7BX+X%7D+%5Cmathbf%7Ba%7D+%5C%5C+%5CSigma_%7BZ+Z%7D+%5Cmathbf%7Bb%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+E%28%5Cmathbf%7BX%7D+Y%29+%5C%5C+E%28%5Cmathbf%7BZ%7D+Y%29+%5Cend%7Barray%7D%5Cright%29+%5C%5C+%26%3DE%5Cleft%28%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cmathbf%7BX%7D+%5C%5C+%5Cmathbf%7BZ%7D+%5Cend%7Barray%7D%5Cright%29+Y%5Cright%29%3DE%28%5Cxi+Y%29+%5Cend%7Baligned%7D%5C%5C) 

因此

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+L%28Y+%5Cmid+%5Cmathbf%7BX%7D%2C+%5Cmathbf%7BZ%7D%29+%26%3DL%28Y+%5Cmid+%5Cboldsymbol%7B%5Cxi%7D%29%3D%5Cmathbf%7Bc%7D%5E%7BT%7D+%5Cboldsymbol%7B%5Cxi%7D+%5C%5C+%26%3D%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%2B%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathbf%7BZ%7D%3DL%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%2BL%28Y+%5Cmid+%5Cmathbf%7BZ%7D%29+%5Cend%7Baligned%7D%5C%5C) 

### （七）性质七

> 最佳线性预测向量满足预测方程

设 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctilde%7BY%7D%3D%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathbf%7BX%7D) 是 ![[公式]](https://www.zhihu.com/equation?tex=X) 的组合，那么它为最佳线性预测的充要条件为

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28X_%7Bj%7D%28Y-%5Ctilde%7BY%7D%29%5Cright%29%3D0%2C1+%5Cleq+j+%5Cleq+n%5C%5C) 

> 误差项与 X 中 n 个线性无关向量垂直，所以与 X 空间垂直.

即

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Cmathrm%7BE%7D%5Cleft%28%5Cmathrm%7BX%7D%5Cleft%28Y-%5Cmathrm%7Bb%7D%5E%7BT%7D+%5Cmathrm%7BX%7D%5Cright%29%5Cright%29%3D0+%5C%5C+%5Cmathrm%7BE%7D%5Cleft%28%5Cmathrm%7BX%7D%5Cleft%28Y-%5Cmathrm%7Bb%7D%5E%7BT%7D+%5Cmathrm%7BX%7D%5Cright%29%5Cright%29%3D%5Cmathrm%7BE%7D%28%5Cmathrm%7BX%7D+Y%29-%5CGamma+%5Cmathrm%7Bb%7D+%5Cend%7Barray%7D%5C%5C) 

即 ![[公式]](https://www.zhihu.com/equation?tex=b) 为预测方程的解。

**证明**：由性质一知充分性，下面说明已知最佳线性预测，可得满足预测方程。

假设 b 为已知的最佳预测向量，根据性质二，预测方程一定有解 a，再根据性质三的唯一性知

![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3D%5Cmathbf%7Ba%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%3D%5Cmathbf%7Bb%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5C%5C) 

两边同乘 X 转置然后取期望得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D%5E%7BT%7D+%5CGamma%3D%5Cmathbf%7Bb%7D%5E%7BT%7D+%5CGamma) ，由 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma+%5Cmathbf%7Ba%7D%3D%5Cmathrm%7BE%7D%28%5Cmathbf%7BX%7D+Y%29) 可得 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma+%5Cmathbf%7Bb%7D%3D%5Cmathrm%7BE%7D%28%5Cmathbf%7BX%7D+Y%29) 

### （八）性质八

如果

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Chat%7BY%7D%3DL%5Cleft%28Y+%5Cmid+X_%7B1%7D%2C+X_%7B2%7D%2C+%5Ccdots%2C+X_%7Bn%7D%5Cright%29+%5C%5C+%5Ctilde%7BY%7D%3DL%5Cleft%28Y+%5Cmid+X_%7B1%7D%2C+X_%7B2%7D%2C+%5Ccdots%2C+X_%7Bn-1%7D%5Cright%29+%5Cend%7Barray%7D%5C%5C) 

那么 ![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28%5Chat%7BY%7D+%5Cmid+X_%7B1%7D%2C+X_%7B2%7D%2C+%5Ccdots%2C+X_%7Bn-1%7D%5Cright%29%3D%5Ctilde%7BY%7D) 

> 把 Y 先投影到小空间再投影到大空间，与先投影到大空间再投影到小空间，元素一样

且 ![[公式]](https://www.zhihu.com/equation?tex=E%28Y-%5Chat%7BY%7D%29%5E%7B2%7D+%5Cleq+E%28Y-%5Ctilde%7BY%7D%29%5E%7B2%7D) 

> 如果 X 包含更多信息，那么预测效果更好

回顾最佳线性预测的两个条件：

- 在 X 的空间中
- 误差项与 X 空间垂直

首先 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctilde%7BY%7D) 显然在 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+X_%7B2%7D%2C+%5Ccdots%2C+X_%7Bn-1%7D) （因为它本身是 Y 在 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+X_%7B2%7D%2C+%5Ccdots%2C+X_%7Bn-1%7D) 上的投影），然后构造误差项 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D-%5Ctilde%7BY%7D) ，根据已知条件 ![[公式]](https://www.zhihu.com/equation?tex=Y-%5Chat%7BY%7D%2C+Y-%5Ctilde%7BY%7D) 都与 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn-1%7D) 正交，所以两者之差 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D-%5Ctilde%7BY%7D) 也与 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn-1%7D) 正交，进而证明了

![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28%5Chat%7BY%7D+%5Cmid+X_%7B1%7D%2C+X_%7B2%7D%2C+%5Ccdots%2C+X_%7Bn-1%7D%5Cright%29%3D%5Ctilde%7BY%7D%5C%5C) 

证明方差的不等式，对右边加一项减一项，然后展开，交叉项为 

![[公式]](https://www.zhihu.com/equation?tex=%5C%5BE%5Cleft%28+%7BY+-+%5Chat+Y%7D+%5Cright%29%5Cleft%28+%7B%5Chat+Y+-+%5Ctilde+Y%7D+%5Cright%29+%3D+0%5C%5C%5C%5D) 

因为 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%28+%7B%5Chat+Y+-+%5Ctilde+Y%7D+%5Cright%29%5C%5D) 属于 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn%7D) 空间，而 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%28+%7BY+-+%5Chat+Y%7D+%5Cright%29%5C%5D) 与 ![[公式]](https://www.zhihu.com/equation?tex=X_%7B1%7D%2C+%5Cldots%2C+X_%7Bn%7D) 正交.

###  （九）性质九

现在考虑 Y 和 X 都是非零均值的，那么很自然的最佳线性预测的定义为

![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3Db%2BL%28Y-b+%5Cmid+%5Cmathbf%7BX%7D-%5Cmu%29%5C%5C) 

现在说明这样定义的最佳线性预测是有意义的。

事实上对任意 ![[公式]](https://www.zhihu.com/equation?tex=c_%7B0%7D+%5Cin+%5Cmathbb%7BR%7D%2C+%5Cmathbf%7Bc%7D+%5Cin+%5Cmathbb%7BR%7D%5E%7Bn%7D) ，上面定义的最佳预测满足

![[公式]](https://www.zhihu.com/equation?tex=E%5BY-L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%5D%5E%7B2%7D+%5Cleq+E%5Cleft%5BY-%5Cleft%28c_%7B0%7D%2B%5Cmathbf%7Bc%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5Cright%5D%5E%7B2%7D%5C%5C) 

> 也就是说这样的“最佳线性预测”的确是最佳的

**证明**：假设有最佳预测向量 a 使得 ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3Db%2B%5Cmathbf%7Ba%7D%5E%7BT%7D%28%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29) ，因为已经中心化了，根据前面的性质 a 其实是一定有的。

计算不等式的右边 ![[公式]](https://www.zhihu.com/equation?tex=L%28Z+%5Cmid+%5Cmathbf%7BX%7D%29%3DL%28Z+%5Cmid+%5Cmathbf%7BY%7D%29) 

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+%5Cmathrm%7BE%7D%5Cleft%5C%7BY-%7Bc%7D_%7B0%7D-%5Cmathbf%7Bc%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%5C%7D%5E%7B2%7D+%5C%5C+%3D%26+%5Cmathrm%7BE%7D%5Cleft%5C%7BY-b-%5Cmathbf%7Ba%7D%5E%7BT%7D%28%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%2Bb%2B%5Cmathbf%7Ba%7D%5E%7BT%7D%28%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%5Cright.%5C%5C+%26%5Cleft.-%5Cleft%5Bc_%7B0%7D%2B%5Cmathbf%7Bc%7D%5E%7BT%7D+%5Cboldsymbol%7B%5Cmu%7D%2B%5Cmathbf%7Bc%7D%5E%7BT%7D%28%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%5Cright%5D%5Cright%5C%7D%5E%7B2%7D+%5C%5C+%3D%26+%5Cmathrm%7BE%7D%5Cleft%5C%7B%5Cleft%5BY-b-%5Cmathbf%7Ba%7D%5E%7BT%7D%28%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%5Cright%5D%2B%5Cleft%28b-c_%7B0%7D-%5Cmathbf%7Bc%7D%5E%7BT%7D+%5Cboldsymbol%7B%5Cmu%7D%5Cright%29%2B%28%5Cmathbf%7Ba%7D-%5Cmathbf%7Bc%7D%29%5E%7BT%7D%28%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%5Cright%5C%7D+%5C%5C+%3D%26+%5Cmathrm%7BE%7D%5Cleft%5BY-b-%5Cmathbf%7Ba%7D%5E%7BT%7D%28%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%5Cright%5D%5E%7B2%7D%2B%5Cleft%28b-c_%7B0%7D-%5Cmathbf%7Bc%7D%5E%7BT%7D+%5Cboldsymbol%7B%5Cmu%7D%5Cright%29%5E%7B2%7D%2B%28%5Cmathbf%7Ba%7D-%5Cmathbf%7Bc%7D%29%5E%7BT%7D+%5CGamma%28%5Cmathbf%7Ba%7D-%5Cmathbf%7Bc%7D%29+%5C%5C+%5Cgeq+%26+%5Cmathrm%7BE%7D%5Cleft%5BY-b-%5Cmathbf%7Ba%7D%5E%7BT%7D%28%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%5Cright%5D%5E%7B2%7D%3D%5Cmathrm%7BE%7D%5BY-L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%5D%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

即加上一个最佳预测，再减去，第二个等号将其写为 3 部分。展开原本有 6 项，但交叉项全都为 0，所以只剩下三个平方和。

> 证明交叉项为 0，其中两个是与常数有关的，因为中心化了，自然为 0。另外一项类似性质一的证明，利用 a 满足预测方程的条件。

### （十）性质十

> 如果 X,Y 互相能表示，那么用 X 来预测 Z 等价于用 Y 来预测 Z

设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D%3DA+%5Cmathbf%7BY%7D%2C+%5Cmathbf%7BY%7D%3DB+%5Cmathbf%7BX%7D) ，那么 ![[公式]](https://www.zhihu.com/equation?tex=L%28Z+%5Cmid+%5Cmathbf%7BX%7D%29%3DL%28Z+%5Cmid+%5Cmathbf%7BY%7D%29) 

## 拓展：Hilbert空间中的投影

> 涉及这一部分内容是为了之后 wold 定理引入方便，并且推广到无穷时间序列的预测情形

Hilbert空间就是全体方差有限的随机变量构成的空间。我们原本是用 n 个 X 来预测 Y，现在更一般了，考虑用 Hilbert 空间的一个小的闭子区间来预测 Y，那么最佳预测是什么呢？根据之前介绍的集合意义，最佳预测应该就是 Y 在这个闭子区间的投影。

**定理** 设 H 为Hilbert空间的闭子区间，那么 H 中有唯一的 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D) 使得

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%28Y-%5Chat%7BY%7D%29%5E%7B2%7D%3D%5Cinf+_%7B%5Cxi+%5Cin+H%7D+%5Cmathrm%7BE%7D%28Y-%5Cxi%29%5E%7B2%7D%5C%5C) 

记 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D%3D+P_%7BH%7D%28Y%29) ，称 ![[公式]](https://www.zhihu.com/equation?tex=P_H) 为投影算子

> 该定理保证了“投影”的存在性和唯一性

**定义** 如果对于 H 中的任意随机变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi) ，有 ![[公式]](https://www.zhihu.com/equation?tex=E%28Y+%5Cxi%29%3D0) ，称 Y 垂直于 H.

**存在性证明**：

根据下确界的定义，取 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bn%7D+%5Cin+H) 使得

![[公式]](https://www.zhihu.com/equation?tex=d%3D%5Cinf+_%7B%5Cxi+%5Cin+H%7D+%5Cmathrm%7BE%7D%28Y-%5Cxi%29%5E%7B2%7D%3D%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+%5Cmathrm%7BE%7D%5Cleft%28Y-Y_%7Bn%7D%5Cright%29%5E%7B2%7D%5C%5C) 

由于 H 是线性空间，所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28Y_%7Bn%7D%2BY_%7Bm%7D%5Cright%29+%2F+2+%5Cin+H) 

> 因为 ![[公式]](https://www.zhihu.com/equation?tex=Y_n) 越来越靠近 ![[公式]](https://www.zhihu.com/equation?tex=Y) ，所以 ![[公式]](https://www.zhihu.com/equation?tex=Y_n%2CY_m) 也很靠近，证明如下

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+E%7B%5Cleft%28+%7B%7BY_n%7D+-+%7BY_m%7D%7D+%5Cright%29%5E2%7D+%3D+E%7B%5Cleft%5B+%7B%5Cleft%28+%7B%7BY_n%7D+-+Y%7D+%5Cright%29+-+%5Cleft%28+%7B%7BY_m%7D+-+Y%7D+%5Cright%29%7D+%5Cright%5D%5E2%7D%5C%5C++%2B+E%7B%5Cleft%5B+%7B%5Cleft%28+%7B%7BY_n%7D+-+Y%7D+%5Cright%29+%2B+%5Cleft%28+%7B%7BY_m%7D+-+Y%7D+%5Cright%29%7D+%5Cright%5D%5E2%7D+-+E%7B%5Cleft%5B+%7B%5Cleft%28+%7B%7BY_n%7D+%2B+%7BY_m%7D%7D+%5Cright%29+-+2Y%7D+%5Cright%5D%5E2%7D%5C%5C++%3D+2E%7B%5Cleft%28+%7B%7BY_n%7D+-+Y%7D+%5Cright%29%5E2%7D+%2B+2E%7B%5Cleft%28+%7B%7BY_m%7D+-+Y%7D+%5Cright%29%5E2%7D+-+4E%7B%5Cleft%5B+%7B%5Cleft%28+%7B%7BY_n%7D+%2B+%7BY_m%7D%7D+%5Cright%29%2F2+-+Y%7D+%5Cright%5D%5E2%7D%5C%5C++%5Cle+2E%7B%5Cleft%28+%7B%7BY_n%7D+-+Y%7D+%5Cright%29%5E2%7D+%2B+2E%7B%5Cleft%28+%7B%7BY_m%7D+-+Y%7D+%5Cright%29%5E2%7D+-+4d%5C%5C++%5Cto+2d+%2B+2d+-+4d+%3D+0+%5Cend%7Barray%7D%5C%5C%5C%5D) 

所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BY_%7Bn%7D%5Cright%5C%7D) 是 ![[公式]](https://www.zhihu.com/equation?tex=H) 中的完备列（类似于柯西序列），其极限存在，有 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D+%5Cin+H) 使得 ![[公式]](https://www.zhihu.com/equation?tex=Y) 均方收敛到它。根据内积的连续性有

![[公式]](https://www.zhihu.com/equation?tex=E%28Y-%5Chat%7BY%7D%29%5E%7B2%7D%3D%5Clim+_%7Bn+%5Crightarrow+%5Cinfty%7D+E%5Cleft%28Y-Y_%7Bn%7D%5Cright%29%5E%7B2%7D%3Dd%5C%5C) 

**唯一性证明**：

如果有另一个 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cxi%7D+%5Cin+H) 也满足定理中的式子，那么仿照存在性证明的方法

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+E%7B%28%5Chat+Y+-+%5Chat+%5Cxi+%29%5E2%7D+%3D+E%7B%5B%28%5Chat+Y+-+Y%29+-+%28%5Chat+%5Cxi++-+Y%29%5D%5E2%7D+%2B+%5C%5C+E%7B%5B%28%5Chat+Y+-+Y%29+%2B+%28%5Chat+%5Cxi++-+Y%29%5D%5E2%7D+-+E%7B%5B%28%5Chat+Y+%2B+%5Chat+%5Cxi+%29+-+2Y%5D%5E2%7D%5C%5C++%3D+2E%7B%28%5Chat+Y+-+Y%29%5E2%7D+%2B+2E%7B%28%5Chat+%5Cxi++-+Y%29%5E2%7D+-+4E%7B%5B%28%5Chat+Y+%2B+%5Chat+%5Cxi+%29%2F2+-+Y%5D%5E2%7D%5C%5C++%5Cle+2d+%2B+2d+-+4d+%3D+0+%5Cend%7Barray%7D%5C%5C%5C%5D) 

所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cxi%7D%3D%5Chat%7BY%7D%2C+%5Ctext+%7B+a.s.+%7D) 

### 投影的正交性定理

> 投影等价于误差与 H 垂直

设 ![[公式]](https://www.zhihu.com/equation?tex=Y+%5Cin+L%5E%7B2%7D%2C+%5Chat%7BY%7D+%5Cin+H) ，那么 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D%3DP_%7BH%7D%28Y%29) 的充分必要条件为 ![[公式]](https://www.zhihu.com/equation?tex=%28Y-%5Chat%7BY%7D%29) 垂直 ![[公式]](https://www.zhihu.com/equation?tex=H) 

**必要性证明**：假设投影来证垂直

对 ![[公式]](https://www.zhihu.com/equation?tex=%5Cforall+%5Cxi+%5Cin+H) ，往证 ![[公式]](https://www.zhihu.com/equation?tex=a+%5Ctriangleq+E%5B%28Y-%5Chat%7BY%7D%29+%5Cxi%5D%3D0) ，其中不妨假设 ![[公式]](https://www.zhihu.com/equation?tex=E+%5Cxi%5E%7B2%7D%3D1) 

从 d 出发，利用投影的定义得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+d+%26+%5Ctriangleq+E%28Y-%5Chat%7BY%7D%29%5E%7B2%7D+%5Cleq+E%28Y-%5Chat%7BY%7D-a+%5Cxi%29%5E%7B2%7D+%5C%5C+%26%3DE%28Y-%5Chat%7BY%7D%29%5E%7B2%7D%2BE%28a+%5Cxi%29%5E%7B2%7D-2+a+E%5B%28Y-%5Chat%7BY%7D%29+%5Cxi%5D+%5C%5C+%26%3Dd%2Ba%5E%7B2%7D-2+a%5E%7B2%7D%3Dd-a%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

由此得到 a = 0.

**充分性证明**：假设垂直证投影

> 加一项减一项，利用垂直证交叉项为 0

对 ![[公式]](https://www.zhihu.com/equation?tex=%5Cforall+%5Cxi+%5Cin+H) 有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+%5Cmathrm%7BE%7D%28Y-%5Cxi%29%5E%7B2%7D%3D%5Cmathrm%7BE%7D%28Y-%5Chat%7BY%7D%2B%5Chat%7BY%7D-%5Cxi%29%5E%7B2%7D+%5C%5C+%3D%26+%5Cmathrm%7BE%7D%28Y-%5Chat%7BY%7D%29%5E%7B2%7D%2B%5Cmathrm%7BE%7D%28%5Chat%7BY%7D-%5Cxi%29%5E%7B2%7D%2B2+%5Cmathrm%7BE%7D%5B%28Y-%5Chat%7BY%7D%29%28%5Chat%7BY%7D-%5Cxi%29%5D+%5C%5C+%3D%26+%5Cmathrm%7BE%7D%28Y-%5Chat%7BY%7D%29%5E%7B2%7D%2B%5Cmathrm%7BE%7D%28%5Chat%7BY%7D-%5Cxi%29%5E%7B2%7D+%5C%5C+%5Cgeq+%26+%5Cmathrm%7BE%7D%28Y-%5Chat%7BY%7D%29%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

所以根据投影的定义得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D) 为投影

> 与之前的整合起来理解：最佳预测相当于投影，预测方程相当于垂直，这一定理就是性质七

利用这个定理，可以推广性质七至非零均值情形。

### 推广的性质七

记 ![[公式]](https://www.zhihu.com/equation?tex=L%5E%7B2%7D%28%5Cmathbf%7BX%7D%29) 为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D%3D%5Cleft%28X_%7B1%7D%2C+X_%7B2%7D%2C+%5Ccdots%2C+X_%7Bn%7D%5Cright%29%5E%7BT%7D) 和常数 1 张成的 Hilbert空间

设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Cmu%7D%3D%5Cleft%28%5Cmu_%7B1%7D%2C+%5Cmu_%7B2%7D%2C+%5Ccdots%2C+%5Cmu_%7Bn%7D%5Cright%29%5E%7BT%7D%3DE+%5Cmathbf%7BX%7D)以及 ![[公式]](https://www.zhihu.com/equation?tex=E+Y%3Db) ，那么最佳线性预测定义为

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D%3DL%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3Db%2BL%28Y-b+%5Cmid+%5Cmathbf%7BX%7D-%5Cmu%29%5C%5C%5C%5C) 

所以

![[公式]](https://www.zhihu.com/equation?tex=Y-%5Chat%7BY%7D%3D%28Y-b%29-L%28Y-b+%5Cmid+%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%5C%5C) 

利用定理，只要证明这个误差项与 Hilbert空间中的元素都垂直即可。

下面利用性质七得到：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+E%28Y-b%29-E+L%28Y-b+%5Cmid+%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%3D0+%5C%5C+E%5Cleft%5B%5Cleft%28X_%7Bi%7D-%5Cmu_%7Bi%7D%5Cright%29%28%28Y-b%29-L%28Y-b+%5Cmid+%5Cmathbf%7BX%7D-%5Cboldsymbol%7B%5Cmu%7D%29%29%3D0%5Cright.+%5Cend%7Barray%7D%5C%5C) 

> 注意：性质七需要零均值，所以这里需要配凑出零均值

因此

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+E%5B1+%5Ccdot%28Y-%5Chat%7BY%7D%29%5D%3D0+%5C%5C+E%5Cleft%5BX_%7Bi%7D%28Y-%5Chat%7BY%7D%29%5Cright%5D%3D0+%5Cend%7Barray%7D%5C%5C) 

所以根据定理， ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+%5Cmathbf%7BX%7D%29%3DP_%7BH%7D%28Y%29%3D%5Chat%7BY%7D) 

### 投影算子的性质

我们把之前介绍的十条性质有投影来重述一遍。

**定理** 设 H 和 M 是 Hilbert 的闭子区间，X,Y 为 Hilbert 空间中的元素，a,b 为常数

- ![[公式]](https://www.zhihu.com/equation?tex=L%28a+X%2Bb+Y+%5Cmid+H%29%3Da+L%28X+%5Cmid+H%29%2Bb+L%28Y+%5Cmid+H%29) 

> 投影具有线性性质
> **思路**：先说明在 H 中，然后作出误差项，证明误差项垂直 H

**证明**：设 ![[公式]](https://www.zhihu.com/equation?tex=Z%3Da+L%28X+%5Cmid+H%29%2Bb+L%28Y+%5Cmid+H%29) ，显然 Z 在 H 中，由

![[公式]](https://www.zhihu.com/equation?tex=%28a+X%2Bb+Y%29-Z%3Da%5BX-L%28X+%5Cmid+H%29%5D%2Bb%5BY-L%28Y+%5Cmid+H%29%5D%5C%5C) 

其中等式右边每一项都垂直 H，所以 ![[公式]](https://www.zhihu.com/equation?tex=%28a+X%2Bb+Y%29-Z+%5Cperp+H) 

- ![[公式]](https://www.zhihu.com/equation?tex=%5C%7CY%5C%7C%5E%7B2%7D%3D%5C%7CL%28Y+%5Cmid+H%29%5C%7C%5E%7B2%7D%2B%5C%7CY-L%28Y+%5Cmid+H%29%5C%7C%5E%7B2%7D) 

> 勾股定理
> **思路**：加上投影，减去投影，交叉项为零

 **证明**：由于 ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+H%29+%5Cin+H) 而 ![[公式]](https://www.zhihu.com/equation?tex=Y-L%28Y+%5Cmid+H%29+%5Cperp+H) 所以

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+Y%7B%5E2%7D+%3D+%7B%5Crm%7BE%7D%7D%7B%5B%28Y+-+L%28Y%5Cmid+H%29%29+%2B+L%28Y%5Cmid+H%29%5D%5E2%7D%5C%5C++%3D+%7B%5Crm%7BE%7D%7D%7B%5BY+-+L%28Y%5Cmid+H%29%5D%5E2%7D+%2B+%7B%5Crm%7BE%7D%7D%7B%5BL%28Y%5Cmid+H%29%5D%5E2%7D%5C%5C++%2B+2%7B%5Crm%7BE%7D%7D%5B%28Y+-+L%28Y%5Cmid+H%29%29L%28Y%5Cmid+H%29%5D%5C%5C++%3D+%7B%5Crm%7BE%7D%7D%7B%5BY+-+L%28Y%5Cmid+H%29%5D%5E2%7D+%2B+%7B%5Crm%7BE%7D%7D%7B%5BL%28Y%5Cmid+H%29%5D%5E2%7D%5C%5C++%3D+Y+-+L%28Y%5Cmid+H%29%7B%5E2%7D+%2B+L%28Y%5Cmid+H%29%7B%5E2%7D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

- ![[公式]](https://www.zhihu.com/equation?tex=%5C%7CL%28Y+%5Cmid+H%29%5C%7C+%5Cleq%5C%7CY%5C%7C%2C) 

> 直角边的长度比斜边短
> **思路**：利用上一条即可

- ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+H%29%3DY) 的充要条件为 ![[公式]](https://www.zhihu.com/equation?tex=Y+%5Cin+H) 

> 投影为自身，说明自身在 H 中
> **思路**：如果 Y 在 H 中，那么误差项为 0 与任何元素正交，满足投影的两个条件；如果投影为自身，根据投影定义，Y 在 H 中.

- ![[公式]](https://www.zhihu.com/equation?tex=Y) 垂直 ![[公式]](https://www.zhihu.com/equation?tex=H) 等价于 ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+H%29%3D0) 

> 投影为 0 等价于垂直
> **思路**：如果 Y 垂直 H ，首先 0 肯定在 H 中，并且误差项就是 Y，垂直 H，所以 0 是投影；如果投影为 0，根据定义应该有误差项 Y 垂直 H.

- 如果 H 是 M 的子空间，则 ![[公式]](https://www.zhihu.com/equation?tex=P_%7BH%7D+P_%7BM%7D%3DP_%7BM%7D+P_%7BH%7D%3DP_%7BH%7D) ，且

![[公式]](https://www.zhihu.com/equation?tex=%5C%7CY-L%28Y+%5Cmid+M%29%5C%7C+%5Cleq%5C%7CY-L%28Y+%5Cmid+H%29%5C%7C%5C%5C) 

> 先投影到大的空间与先投影到小的空间，最后结果一样，等于直接投影到小空间
> 大的空间预测效果好

**证明**：设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi%3DP_%7BM%7D%28Y%29%2C+%5Ceta%3DP_%7BH%7D%28Y%29) ，那么**第一个问题**转化为

![[公式]](https://www.zhihu.com/equation?tex=P_%7BH%7D+P_%7BM%7D%3DP_%7BH%7D+%5CLeftrightarrow+P_%7BH%7D%28%5Cxi%29%3D%5Ceta%5C%5C) 

要证 ![[公式]](https://www.zhihu.com/equation?tex=%5Ceta) 为投影，首先它已经在 H 中，只要证明误差项垂直 H。误差项可以写为

![[公式]](https://www.zhihu.com/equation?tex=%5Cxi-%5Ceta%3D%28Y-%5Ceta%29-%28Y-%5Cxi%29%5C%5C) 

其中右边的两项都与 H 是垂直的，可得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi-%5Ceta)  垂直 H.

**第二个问题**转化为

![[公式]](https://www.zhihu.com/equation?tex=P_%7BM%7D+P_%7BH%7D%3DP_%7BH%7D+%5CLeftrightarrow+P_%7BM%7D%28%5Ceta%29%3D%5Ceta%5C%5C) 

这里![[公式]](https://www.zhihu.com/equation?tex=%5Ceta) 为投影是显然的，因为它就在 M 中，投影为自身.

根据投影的定义马上有

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7CY-P_%7BH%7D%28Y%29%5Cright%5C%7C%5E%7B2%7D+%5Cgeq%5Cleft%5C%7CY-P_%7BM%7D%28Y%29%5Cright%5C%7C%5E%7B2%7D%5C%5C) 

> 右边已经在大的空间中达到极小，左边相当于大空间中的一个元素

### 最佳预测

最佳线性预测只用了自变量的线性函数而未考虑其他函数。

现在考虑下面这个空间

![[公式]](https://www.zhihu.com/equation?tex=M%3Ds+%5Cbar%7Bp%7D%5Cleft%5C%7Bg%28%5Cmathbf%7BX%7D%29%3A+%5Coperatorname%7BEg%7D%5E%7B2%7D%28%5Cmathbf%7BX%7D%29%3C%5Cinfty%2C+g%28%5Ccdot%29+%5Ctext+%7B+%E6%98%AF%E5%8F%AF%E6%B5%8B%E5%87%BD%E6%95%B0+%7D%5Cright%5C%7D%5C%5C) 

记投影 ![[公式]](https://www.zhihu.com/equation?tex=L%28Y+%5Cmid+M%29+%5Ctriangleq+P_%7BM%7D%28Y%29) 为最佳预测。

> 最佳预测实际上就是条件期望 ![[公式]](https://www.zhihu.com/equation?tex=E%28Y+%5Cmid+%5Cmathbf%7BX%7D%29) 

**例子** 假设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi%2C%5Ceta) 独立服从标准正态（其四阶矩为3），定义

![[公式]](https://www.zhihu.com/equation?tex=X%3D%5Cvarepsilon%2C+Y%3D%5Ceta%2C+Z%3DX%5E%7B2%7D%2BY%5C%5C) 

计算 ![[公式]](https://www.zhihu.com/equation?tex=L%28Z+%5Cmid+X%29%2C+L%28Z+%5Cmid+M%29)  

 **解**：

最佳线性预测即解预测方程，其中 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5CGamma++%3D+E%7BX%5E2%7D+%3D+1%2C%7B%5CSigma+_%7BXZ%7D%7D+%3D+EXZ+%3D+0%5C%5D) ，所以

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5CGamma+a+%3D+%7B%5CSigma+_%7BXZ%7D%7D%5C%5D) 的解为 0，即最佳线性预测为 0

最佳预测即求条件期望， 



## 5.1 最佳线性预测的基本性质

上一讲我们最后讲到最佳预测，由于最佳预测要求条件数学期望，往往比较难得到，所以常常采用最佳线性预测。并且**对于正态序列，最佳线性预测就是最佳预测**。

**定理** 如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28X_%7B1%7D%2C+X_%7B2%7D%2C+%5Cldots%2C+X_%7Bn%7D%2C+Y%5Cright%29%5E%7BT%7D) 服从联合正态分布 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BN%7D%28%5Cboldsymbol%7B%5Cmu%7D%2C+%5CSigma%29) ，那么用 X 预测 Y 的最佳线性预测就是最佳预测。

**证明** 最佳线性预测已经是 X 的可测函数了，所以只要证明误差项垂直于 X 的所有可测函数张成的空间即可。

而由最佳线性预测性质，误差项与 X1,...,Xn 垂直，即两者不相关。根据正态分布性质，不相关即独立。那么误差项与 X1,...,Xn 的任意可测函数都是独立的，所以对任意 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi+%5Cin+M) 

![[公式]](https://www.zhihu.com/equation?tex=E%5B%5Cxi%28Y-%5Chat%7BY%7D%29%5D%3D%28E+%5Cxi%29+E%28Y-%5Chat%7BY%7D%29%3D0%5C%5C) 

其中用到误差项的期望为 0.

## 5.2 非决定性平稳序列及其Wold表示

这一小节将对平稳序列进行分类，并且把用 X1,...,Xn 预测 Y 拓展到用 Xn 之前的所有历史信息来预测 Y.

### （一）非决定性平稳序列

### 小节内容概览

- 直观描述决定性
- 定义什么是用无穷资料预测
- 定义决定性与非决定性
- 说明非零均值可以转化为零均值，因而只研究零均值
- 纯非决定性定义
- 填坑一：无穷资料等价于有穷资料再取极限
- 填坑二：用无穷资料预测等价于有穷资料预测再取极限

### （1）直观叙述

对于一个平稳序列，考虑用所有历史资料 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%2C+t+%5Cleq+n%5Cright%5C%7D) 来预测 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2B1%7D) 的最佳线性预测，如果预测误差为 0，说明 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2B1%7D) **完全包括在历史资料中**，称序列为**决定性平稳序列**。这样的时间序列描述事物的发展不会有新的信息出现，我们不作研究。

如果预测误差不是 0，说明 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2B1%7D) 无法由历史信息 100% 预测，称为**非决定性平稳序列**。

之后介绍的 wold 定理，将任何非决定性平稳序列分解为**决定性平稳序列+白噪声单边滑动和**。应用时，常将决定性平稳序列取为离散的谱序列（要求证明离散谱序列为决定性平稳序列。）

### （2）最佳线性预测均方误差的极限

根据数学分析极限的思想，用所有历史资料进行预测，可以转换为用前 m 个资料预测，再令 m 趋于无穷（将在之后说明这样做是合理的）。

记

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D_%7Bn%2C+m%7D%3D%5Cleft%28X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Ccdots%2C+X_%7Bn%2B1-m%7D%5Cright%29%5E%7BT%7D%5C%5C) 

相应的最佳线性预测为

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bn%2B1%2C+m%7D%3DL%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%7D%5Cright%29%5C%5C) 

其预测的均方误差记为 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7B1%2C+m%7D%5E%7B2%7D) ，根据性质 8 （更多的信息预测效果更好）知，这是关于 m 单调递减的，并且它是非负的，所以极限存在，记为

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7B1%7D%5E%7B2%7D+%5Ctriangleq+%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Csigma_%7B1%2C+m%7D%5E%7B2%7D%3C%5Cinfty%5C%5C) 

**注意**：在最佳线性预测中含有 n，但均方误差与 n 是无关的，下面来证明。

**证明** 设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D%3D%5Cleft%28a_%7B1%7D%2C+a_%7B2%7D%2C+%5Cldots%2C+a_%7Bm%7D%5Cright%29%5E%7BT%7D) 为预测方程的解，而预测方程中是没有 n 的（都是平稳序列求乘积的数学期望，只与时间差有关），因此 a 与 n 无关。

预测误差为

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bn%7D+%5Ctriangleq+X_%7Bn%2B1%7D-%5Csum_%7Bj%3D1%7D%5E%7Bm%7D+a_%7Bj%7D+X_%7Bn%2B1-j%7D%3DX_%7Bn%2B1%7D-%5Chat%7BX%7D_%7Bn%2B1%2C+m%7D%2C+%5Cquad+n+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

Y 为平稳序列，其平方的数学期望为 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7B1%2C+m%7D%5E%7B2%7D%3DE+Y_%7Bn%7D%5E%7B2%7D%3DE+Y_%7B0%7D%5E%7B2%7D) ，与 n 无关，所以

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7B1%7D%5E%7B2%7D%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Csigma_%7B1%2C+m%7D%5E%7B2%7D%5C%5C) 

与 n 无关。

### （3）决定性与非决定性的严格定义

对于充分大的 m， ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bn%2B1%2C+m%7D%3DL%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%7D%5Cright%29) 表示用充分多的信息进行预测， ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7B1%2C+m%7D%5E%7B2%7D) 是预测的误差，如果当 m 很大时，误差趋于 0，说明用足够多的历史资料能进行完全预测，是决定性序列；反之为非决定性序列。

**定义** 设 ![[公式]](https://www.zhihu.com/equation?tex=%5C%7BX_t%5C%7D) 为 0 均值平稳序列

- ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7B1%7D%5E%7B2%7D%3D0) 则为决定性平稳序列
- ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7B1%7D%5E%7B2%7D+%3E+0) 则为非决定性平稳序列， ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7B1%7D%5E%7B2%7D%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Csigma_%7B1%2C+m%7D%5E%7B2%7D) 为一步预测误差.

### （4）非零均值情况

先将序列零均值化，记为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BZ_%7Bt%7D%5Cright%5C%7D%3D%5Cleft%5C%7BX_%7Bt%7D-%5Cmu%5Cright%5C%7D) ，根据非零均值的最佳线性预测定义

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Chat%7BX%7D_%7Bn%2B1%2C+m%7D+%26%3D%5Cmu%2BL%5Cleft%28X_%7Bn%2B1%7D-%5Cmu+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%7D-%5Cboldsymbol%7B%5Cmu%7D_%7Bm%7D%5Cright%29+%5C%5C+%26%3D%5Cmu%2BL%5Cleft%28Z_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BZ%7D_%7Bn%2C+m%7D%5Cright%29%3D%5Cmu%2B%5Chat%7BZ%7D_%7Bn%2B1%2C+m%7D+%5Cend%7Baligned%7D%5C%5C) 

有 ![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28Z_%7Bn%2B1%7D-%5Chat%7BZ%7D_%7Bn%2B1%2C+m%7D%5Cright%29%5E%7B2%7D%3DE%5Cleft%28X_%7Bn%2B1%7D-%5Chat%7BX%7D_%7Bn%2B1%2C+m%7D%5Cright%29%5E%7B2%7D) .

也就是说，非零均值平稳序列的决定性等价于其所对应的零均值平稳序列的决定性。所以之后我们只考虑零均值的情形。

**例1** 某个阶数的自协方差阵退化，则为决定性平稳序列。假设是 n+1 阶退化，那么可由前 n 项线性表出，进而当 m ≥ n 就有预测误差为 0，取极限当然也是 0.

**例2** 离散谱序列（**常用且常考**）

设零均值随机变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bj%7D%2C+%5Ceta_%7Bk%7D%28j%2C+k%3D1%2C2%2C+%5Cldots%2C+p%29) 两两正交，满足

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28%5Cxi_%7Bj%7D%5E%7B2%7D%5Cright%29%3DE%5Cleft%28%5Ceta_%7Bj%7D%5E%7B2%7D%5Cright%29%3D%5Csigma_%7Bj%7D%5E%7B2%7D%2C+j%3D1%2C2%2C+%5Cldots%5C%5C) 

定义简单离散谱序列为

![[公式]](https://www.zhihu.com/equation?tex=Z_%7Bj%7D%28t%29%3D%5Cxi_%7Bj%7D+%5Ccos+%5Cleft%28t+%5Clambda_%7Bj%7D%5Cright%29%2B%5Ceta_%7Bj%7D+%5Csin+%5Cleft%28t+%5Clambda_%7Bj%7D%5Cright%29%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

可以证明 Z 是平稳序列（期望为0，自协方差函数只与时间差有关），而事实上 Z 的 3 阶自协方差阵是退化的（**牢记这个结果，考试时要说明一下**），那么 ![[公式]](https://www.zhihu.com/equation?tex=Z_j%28t%29+) 可以由 ![[公式]](https://www.zhihu.com/equation?tex=Z_j%28t-1%29%2CZ_j%28t-2%29++) 完全线性表示，而表出的系数就是预测方程：

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cleft%5B+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+1%26%7B%5Ccos+%5Cleft%28+%7B%7B%5Clambda+_j%7D%7D+%5Cright%29%7D%5C%5C+%7B%5Ccos+%5Cleft%28+%7B%7B%5Clambda+_j%7D%7D+%5Cright%29%7D%261+%5Cend%7Barray%7D%7D+%5Cright%5D%7B%5Cbf%7Ba%7D%7D+%3D+%5Cleft%5B+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B%5Ccos+%5Cleft%28+%7B%7B%5Clambda+_j%7D%7D+%5Cright%29%7D%5C%5C+%7B%5Ccos+%5Cleft%28+%7B2%7B%5Clambda+_j%7D%7D+%5Cright%29%7D+%5Cend%7Barray%7D%7D+%5Cright%5D%5C%5C%5C%5D) 

解得 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Cbf%7Ba%7D%7D+%3D+%7B%5Cleft%28+%7B2%5Ccos+%7B%5Clambda+_j%7D%2C+-+1%7D+%5Cright%29%5ET%7D%5C%5D) ，所以 ![[公式]](https://www.zhihu.com/equation?tex=Z_%7Bj%7D%28t%29%3D%282+%5Ccos+%5Clambda%29+Z_%7Bj%7D%28t-1%29-Z_%7Bj%7D%28t-2%29) .

这个系数可以直接记住，考试时验证一下也就说明 3 阶自协方差阵的退化了。

**注**：证明决定性要按照定义，而不能用直观

将多个简单离散谱序列叠加就得到了一般的离散谱序列：

![[公式]](https://www.zhihu.com/equation?tex=Z_%7Bt%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+Z_%7Bj%7D%28t%29%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

它可以被前 2p 个历史资料完全预测，是决定性平稳序列（一般不会要证明这个）。

### （5）纯非决定性

之前我们用历史资料来预测 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2B1%7D) ，现在考虑预测 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2Bk%7D) ，那么预测误差应该会随着 k 的增大而增大，记预测误差为

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7Bk%2C+m%7D%5E%7B2%7D%3D%5Cmathrm%7BE%7D%5Cleft%5BX_%7Bn%2Bk%7D-L%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-m%2B1%7D%5Cright%29%5Cright%5D%5E%7B2%7D%5C%5C) 

同样可以说明预测误差与 k 无关。类似可以定义用所有历史资料来进行 k 步预测的误差

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7Bk%7D%5E%7B2%7D%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Csigma_%7Bk%2C+m%7D%5E%7B2%7D%5C%5C) 

**定义** 如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Clim+_%7Bk+%5Crightarrow+%5Cinfty%7D+%5Csigma_%7Bk%7D%5E%7B2%7D%3D%5Cgamma_%7B0%7D) ，称为**纯非决定性**序列。

> 零均值平稳序列可以简单粗暴的用 0 来预测，这样预测的误差就是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7B0%7D) ，而如果最佳线性预测在 k 很大的时候趋于 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7B0%7D) ，就说明预测没意义。

其中说明 k 步预测误差会随 k 的增大而增大（**要求会证**），事实上这可以计算得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Csigma_%7Bk%7D%5E%7B2%7D+%26%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Cmathrm%7BE%7D%5Cleft%28X_%7Bn%2Bk%7D-L%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-m%7D%5Cright%29%5Cright%29%5E%7B2%7D+%5C%5C+%26%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Cmathrm%7BE%7D%5Cleft%5BX_%7Bn%2Bk-1%7D-L%5Cleft%28X_%7Bn%2Bk-1%7D+%5Cmid+X_%7Bn-1%7D%2C+X_%7Bn-2%7D%2C+%5Cldots%2C+X_%7Bn-1-m%7D%5Cright%29%5Cright%5D_%7B%7D%5E%7B2%7D+%5C%5C+%26+%5Cgeq+%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Cmathrm%7BE%7D%5Cleft%5BX_%7Bn%2Bk-1%7D-L%5Cleft%28X_%7Bn%2Bk-1%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-m-1%7D%5Cright%29%5Cright%5D%5E%7B2%7D+%5C%5C+%26%3D%5Csigma_%7Bk-1%7D%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

第一行之所以不是 n-m+1，是因为取极限后两者一致。第二个等号是由于误差与 n 无关，可以用 n-1 来替换。第三步增加一个信息，方差应该减小。

> 纯非决定性序列不能做长期预测，但介于纯非决定性与决定性之间的序列的长期预测有意义。

对于纯非决定性平稳序列，有以下式子成立（**会证**）

![[公式]](https://www.zhihu.com/equation?tex=%5Clim+_%7Bk+%5Crightarrow+%5Cinfty%7D+%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Cmathrm%7BE%7D%5Cleft%5BL%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-m%2B1%7D%5Cright%29%5Cright%5D%5E%7B2%7D%3D0%5C%5C) 

> 即预测无穷远的最佳线性预测 **几乎处处** 等价于用 0 来预测

**证明**：记 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bn%2Bk%2C+m%7D%3DL%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-m%2B1%7D%5Cright%29) ，根据勾股定理有

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7Bk%2C+m%7D%5E%7B2%7D%3DE%5Cleft%28X_%7Bn%2Bk%7D-%5Chat%7BX%7D_%7Bn%2Bk%2C+m%7D%5Cright%29%5E%7B2%7D%3DE+X_%7Bn%2Bk%7D%5E%7B2%7D-E+%5Chat%7BX%7D_%7Bn%2Bk%2C+m%7D%5E%7B2%7D%5C%5C) 

> 左边取极限用纯非决定性平稳序列的定义，右边第一项已知，第二项为所求

于是有

![[公式]](https://www.zhihu.com/equation?tex=%5Clim+_%7Bk+%5Crightarrow+%5Cinfty%7D+%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Cmathrm%7BE%7D+%5Chat%7BX%7D_%7Bn%2Bk%2C+m%7D%5E%7B2%7D%3D%5Clim+_%7Bk+%5Crightarrow+%5Cinfty%7D+%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D%5Cleft%28%5Cgamma_%7B0%7D-%5Csigma_%7Bk%2C+m%7D%5E%7B2%7D%5Cright%29%3D%5Cgamma_%7B0%7D-%5Cgamma_%7B0%7D%3D0%5C%5C) 

### （6）线性闭包的等价定义

现在我们开始填坑：用无穷多的资料为什么等价于先用 m 个再令 m 趋于无穷？

先给出一个很重要的引理。

**引理** 设 A 为 Hilbert 空间 H 的子集， ![[公式]](https://www.zhihu.com/equation?tex=L_A) 为 A 的所有有限线性组合构成的子集， ![[公式]](https://www.zhihu.com/equation?tex=H_A) 为包含 A 的最小闭子空间。则对任意 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi+%5Cin+H_%7BA%7D) ，存在 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D+%5Cin+L_%7BA%7D%2C+n%3D1%2C2%2C+%5Cldots) ，使得

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7C%5Cxi_%7Bn%7D-%5Cxi%5Cright%5C%7C+%5Crightarrow+0%2C+%5Cquad+n+%5Crightarrow+%5Cinfty%5C%5C) 

> A 对应于无穷的历史资料， ![[公式]](https://www.zhihu.com/equation?tex=L_A) 对应于所有有限的历史资料。现在显然有 ![[公式]](https://www.zhihu.com/equation?tex=L_A) 的闭包在 ![[公式]](https://www.zhihu.com/equation?tex=H_A) 中，引理说的是， ![[公式]](https://www.zhihu.com/equation?tex=H_A) 也包含在 ![[公式]](https://www.zhihu.com/equation?tex=L_A) 的闭包中。即有限的资料取极限就等价于无穷的资料。

**证明**：假定 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbar%7BL%7D_%7BA%7D) 为 ![[公式]](https://www.zhihu.com/equation?tex=L_A) 中元素与其极限构成的集合，一方面由于 ![[公式]](https://www.zhihu.com/equation?tex=L_A) 在 ![[公式]](https://www.zhihu.com/equation?tex=H_A) 中，又有 ![[公式]](https://www.zhihu.com/equation?tex=H_A) 是闭集，所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbar%7BL%7D_%7BA%7D) 也包含在 ![[公式]](https://www.zhihu.com/equation?tex=H_A) 中.

另一方面，可以证明 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbar%7BL%7D_%7BA%7D) 是闭子空间，它包含 A，所以会比包含 A 的最小闭子空间 ![[公式]](https://www.zhihu.com/equation?tex=H_A) 大，因此 ![[公式]](https://www.zhihu.com/equation?tex=H_A) 包含在 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbar%7BL%7D_%7BA%7D) 中.

> 前提是在 Hilbert 空间中，如果空间维数不是可列维的，那么定理结果未必成立.

### （7）线性预测的极限

![[公式]](https://www.zhihu.com/equation?tex=A%3D%5Cleft%5C%7BX_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%5Cright%5C%7D) （即所有历史资料）， ![[公式]](https://www.zhihu.com/equation?tex=L_A) 为 A 的所有有限线性组合张成空间， ![[公式]](https://www.zhihu.com/equation?tex=H_n) 为 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots) 生成的闭子空间，根据引理有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+H_%7BA%7D+%5Csubset+%5Cbar%7BL%7D_%7BA%7D+%5C%5C+L_%7BA%7D+%5Csubset+H_%7BA%7D+%5Cend%7Barray%7D%5C%5C) 

**定理** 设 ![[公式]](https://www.zhihu.com/equation?tex=Y+%5Cin+L%5E%7B2%7D%2C+%5Cxi+%5Cin+H_%7Bn%7D) ，则 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi%3DL%5Cleft%28Y+%5Cmid+H_%7Bn%7D%5Cright%29) 的充要条件为

![[公式]](https://www.zhihu.com/equation?tex=Y-%5Cxi+%5Cperp+X_%7Bj%7D%2C+%5Cquad+j%3Dn%2C+n-1%2C+n-2%2C+%5Cldots%5C%5C) 

> 这类似于之前的性质 7。最佳线性预测要求误差项与空间中的一组基垂直.
> 但是注意这是充要条件，所以主要要说明：无穷资料情形下，误差项垂直每个资料，就能推出是最佳线性预测.

**证明**：必要性由最佳线性预测的性质可得。下面说明充分性.

由垂直于所有资料可知 ![[公式]](https://www.zhihu.com/equation?tex=Y-%5Cxi+%5Cperp+L_%7BA%7D) ，即垂直与所有有限资料张成的空间。由引理，对任意的 ![[公式]](https://www.zhihu.com/equation?tex=%5Ceta+%5Cin+H_%7Bn%7D) ，有 ![[公式]](https://www.zhihu.com/equation?tex=%5Ceta_%7Bm%7D+%5Cin+L_%7BA%7D) ，使得 ![[公式]](https://www.zhihu.com/equation?tex=%5Ceta_%7Bm%7D+%5Crightarrow+%5Ceta) 。再根据内积的连续性，

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%28%28Y-%5Cxi%29+%5Ceta%29%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Cmathrm%7BE%7D%5Cleft%28%28Y-%5Cxi%29+%5Ceta_%7Bm%7D%5Cright%29%3D0%5C%5C) 

> 内积中的极限号可以提到外面

所以 ![[公式]](https://www.zhihu.com/equation?tex=Y-%5Cxi+%5Cperp+H_%7Bn%7D) ，误差项垂直与所有历史资料张成的空间，是最佳线性预测。

### （8）无穷维历史线性资料预报的意义

下面说明，**无穷维最佳线性预测就是有限资料最佳线性预测的极限**。

**定理** 设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D_%7Bn%2C+m%7D%3D%5Cleft%28X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-m%2B1%7D%5Cright%29%5E%7BT%7D) ，当 m 趋于无穷时

![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28Y+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%7D%5Cright%29+%5Cstackrel%7B%5Cmathbf%7Bm%7D+.+%5Cmathbf%7Bs%7D_%7B%2A%7D%7D%7B%5Clongrightarrow%7D+%5Chat%7BY%7D+%5Ctriangleq+L%5Cleft%28Y+%5Cmid+H_%7Bn%7D%5Cright%29%5C%5C) 

**证明** 记 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D_%7Bm%7D%3DL%5Cleft%28Y+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%7D%5Cright%29) 。先证明 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Chat%7BY%7D_%7Bm%7D%5Cright%5C%7D) 是 ![[公式]](https://www.zhihu.com/equation?tex=H_n) 的基本列（极限存在）。显然 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Chat%7BY%7D_%7Bm%7D%5Cright%5C%7D) 包含在 ![[公式]](https://www.zhihu.com/equation?tex=H_n) 中。当 m 趋于无穷时

![[公式]](https://www.zhihu.com/equation?tex=%5Ceta_%7Bm%7D%5E%7B2%7D+%5Ctriangleq+%5Cmathrm%7BE%7D%5Cleft%28Y-%5Chat%7BY%7D_%7Bm%7D%5Cright%29%5E%7B2%7D+%5Crightarrow+%5Ceta%5E%7B2%7D%5C%5C) 

> 资料越多，误差越小，并且非负，所以极限存在

基本列的证明方法单一，就求 m 和 m+k 项差的范数。

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26%5Cleft%5C%7C%5Chat%7BY%7D_%7Bm%7D-%5Chat%7BY%7D_%7Bm%2Bk%7D%5Cright%5C%7C%5E%7B2%7D%3D%5Cleft%5C%7C%5Chat%7BY%7D_%7Bm%7D-Y%2BY-%5Chat%7BY%7D_%7Bm%2Bk%7D%5Cright%5C%7C%5E%7B2%7D+%5C%5C+%3D%26%5Cleft%5C%7C%5Chat%7BY%7D_%7Bm%7D-Y%5Cright%5C%7C%5E%7B2%7D%2B%5Cleft%5C%7CY-%5Chat%7BY%7D_%7Bm%2Bk%7D%5Cright%5C%7C%5E%7B2%7D%2B2%5Cleft%5Clangle%5Chat%7BY%7D_%7Bm%7D-Y%2C+Y-%5Chat%7BY%7D_%7Bm%2Bk%7D%5Cright%5Crangle+%5C%5C+%3D%26+%5Ceta_%7Bm%7D%5E%7B2%7D%2B%5Ceta_%7Bm%2Bk%7D%5E%7B2%7D-2%5Cleft%5Clangle+Y%2C+Y-%5Chat%7BY%7D_%7Bm%2Bk%7D%5Cright%5Crangle+%5C%5C+%3D%26+%5Ceta_%7Bm%7D%5E%7B2%7D%2B%5Ceta_%7Bm%2Bk%7D%5E%7B2%7D-2%5Cleft%5Clangle+Y-%5Chat%7BY%7D_%7Bm%2Bk%7D%2C+Y-%5Chat%7BY%7D_%7Bm%2Bk%7D%5Cright%5Crangle+%5C%5C+%3D%26+%5Ceta_%7Bm%7D%5E%7B2%7D%2B%5Ceta_%7Bm%2Bk%7D%5E%7B2%7D-2+%5Ceta_%7Bm%2Bk%7D%5E%7B2%7D+%5Crightarrow+0+%5Cend%7Baligned%7D%5C%5C) 

第二、第三个等号用到 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D_%7Bm%7D%2C+%5Chat%7BY%7D_%7Bm%2Bk%7D) 与 ![[公式]](https://www.zhihu.com/equation?tex=Y-%5Chat%7BY%7D_%7Bm%2Bk%7D) 垂直，最后一行中三项取了极限后相减刚好为 0，因此为基本列（**会证**），存在唯一的极限点 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi) 。

> ![[公式]](https://www.zhihu.com/equation?tex=Y-%5Chat%7BY%7D_%7Bm%2Bk%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28Y+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%2Bk%7D%5Cright%29) 垂直，而 ![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28Y+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%7D%5Cright%29) 包含在 ![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28Y+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%2Bk%7D%5Cright%29) 中

下面说明 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi) 为最佳线性预测。它已经在 ![[公式]](https://www.zhihu.com/equation?tex=H_n) 中，只需证明垂直，可利用（7）的定理.

由内积的连续性，对任意 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bs%7D%2C+s+%5Cleq+n) 有

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5Clangle+X_%7Bs%7D%2C+Y-%5Cxi%5Cright%5Crangle%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D%5Cleft%5Clangle+X_%7Bs%7D%2C+Y-L%5Cleft%28Y+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%7D%5Cright%29%5Cright%5Crangle%3D0%5C%5C) 

由（7）给出的定理知 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi%3DL%5Cleft%28Y+%5Cmid+H_%7Bn%7D%5Cright%29) .

### （8）最佳线性预测方差

根据内积的连续性 

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Csigma_%7B1%7D%5E%7B2%7D+%26+%5Ctriangleq+%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D%5Cleft%5C%7CX_%7Bn%2B1%7D-L%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%7D%5Cright%29%5Cright%5C%7C%5E%7B2%7D+%5C%5C+%26%3D%5Cleft%5C%7CX_%7Bn%2B1%7D-L%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+H_%7Bn%7D%5Cright%29%5Cright%5C%7C%5E%7B2%7D%3D%5Cleft%5C%7CX_%7B1%7D-L%5Cleft%28X_%7B1%7D+%5Cmid+H_%7B0%7D%5Cright%29%5Cright%5C%7C%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

第一个等号右边是用 m 个资料预测的误差，第二个等号由（7）中定理，把极限取到资料中，相当于用无穷资料预测的误差。第三个等号利用平稳序列的性质，取 n 为 0.

所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7B1%7D%5E%7B2%7D%3D0+%5Cleftrightarrow+X_%7B1%7D%3DL%5Cleft%28X_%7B1%7D+%5Cmid+H_%7B0%7D%5Cright%29) ，即 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7B1%7D%5E%7B2%7D%3D0+%5Cleftrightarrow+X_%7B1%7D+%5Cin+H_%7B0%7D) .

类似地可以考察 k 步的预测误差

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Csigma_%7Bk%7D%5E%7B2%7D+%26+%5Ctriangleq+%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D%5Cleft%5C%7CX_%7Bn%2Bk%7D-L%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%2C+m%7D%5Cright%29%5Cright%5C%7C%5E%7B2%7D+%5C%5C+%26%3D%5Cleft%5C%7CX_%7Bn%2Bk%7D-L%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+H_%7Bn%7D%5Cright%29%5Cright%5C%7C%5E%7B2%7D%3D%5Cleft%5C%7CX_%7Bk%7D-L%5Cleft%28X_%7Bk%7D+%5Cmid+H_%7B0%7D%5Cright%29%5Cright%5C%7C%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

将上述讨论总结为下面的定理。

**定理** 设 ![[公式]](https://www.zhihu.com/equation?tex=%5C%7BX_t%5C%7D) 为零均值平稳序列

- 决定性平稳序列等价 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2B1%7D+%5Cin+H_%7Bn%7D) ，对某个 n，并且如果对某个 n 成立，则对任意 n 成立，此时有 ![[公式]](https://www.zhihu.com/equation?tex=H_%7Bn%7D%3DH_%7Bn-1%7D%2C+%5Cforall+n+%5Cin+%5Cmathbb%7BZ%7D) .
- 纯非决定性平稳序列等价 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma_%7Bk%7D%5E%7B2%7D%3D%5Cleft%5C%7CX_%7Bn%2Bk%7D-L%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+H_%7Bn%7D%5Cright%29%5Cright%5C%7C%5E%7B2%7D+%5Crightarrow+%5Cgamma_%7B0%7D%2C+%5Cquad+k+%5Crightarrow+%5Cinfty) ，对某个 n。并且只要某个 n 成立，那么所有 n 成立。

### （二）Wold表示定理（****核心\****）

**定理** 任意**非决定性平稳序列**可以表示为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2BV_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

> 白噪声的单边滑动平均 + 决定性平稳序列

**（1）**其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D+%5Cvarepsilon_%7Bt%7D%5E2%3D%5Csigma%5E%7B2%7D%3E0%2C+%5Cquad+a_%7B0%7D%3D1) 

![[公式]](https://www.zhihu.com/equation?tex=a_%7Bj%7D%3D%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%7D+%5Cvarepsilon_%7Bt-j%7D%5Cright%29+%2F+%5Csigma%5E%7B2%7D%2C+%5Cquad+%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D%5E%7B2%7D%3C%5Cinfty%5C%5C) 

这里定义白噪声为“增加的信息”，即

![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D%3DX_%7Bt%7D-L%5Cleft%28X_%7Bt%7D+%5Cmid+X_%7Bt-1%7D%2C+X_%7Bt-2%7D%2C+%5Cldots%5Cright%29%5C%5C) 

> 将新出现的观测值减去历史资料对他的预测，即所谓“增加的信息”

这样定义的序列，将在之后说明它确实是“零均值白噪声序列”。

**（2）** ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BU_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+t+%5Cin+%5Cmathbb%7BZ%7D%5Cright%5C%7D) 是与 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BV_%7Bt%7D%5Cright%5C%7D) 正交的平稳序列。

> 白噪声平均 与 决定性平稳序列 正交，直观上也好理解：新增加的信息必然与历史资料无关。

**（3）**定义

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D++H_%7B%5Cvarepsilon%7D%28t%29.%26%3Ds+%5Coverline%7B%5Cmathrm%7Bp%7D%7D%5Cleft%5C%7B%5Cvarepsilon_%7Bs%7D%3A+s+%5Cleq+t%5Cright%5C%7D+%5C%5C+H_%7BU%7D%28t%29+%26%3D%5Cmathrm%7Bs%7D+%5Coverline%7B%5Cmathrm%7Bp%7D%7D%5Cleft%5C%7BU_%7Bs%7D%3A+s+%5Cleq+t%5Cright%5C%7D%2C+%5Ctext+%7B+%E5%88%99%7D%5Cforall++t+%5C%5C+H_%7BU%7D%28t%29+%26%3DH_%7B%5Cvarepsilon%7D%28t%29+%5Cend%7Baligned%7D%5C%5C) 

> H 表示所有历史资料，上面这个式子说明滑动平均生成的历史资料与白噪声的历史资料相同。

**（4）** ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BU_%7Bt%7D%5Cright%5C%7D) 是纯非决定性平稳序列，谱密度为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B2%7D%5C%5C) 

**（5）**![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BV_%7Bt%7D%5Cright%5C%7D) 是决定性平稳序列， ![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D+%5Cin+H_%7Bt-k%7D) ，对任何 ![[公式]](https://www.zhihu.com/equation?tex=t+%5Cin+%5Cmathbb%7BZ%7D%2C+%5Cquad+k+%5Cin+%5Cmathbb%7BN%7D) .

**证明（1）**：取

![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D%3DX_%7Bt%7D-L%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7Bt-1%7D%5Cright%29%2C%5C%5C) 

为增加的信息

![[公式]](https://www.zhihu.com/equation?tex=+H_%7B%5Cvarepsilon%7D%28t%29%3D%5Cbar%7Bs%7D+p%5Cleft%5C%7B%5Cvarepsilon_%7Bs%7D%3A+s+%5Cleq+t%5Cright%5C%7D%5C%5C) 

为其所有历史资料。那么显然 ![[公式]](https://www.zhihu.com/equation?tex=+%5Cvarepsilon_%7Bt%7D+%5Cin+H_%7Bt%7D) ，并且由单调性， ![[公式]](https://www.zhihu.com/equation?tex=+%5Cvarepsilon_%7Bt%7D+%5Cin+H_%7Bs%7D%2C+%5Cforall+t%3Cs) ，因此 ![[公式]](https://www.zhihu.com/equation?tex=H_%7B%5Cvarepsilon%7D%28t%29+%5Csubset+H_%7Bt%7D) .

> 信息序列是由原序列提炼出来的，包含在原序列的资料中

要证明白噪声，需要证明三个式子：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+E+%5Cvarepsilon_%7Bt%7D%3D0+%5C%5C+%5Cmathrm%7BE%7D+%5Cvarepsilon_%7Bt%7D%5E%7B2%7D%3D%5Csigma%5E%7B2%7D%3E0+%5C%5C+%5Cvarepsilon_%7Bs%7D+%5Cperp+%5Cvarepsilon_%7Bt%7D%2C+s%3Et+%5Cend%7Barray%7D%5C%5C) 

直接求数学期望不太行，先研究最佳线性预测部分。无穷资料不太好用预测方程，好在可以先写成有限资料再取极限。

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+L%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7Bt-1%7D%5Cright%29+%26%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+L%5Cleft%28X_%7Bt%7D+%5Cmid+X_%7Bt-1%7D%2C+%5Cldots%2C+X_%7Bt-m%7D%5Cright%29+%5Cquad%5Cleft%28L%5E%7B2%7D%5Cright%29+%5C%5C+%26%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Cmathbf%7Ba%7D_%7Bm%7D%5E%7BT%7D+%5Cmathbf%7BX%7D_%7Bt-1%2C+m%7D+%5Cend%7Baligned%7D%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Ba%7D_%7Bm%7D) 是相应的预测方程的解，与 t 无关。由内积的连续性，可得

![[公式]](https://www.zhihu.com/equation?tex=E+%5Cvarepsilon_%7Bt%7D%3DE+X_%7Bt%7D-%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+E+a_%7Bm%7D%5E%7BT%7D+X_%7Bt-1%2C+m%7D%3D0%5C%5C) 

类似地计算平方的期望如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26%5Cbegin%7Baligned%7D+%5Cmathrm%7BE%7D+%5Cvarepsilon_%7Bt%7D%5E%7B2%7D+%26%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D%5Cleft%5C%7CX_%7Bt%7D-L%5Cleft%28X_%7Bt%7D+%5Cmid+X_%7Bt-1%7D%2C+%5Cldots%2C+X_%7Bt-m%7D%5Cright%29%5Cright%5C%7C%5E%7B2%7D+%5C%5C+%26%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D%5Cleft%28%5Cgamma_%7B0%7D-%5Cmathbf%7Ba%7D_%7Bm%7D%5E%7BT%7D+%5CGamma_%7Bm%7D+%5Cmathbf%7Ba%7D_%7Bm%7D%5Cright%29+%5Cquad%28%5Ctext+%7B+%E4%B8%8E+%7D+t+%5Ctext+%7B+%E6%97%A0%E5%85%B3+%7D%29+%5Cend%7Baligned%7D%5C%5C+%26%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Csigma_%7B1%2C+m%7D%5E%7B2%7D%3D%5Csigma%5E%7B2%7D%3E0+%5Cquad+%5Ctext+%7B+%28%E7%94%B1%E9%9D%9E%E5%86%B3%E5%AE%9A%E6%80%A7%E5%AE%9A%E4%B9%89+%7D%29+%5Cend%7Baligned%7D%5C%5C) 

> 第二个等号为勾股定理，第三个等号为第一个等号右端式子的定义。

欲证正交，先直观来看下

![img](https://pic4.zhimg.com/80/v2-ff5ea1a45a494730002213d29f53095f_720w.jpg)

事实上对于 s < t，有 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_s) 属于 ![[公式]](https://www.zhihu.com/equation?tex=H_%7Bt-1%7D) （这好理解，毕竟它属于 ![[公式]](https://www.zhihu.com/equation?tex=H_s) 而 ![[公式]](https://www.zhihu.com/equation?tex=H) 有单调性），那么从图中就可以得知正交。

证明的时候就说明一下![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_s) 属于 ![[公式]](https://www.zhihu.com/equation?tex=H_%7Bt-1%7D) 即可。

剩下的证明放到下一讲。



继续把定理的剩余部分证完。先直观回顾一下定理的五个部分都讲了些啥。

- 证明定理中构造的信息序列是零均值白噪声
- 信息序列滑动与定理中决定性序列部分正交
- 白噪声的滑动和与其本身的地位相同
- 白噪声单边滑动和是纯非决定性平稳序列
- V 的确是决定性平稳序列



**证明（2）很长且繁琐**：定义

![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D%3DX_%7Bt%7D-L%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7B%5Cvarepsilon%7D%28t%29%5Cright%29%5C%5C) 

关系图变为

![img](https://pic1.zhimg.com/80/v2-9ac182711db23c770b673c3d3dd8c3dc_720w.jpg)

### 说明 Vt 垂直与白噪声序列

显然 ![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D+%5Cin+H_%7Bt%7D) ，根据投影性质有 ![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D+%5Cperp+H_%7B%5Cvarepsilon%7D%28t%29) ，即 ![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D+%5Cperp+%5Cvarepsilon_%7Bs%7D%2C+s+%5Cleq+t) .

当 s > t 时，注意此时 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bs%7D+%5Cperp+H_%7Bs-1%7D+%5Csupset+H_%7Bt%7D) ，而 ![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D+%5Cin+H_%7Bt%7D) ，所以 ![[公式]](https://www.zhihu.com/equation?tex=%7B%5Cvarepsilon%7D_%7Bs%7D+%5Cperp+V_%7Bt%7D%2C+s%3Et) 

> 要想完成证明，需要按照定义找到垂直关系和包含关系

可以这样理解，一个平稳序列一开始就有一些信息 V(t) ，然后不断产生白噪声，它自然与 V(t) 是正交的。

现在我们令 ![[公式]](https://www.zhihu.com/equation?tex=U_%7Bt%7D%3DL%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7B%5Cvarepsilon%7D%28t%29%5Cright%29) ，那么

![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D%3DX_%7Bt%7D-L%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7B%5Cvarepsilon%7D%28t%29%5Cright%29%3DX_%7Bt%7D-U_%7Bt%7D%5C%5C) 

需要证明的是 ![[公式]](https://www.zhihu.com/equation?tex=U_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D) .

**准备工作**：证明 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bt%7D%5Cright%5C%7D) 平稳相关。即

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26%5Cleft%5Clangle%5Cvarepsilon_%7Bs%7D%2C+X_%7Bt%7D%5Cright%5Crangle%3D0%2C+s%3Et%5C%5C+%26%5Cleft%5Clangle+X_%7Bt%7D%2C+%5Cvarepsilon_%7Bs%7D%5Cright%5Crangle+%5Cquad+s+%5Cleq+t+%E6%97%B6+%5Cquad+%E5%8F%AA+%E4%BE%9D+%E8%B5%96+%E4%BA%8E+t-s+%5Cend%7Baligned%7D%5C%5C) 

第一行是显然的，主要证明第二行。

根据之前的定理，用将无穷资料写为有穷资料的极限（注意下面这个式子与信息序列的定义有关）

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+L%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7Bt-1%7D%5Cright%29+%26%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+L%5Cleft%28X_%7Bt%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bt-1%2C+m%7D%5Cright%29+%5C%5C+%26%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D+%5Cmathbf%7Ba%7D_%7Bm%7D%5E%7BT%7D+%5Cmathbf%7BX%7D_%7Bt-1%2C+m%7D+%5Cend%7Baligned%7D%5C%5C) 

根据内积的连续性有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cleft%5Clangle+X_%7Bt%7D%2C+%5Cvarepsilon_%7Bs%7D%5Cright%5Crangle+%26%3D%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D%5Cleft%5Clangle+X_%7Bt%7D%2C+X_%7Bs%7D-%5Cmathbf%7Ba%7D_%7Bm%7D%5E%7BT%7D+%5Cmathbf%7BX%7D_%7Bs-1%2C+m%7D%5Cright%5Crangle+%5C%5C+%26%3D%5Cgamma_%7Bt-s%7D-%5Clim+_%7Bm+%5Crightarrow+%5Cinfty%7D%5Cleft%28a_%7Bm+1%7D+%5Cgamma_%7Bt-s%2B1%7D%2B%5Ccdots%2Ba_%7Bm+m%7D+%5Cgamma_%7Bt-s%2Bm%7D%5Cright%29+%5Cend%7Baligned%7D%5C%5C) 

这只与 t - s 有关。**到此就证明了平稳相关**。

下面补全（1）中遗漏的，定义白噪声滑动的系数

![[公式]](https://www.zhihu.com/equation?tex=a_%7Bj%7D%3D%5Cleft%5Clangle+X_%7Bt%7D%2C+%5Cvarepsilon_%7Bt-j%7D%5Cright%5Crangle+%2F+%5Csigma%5E%7B2%7D+%5Cquad%28j+%5Cgeq+0%29%5C%5C) 

平稳相关保证其与 t 无关，并且

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+a_%7B0%7D+%26%3D%5Cleft%5Clangle+X_%7Bt%7D%2C+%5Cvarepsilon_%7Bt%7D%5Cright%5Crangle+%2F+%5Csigma%5E%7B2%7D+%5C%5C+%26%3D%5Cleft%5Clangle%5Cvarepsilon_%7Bt%7D%2BL%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7Bt-1%7D%5Cright%29%2C+%5Cvarepsilon_%7Bt%7D%5Cright%5Crangle+%2F+%5Csigma%5E%7B2%7D+%5C%5C+%26%3D%5Cleft%5Clangle%5Cvarepsilon_%7Bt%7D%2C+%5Cvarepsilon_%7Bt%7D%5Cright%5Crangle+%2F+%5Csigma%5E%7B2%7D%3D1+%5Cend%7Baligned%7D%5C%5C) 

而这样定义的系数为何平方可和？下面直接证明 ![[公式]](https://www.zhihu.com/equation?tex=U_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D) ，从中说明平方可和。

回顾定义 ![[公式]](https://www.zhihu.com/equation?tex=U_%7Bt%7D%3DL%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7B%5Cvarepsilon%7D%28t%29%5Cright%29) ，这是无穷资料，我们写成有穷资料再取极限

定义 ![[公式]](https://www.zhihu.com/equation?tex=U_%7Bt%2C+n%7D%3DL%5Cleft%28X_%7Bt%7D+%5Cmid+%5Cvarepsilon_%7Bt%7D%2C+%5Cvarepsilon_%7Bt-1%7D%2C+%5Cldots%2C+%5Cvarepsilon_%7Bt-n%7D%5Cright%29%3D%5Csum_%7Bj%3D0%7D%5E%7Bn%7D+b_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D) ，（**为什么 b 和 n 无关？**）那么对 j 从 0 到 n 有（**注意其中第 3 个等号是关键！**）

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Csigma%5E%7B2%7D+a_%7Bj%7D+%26%3D%5Cleft%5Clangle+X_%7Bt%7D%2C+%5Cvarepsilon_%7Bt-j%7D%5Cright%5Crangle%3D%5Cleft%5Clangle+U_%7Bt%2C+n%7D%2B%5Cleft%28X_%7Bt%7D-U_%7Bt%2C+n%7D%5Cright%29%2C+%5Cvarepsilon_%7Bt-j%7D%5Cright%5Crangle+%5C%5C+%26%3D%5Cleft%5Clangle+U_%7Bt%2C+n%7D%2C+%5Cvarepsilon_%7Bt-j%7D%5Cright%5Crangle%3D%5Csigma%5E%7B2%7D+b_%7Bj%7D+%5Cend%7Baligned%7D%5C%5C) 

即得 ![[公式]](https://www.zhihu.com/equation?tex=b_%7Bj%7D%3Da_%7Bj%7D) （自然就与 n 无关了），因此

![[公式]](https://www.zhihu.com/equation?tex=U_%7Bt%2C+n%7D%3DL%5Cleft%28X_%7Bt%7D+%5Cmid+%5Cvarepsilon_%7Bt%7D%2C+%5Cvarepsilon_%7Bt-1%7D%2C+%5Cldots%2C+%5Cvarepsilon_%7Bt-n%7D%5Cright%29%3D%5Csum_%7Bj%3D0%7D%5E%7Bn%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%5C%5C) 

根据投影的性质， ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7CU_%7Bt%2C+n%7D%5Cright%5C%7C%5E%7B2%7D+%5Cleq%5Cleft%5C%7CX_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D%3D%5Cgamma_%7B0%7D) ，所以

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7CU_%7Bt%2C+n%7D%5Cright%5C%7C%5E%7B2%7D%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7Bn%7D+a_%7Bj%7D%5E%7B2%7D+%5Cleq+%5Cgamma_%7B0%7D%3C%5Cinfty%5C%5C) 

令 n 趋于无穷，有 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D%5E%7B2%7D%3C%5Cinfty) ，所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7Bn%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D) 均方收敛到 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D) .

而根据之前定理，无穷资料就是有穷资料的极限，有 ![[公式]](https://www.zhihu.com/equation?tex=U_%7Bt%2C+n%7D) 均方收敛到 

![[公式]](https://www.zhihu.com/equation?tex=U_%7Bt%7D%3DL%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7B%5Cvarepsilon%7D%28t%29%5Cright%29%5C%5C) 

而均方极限唯一，所以 ![[公式]](https://www.zhihu.com/equation?tex=U_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D) .

下面最后再来证明 U 和 V 垂直就可以休息一下了。

由于 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BV_%7Bt%7D%5Cright%5C%7D) 正交，所以 ![[公式]](https://www.zhihu.com/equation?tex=V_%7Bs%7D+%5Cperp+H_%7B%5Cvarepsilon%7D%28t%29%2C+%5Cforall+s%2C+t+%5Cin+%5Cmathbb%7BZ%7D) ，而 ![[公式]](https://www.zhihu.com/equation?tex=U_%7Bt%7D+%5Cin+H_%7B%5Cvarepsilon%7D%28t%29) ，所以 ![[公式]](https://www.zhihu.com/equation?tex=V_%7Bs%7D+%5Cperp+U_%7Bt%7D) ，也就得到了正交。可以说明 ![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D%3DX_%7Bt%7D-U_%7Bt%7D) 也是平稳序列，因为右边两个都是平稳序列，且 U 和 V 是正交的，把 U 移过来之后求自协方差函数是没有交叉项的。

**至此（1）（2）证毕**。

------

**证明（3）**： ![[公式]](https://www.zhihu.com/equation?tex=H_%7BU%7D%28t%29%3DH_%7B%5Cvarepsilon%7D%28t%29) ，即二者地位相同。

其中一个包含关系显然，U 为白噪声序列生成的，自然包含在其闭包中。下面证明 ![[公式]](https://www.zhihu.com/equation?tex=H_%7B%5Cvarepsilon%7D%28t%29+%5Csubset+H_%7BU%7D%28t%29) 就可以了，这实际上有点难度。

首先有 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D+%5Cin+H_%7Bt%7D+%5Csubset+%5Coperatorname%7Bsp%7D%5Cleft%5C%7BU_%7Bs%7D%2C+V_%7Bs%7D%3A+s+%5Cleq+t%5Cright%5C%7D) ，回顾一下之前介绍过的一个引理：包含 A 的最小闭子空间可以由 A 中元素的有限线性组合再取极限得到（这个引理就是当时用来证明无穷资料与有穷资料极限等价的），根据引理存在

![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bm%7D+%5Cin+L_%7B%5Cleft%5C%7BV_%7Bt%7D%2C+V_%7Bt-1%7D%2C+%5Cldots%2C+V_%7Bt-m%7D%5Cright%5C%7D%7D%2C+%5Ceta_%7Bm%7D+%5Cin+L_%7B%5Cleft%5C%7BU_%7Bt%7D%2C+U_%7Bt-1%7D%2C+%5Cldots%2C+U_%7Bt-m%7D%5Cright%5C%7D%7D%5C%5C) 

使得

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7C%5Cxi_%7Bm%7D%2B%5Ceta_%7Bm%7D-%5Cvarepsilon_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D+%5Crightarrow+0%5C%5C) 

而根据 V 与 U 以及ε 的正交关系有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26%5Cleft%5C%7C%5Cxi_%7Bm%7D%2B%5Ceta_%7Bm%7D-%5Cvarepsilon_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D+%5C%5C+%3D%26%5Cleft%5C%7C%5Cxi_%7Bm%7D%5Cright%5C%7C%5E%7B2%7D%2B%5Cleft%5C%7C%5Ceta_%7Bm%7D-%5Cvarepsilon_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D+%5C%5C+%5Cgeq+%26%5Cleft%5C%7C%5Ceta_%7Bm%7D-%5Cvarepsilon_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

由此可得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7C%5Ceta_%7Bm%7D-%5Cvarepsilon_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D+%5Crightarrow+0) ，这表明白噪声序列可以由 U 中有限元素取极限得到，所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D+%5Cin+H_%7BU%7D%28t%29) ，继而 ![[公式]](https://www.zhihu.com/equation?tex=H_%7B%5Cvarepsilon%7D%28t%29+%5Csubset+%7BH%7D_%7BU%7D%28t%29) .

**证明（4）**：U 是纯非决定性的（**很重要的技巧，之后 AR 和 MA 等都可以这样证明！**）

写出 k 步预测误差，其中箭头部分是需要证明的

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7CU_%7Bt%2Bk%7D-L%5Cleft%28U_%7Bt%2Bk%7D+%5Cmid+H_%7BU%7D%28t%29%5Cright%29%5Cright%5C%7C%5E%7B2%7D+%5Crightarrow+%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D%5E%7B2%7D%3D%5Cmathrm%7BE%7D+U_%7Bt%7D%5E%7B2%7D%5C%5C) 

 考虑其中最佳线性预测部分

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+L%5Cleft%28U_%7Bt%2Bk%7D+%5Cmid+H_%7BU%7D%28t%29%5Cright%29%3DL%5Cleft%28U_%7Bt%2Bk%7D+%5Cmid+H_%7B%5Cvarepsilon%7D%28t%29%5Cright%29+%5C%5C+%3D%26+L%5Cleft%5B%5Csum_%7Bj%3D0%7D%5E%7Bk-1%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt%2Bk-j%7D%2B%5Csum_%7Bj%3Dk%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt%2Bk-j%7D+%5Cmid+H_%7B%5Cvarepsilon%7D%28t%29%5Cright%5D+%5C%5C+%3D%26+%5Csum_%7Bj%3Dk%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt%2Bk-j%7D+%5Cend%7Baligned%7D%5C%5C) 

第一个等号用到刚刚证明的（3），第二个等号将白噪声拆为下标小和下标大两部分，其中下标小的处于 ![[公式]](https://www.zhihu.com/equation?tex=H_%7B%5Cvarepsilon%7D%28t%29) 中，就是所要求的投影。

于是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26%5Cleft%5C%7CU_%7Bt%2Bk%7D-L%5Cleft%28U_%7Bt%2Bk%7D+%5Cmid+H_%7BU%7D%28t%29%5Cright%29%5Cright%5C%7C%5E%7B2%7D%3D%5Cleft%5C%7C%5Csum_%7Bj%3D0%7D%5E%7Bk-1%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt%2Bk-j%7D%5Cright%5C%7C%5E%7B2%7D+%5C%5C+%3D%26+%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7Bk-1%7D+a_%7Bj%7D%5E%7B2%7D+%5Crightarrow+%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D%5E%7B2%7D%3D%5Cmathrm%7BE%7D+U_%7Bt%7D%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

**证明（5）**：V 是决定性的（终于要结束了www）

> 这个 V 很玄学，它表示平稳序列一开始具有的信息，看不见摸不着。

其决定性等价于证明

![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D+%5Cin+H_%7BV%7D%28t-1%29%3Ds+%5Cbar%7Bp%7D%5Cleft%5C%7BV_%7Bs%7D%3A+s+%5Cleq+t-1%5Cright%5C%7D%5C%5C) 

注意到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt-j%7D+%5Cin+H_%7Bt-j%7D) ，将 V 用定义写开，其中的 U 可以写成求和形式

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+V_%7Bt%7D+%26%3DX_%7Bt%7D-U_%7Bt%7D%3DX_%7Bt%7D-%5Cvarepsilon_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D+%5C%5C+%26%3DL%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7Bt-1%7D%5Cright%29-%5Csum_%7Bj%3D1%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D+%5Cend%7Baligned%7D%5C%5C) 

第三个等号用信息序列的定义。其中两部分 ![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7Bt-1%7D%5Cright%29+%5Cin+H_%7Bt-1%7D) 且

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bj%3D1%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D+%5Cin+H_%7B%5Cvarepsilon%7D%28t-1%29+%5Csubset+H_%7Bt-1%7D%5C%5C) 

所以 ![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D+%5Cin+H_%7Bt-1%7D) .再次用引理！注意 ![[公式]](https://www.zhihu.com/equation?tex=H_%7Bt-1%7D+%5Csubset+%5Coverline%7B%5Cmathrm%7Bsp%7D%7D%5Cleft%5C%7BU_%7Bs%7D%2C+V_%7Bs%7D%3A+s+%5Cleq+t-1%5Cright%5C%7D) ，存在

![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bm%7D+%5Cin+L_%7B%5Cleft%5C%7BV_%7Bt-1%7D%2C+%5Cldots%2C+V_%7Bt-m%7D%5Cright%5C%7D%7D%2C+%5Ceta_%7Bm%7D+%5Cin+L_%7B%5Cleft%5C%7BU_%7Bt-1%7D%2C+%5Cldots%2C+U_%7Bt-m%7D%5Cright%5C%7D%7D%5C%5C) 

有

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7C%5Cxi_%7Bm%7D%2B%5Ceta_%7Bm%7D-V_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D+%5Crightarrow+0%5C%5C) 

根据正交有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cleft%5C%7C%5Cxi_%7Bm%7D%2B%5Ceta_%7Bm%7D-V_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D+%26%3D%5Cleft%5C%7C%5Cxi_%7Bm%7D-V_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D%2B%5Cleft%5C%7C%5Ceta_%7Bm%7D%5Cright%5C%7C%5E%7B2%7D+%5C%5C+%5Cgeq%5Cleft%5C%7C%5Cxi_%7Bm%7D-V_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7C%5Cxi_%7Bm%7D-V_%7Bt%7D%5Cright%5C%7C%5E%7B2%7D+%5Crightarrow+0%28m+%5Crightarrow+%5Cinfty%29) ，根据引理（**第二次用啦！**）

![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%7D+%5Cin+H_%7BV%7D%28t-1%29%3Ds+%5Coverline%7B%5Cmathrm%7Bp%7D%7D%5Cleft%5C%7BV_%7B%5Cmathrm%7Bs%7D%7D%3A+s+%5Cleq+t-1%5Cright%5C%7D%5C%5C) 

所以 V 的决定性就证好了。

### wold表示定理的意义

称

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2BV_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

是平稳序列的 wold 表示，U 和 V 分别为其纯非决定性和决定性的部分。滑动平均的系数 a 为 wold 系数。称一步预测误差

![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D%3DX_%7Bt%7D-L%5Cleft%28X_%7Bt%7D+%5Cmid+X_%7Bt-1%7D%2C+X_%7Bt-2%7D%2C+%5Cldots%5Cright%29%5C%5C) 

为新息序列。 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E%7B2%7D%3D%5Cmathrm%7BE%7D+%5Cvarepsilon_%7Bt%7D%5E%7B2%7D) 为一步预测的均方误差。

- **新息**指的是完全不能被历史线性预测。
- 根据定理，任何纯非决定性平稳序列都能表示为白噪声的单边滑动和
- 任何白噪声的单边滑动和都是纯非决定性平稳序列，但注意其中白噪声不一定恰好为新息序列。（考虑 a0 是否为 1，不为 1 就不是）

### ARMA 序列的 wold 表示

**例** ARMA(p,q) 模型的方程为

![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DB%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

设有泰勒展开式

![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28z%29%3DA%5E%7B-1%7D%28z%29+B%28z%29%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+z%5E%7Bj%7D%2C+%5Cquad%7Cz%7C+%5Cleq+1%5C%5C) 

那么 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D) 。下面证明它是纯非决定性的，只需要**说明这里的白噪声是定理中的新息序列即可**。（只对简单的可逆 ARMA 模型做证明）

由上面式子可知 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D+%5Cin+H_%7B%5Cvarepsilon%7D%28t%29) ，利用可逆性 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D%3DB%5E%7B-1%7D%28%5Cmathscr%7BB%7D%29+A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D+%5Cin+H_%7Bt%7D) ，二者能相互表示，所以有 ![[公式]](https://www.zhihu.com/equation?tex=H_%7Bt%7D%3DH_%7B%5Cvarepsilon%7D%28t%29) ，于是

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D-%5Cvarepsilon_%7Bt%7D%3D%5Csum_%7Bj%3D1%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D+%5Cin+H_%7B%5Cvarepsilon%7D%28t-1%29%3DH_%7Bt-1%7D%5C%5C) 

要证 ![[公式]](https://www.zhihu.com/equation?tex=x_%7Bt%7D-%5Cvarepsilon_%7Bt%7D%3DL%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7Bt-1%7D%5Cright%29) ，已经证明它在空间中，只需证明误差项垂直于该空间，即 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D-%5Cleft%28X_%7Bt%7D-%5Cvarepsilon_%7Bt%7D%5Cright%29+%5Cperp+H_%7Bt-1%7D) 。事实上根据白噪声相互正交有 

![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D+%5Cperp+H_%7B%5Cvarepsilon%7D%28t-1%29%3DH_%7Bt-1%7D%5C%5C) 

因此

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+X_%7Bt%7D-%5Cvarepsilon_%7Bt%7D%3DL%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7Bt-1%7D%5Cright%29+%5C%5C+%5Cvarepsilon_%7Bt%7D%3DX_%7Bt%7D-L%5Cleft%28X_%7Bt%7D+%5Cmid+H_%7Bt-1%7D%5Cright%29+%5Cend%7Barray%7D%5C%5C) 

第一行：还记得最佳线性预测怎么证吗？（是否在空间中；误差项是否垂直该空间）.

事实上**直接计算也可以**：（更简洁!!!）

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+%7BX_t%7D+-+L%5Cleft%28+%7B%7BX_t%7D%7C%7BH_%7Bt+-+1%7D%7D%7D+%5Cright%29+%3D+%5Csum%5Climits_%7Bj+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cpsi+_j%7D%7B%5Cvarepsilon+_%7Bt+-+j%7D%7D%7D++-+L%5Cleft%28+%7B%5Csum%5Climits_%7Bj+%3D+1%7D%5E%5Cinfty++%7B%7B%5Cpsi+_j%7D%7B%5Cvarepsilon+_%7Bt+-+j%7D%7D%7D+%7C%7BH_%7Bt+-+1%7D%7D%7D+%5Cright%29%5C%5C++%3D+%5Csum%5Climits_%7Bj+%3D+0%7D%5E%5Cinfty++%7B%7B%5Cpsi+_j%7D%7B%5Cvarepsilon+_%7Bt+-+j%7D%7D%7D++-+%5Csum%5Climits_%7Bj+%3D+1%7D%5E%5Cinfty++%7B%7B%5Cpsi+_j%7D%7B%5Cvarepsilon+_%7Bt+-+j%7D%7D%7D++%3D+%7B%5Cvarepsilon+_t%7D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

可以证明这里的系数就是wold系数，即 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi_%7Bj%7D%3D%5Cleft%5Clangle+X_%7Bt%7D%2C+%5Cvarepsilon_%7Bt-j%7D+%2F+%5Csigma%5Cright%5Crangle) 

### 关于信息的讨论

信息序列是当前资料比历史资料多的信息，可以证明 ![[公式]](https://www.zhihu.com/equation?tex=H_%7Bt%7D%3D%5Coverline%7B%5Cmathrm%7Bs%7D%7D+%5Coverline%7B%5Cmathrm%7Bp%7D%7D%5Cleft%28%5Cvarepsilon_%7Bt%7D%5Cright%29+%5Coplus+H_%7Bt-1%7D) ，递推可得

![[公式]](https://www.zhihu.com/equation?tex=H_%7Bt%7D%3D%5Cunderset%7Bj%3D0%7D%7B%5Coplus%7D%7B+%7D%5Coverline%7B%5Cmathrm%7Bsp%7D%7D%5Cleft%28%5Cvarepsilon_%7Bt-j%7D%5Cright%29+%5Coplus+H_%7B-%5Cinfty%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=H_%7B-%5Cinfty%7D%3D%5Cunderset%7Bt%7D%7B%5Ccap%7D+H_%7Bt+%5Ccirc%7D+%5Cquad+V_%7Bt%7D+%5Cin+H_%7B-%5Cinfty%7D) .

### 多步预报的均方误差

根据 wold 表示定理的第五部分有 ![[公式]](https://www.zhihu.com/equation?tex=V_%7Bt%2Bn%7D+%5Cin+H_%7Bt%7D) ，所以

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+L%5Cleft%28X_%7Bt%2Bn%7D+%5Cmid+H_%7Bt%7D%5Cright%29+%26%3DL%5Cleft%28U_%7Bt%2Bn%7D+%5Cmid+H_%7Bt%7D%5Cright%29%2BL%5Cleft%28V_%7Bt%2Bn%7D+%5Cmid+H_%7Bt%7D%5Cright%29+%5C%5C+%26%3DL%5Cleft%28%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt%2Bn-j%7D+%5Cmid+H_%7Bt%7D%5Cright%29%2BV_%7Bt%2Bn%7D+%5C%5C+%26%3D%5Csum_%7Bj%3Dn%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt%2Bn-j%7D%2BV_%7Bt%2Bn%7D+%5Cend%7Baligned%7D%5C%5C) 

根据 wold 分解公式知预测的误差为

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%2Bn%7D-L%5Cleft%28X_%7Bt%2Bn%7D+%5Cmid+H_%7Bt%7D%5Cright%29%3D%5Csum_%7Bj%3D0%7D%5E%7Bn-1%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt%2Bn-j%7D%5C%5C) 

均方误差为 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E%7B2%7D%28n%29%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7Bn-1%7D+a_%7Bj%7D%5E%7B2%7D%5Crightarrow+%5Cmathrm%7BE%7D+U_%7Bt%7D%5E%7B2%7D) 

### 最佳预测

之前简单介绍了一下，并没有展开讲。这里说明一下为什么最佳预测就是条件期望。

设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathscr%7BF%7D_%7Bt%7D%3D%5Csigma%5Cleft%5C%7BX_%7Bt%7D%2C+X_%7Bt-1%7D%2C+%5Cldots%5Cright%5C%7D) 表示由 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%2C+X_%7Bt-1%7D%2C+%5Cldots) 生成的 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma) 代数（表示了历史资料的所有信息，涵盖了非线性的）

 要证明的是

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%2Bk%7D-%5Cxi%5Cright%29%5E%7B2%7D+%5Cgeq+%5Cmathrm%7BE%7D%5Cleft%5BX_%7Bt%2Bk%7D-%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%2Bk%7D+%5Cmid+%5Cmathscr%7BF%7D_%7Bt%7D%5Cright%29%5Cright%5D%5E%7B2%7D%5C%5C) 

首先说明其二阶矩存在

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%5BE%5Cleft%28X_%7Bt%2Bk%7D+%5Cmid+%5Cmathscr%7BF%7D_%7Bt%7D%5Cright%29%5Cright%5D%5E%7B2%7D+%5Cleq+E%5Cleft%5BE%5Cleft%28X_%7Bt%2Bk%7D%5E%7B2%7D+%5Cmid+%5Cmathscr%7BF%7D_%7Bt%7D%5Cright%29%5Cright%5D%3DE+X_%7Bt%2Bk%7D%5E%7B2%7D%3C%5Cinfty%5C%5C) 

加一项减一项即可

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%2Bk%7D-%5Cxi%5Cright%29%5E%7B2%7D%3D%26+%5Cmathrm%7BE%7D%5Cleft%5BX_%7Bt%2Bk%7D-%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%2Bk%7D+%5Cmid+%5Cmathscr%7BF%7D_%7Bt%7D%5Cright%29%5Cright%5D%5E%7B2%7D%2B%5C%5C+%26+%5Cmathrm%7BE%7D%5Cleft%5B%5Cxi-%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%2Bk%7D+%5Cmid+%5Cmathscr%7BF%7D_%7Bt%7D%5Cright%29%5Cright%5D%5E%7B2%7D%2B%5C%5C+2+%5Cmathrm%7BE%7D%5Cleft%5B%5Cleft%28X_%7Bt%2Bk%7D%5Cright.%5Cright.%26%5Cleft.%5Cleft.-%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%2Bk%7D+%5Cmid+%5Cmathscr%7BF%7D_%7Bt%7D%5Cright%29%5Cright%29%5Cleft%28%5Cxi-%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%2Bk%7D+%5Cmid+%5Cmathscr%7BF%7D_%7Bt%7D%5Cright%29%5Cright%29%5Cright%5D+%5C%5C+%5Cgeq+%26+%5Cmathrm%7BE%7D%5Cleft%5BX_%7Bt%2Bk%7D-%5Cmathrm%7BE%7D%5Cleft%28X_%7Bt%2Bk%7D+%5Cmid+%5Cmathscr%7BF%7D_%7Bt%7D%5Cright%29%5Cright%5D%5E%7B2%7D+%5Cend%7Baligned%7D%5C%5C) 

其中交叉项利用全期望公式可以证明为 0.

### 最佳线性预测和最佳预测相等的条件

如果平稳序列有 wold 表示

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+a_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

最佳线性预测和最佳预测相等的充要条件为

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28%5Cvarepsilon_%7Bt%2B1%7D+%5Cmid+%5Cvarepsilon_%7Bt%7D%2C+%5Cvarepsilon_%7Bt-1%7D%2C+%5Cldots%5Cright%29%3D0%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

即**白噪声序列是一个鞅**。

> 鞅，直观来说就是公平赌博，表示在给定前面的历史信息的条件下，收益的期望为 0.

### 推论

如果 ARMA 序列中白噪声是独立的，那么多步最佳线性预测与最佳预测相等。

### （三）时间序列的递推预测

之前讲的都是理论，现在考虑如何在计算机上能实现预测。

### （1）时间序列的递推预测

**引入**：如果给你一个零均值平稳时间序列，没有其他的信息，那么肯定是用 0  来进行预测。而随着时间的推移，第一个观察值已经出现，我们用最佳线性预测来预测第二个观察值。当第二个观测值出现，我们用前两个观察值的最佳线性预测来预测第三个，以此类推。记录其中每一步的预测误差为 W。

### 递推预测的正交分解

假设 Y 是零均值平稳序列，方差有限，设

![[公式]](https://www.zhihu.com/equation?tex=L_%7Bn%7D%3D%5Coverline%7B%5Cmathrm%7Bsp%7D%7D%5Cleft%5C%7BY_%7B1%7D%2C+Y_%7B2%7D%2C+%5Cldots%2C+Y_%7Bn%7D%5Cright%5C%7D%5C%5C) 

Y1 到 Yn 的线性组合全体。按照之前引入的思想，每一步的预测为

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D_%7B1%7D%3D0%2C+%5Chat%7BY%7D_%7Bn%7D%3DL%5Cleft%28Y_%7Bn%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn-1%7D%5Cright%29%2C+n%3D1%2C2%2C+%5Cldots%5C%5C) 

其中预测的误差及其方差为

![[公式]](https://www.zhihu.com/equation?tex=W_%7Bn%7D%3DY_%7Bn%7D-%5Chat%7BY%7D_%7Bn%7D%2C+%5Cquad+%5Cnu_%7Bn-1%7D%3DE+W_%7Bn%7D%5E%7B2%7D+.+%5Cquad+n%3D1%2C2%2C+%5Ccdots%5C%5C) 

根据之前证明 wold 定理的思想， W 应该是互相正交的，并且 W 和 Y 生成的空间应该一样。

**正交**：根据最佳线性预测性质，Wn 和 Yn-1，...都是正交的，而 Wn-k 又包含在 Yn-k，...生成的空间中，所以二者正交。二者乘积的期望可以表示为

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28W_%7Bn%7D+W_%7Bk%7D%5Cright%29%3D%5Cnu_%7Bn-1%7D+%5Cdelta_%7Bn-k%7D%5C%5C) 

**空间一样**：W 肯定在 Y 中，用归纳法证明 Y 也在 W 中。首先 Y1=W1，假设对 k 不大于 n 都证明了 Yk 在 W 中，那么注意到 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D_%7Bn%2B1%7D%3DL%5Cleft%28Y_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29) 包含在 Y1 到 Yn 的线性空间中，利用归纳假设这个线性空间包含在 W 中，所以 Yn+1 的最佳线性预测包含在 W 中。

又注意到 ![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bn%2B1%7D%3D%5Cleft%28Y_%7Bn%2B1%7D-%5Chat%7BY%7D_%7Bn%2B1%7D%5Cright%29%2B%5Chat%7BY%7D_%7Bn%2B1%7D%3DW_%7Bn%2B1%7D%2B%5Chat%7BY%7D_%7Bn%2B1%7D) ，所以 Yn+1 也包含在 W 中。即我们得到了

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+L_%7Bn%7D%3D%26+%5Coverline%7B%5Cmathrm%7Bsp%7D%7D%5Cleft%5C%7BY_%7B1%7D%2C+Y_%7B2%7D%2C+%5Cldots%2C+Y_%7Bn%7D%5Cright%5C%7D+%5C%5C+%3D%26+%5Coverline%7B%5Cmathrm%7Bsp%7D%7D%5Cleft%5C%7BW_%7B1%7D%2C+W_%7B2%7D%2C+%5Cldots%2C+W_%7Bn%7D%5Cright%5C%7D%3DM_%7Bn%7D+%5C%5C+%26+n%3D1%2C2%2C+%5Cldots+%5Cend%7Baligned%7D%5C%5C) 

这样一来，关于 Yn,...Y1 的最佳线性预测可以改为关于 Wn,...,W1 的最佳线性预测，而用 W 的好处在于它是正交的。

**定理** 设 Yt 为零均值平稳序列，协方差矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28E%5Cleft%28Y_%7Bs%7D+Y_%7Bt%7D%5Cright%29%5Cright%29_%7B1+%5Cleq+s%2C+t+%5Cleq+m%2B1%7D) 正定，最佳线性预测可以用 W 来表示如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Chat%7BY%7D_%7Bn%2B1%7D+%26+%5Ctriangleq+L%5Cleft%28Y_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29+%5C%5C+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn%2C+j%7D+W_%7Bn%2B1-j%7D%2C+n%3D1%2C2%2C+%5Cldots%2C+m+%5Cend%7Baligned%7D%5C%5C) 

注意这里的系数是与 n 有关的！其中系数以及预测的均方误差 ![[公式]](https://www.zhihu.com/equation?tex=%5Cnu_%7Bn%7D%3DE+W_%7Bn%2B1%7D%5E%7B2%7D) 可以递推得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bc%7D+%5Cnu_%7B0%7D%3DE+Y_%7B1%7D%5E%7B2%7D+%5C%5C+%5Ctheta_%7Bn%2C+n-k%7D%3D%5Cleft%5BE%5Cleft%28Y_%7Bn%2B1%7D+Y_%7Bk%2B1%7D%5Cright%29-%5Csum_%7Bj%3D0%7D%5E%7Bk-1%7D+%5Ctheta_%7Bk%2C+k-j%7D+%5Ctheta_%7Bn%2C+n-j%7D+%5Cnu_%7Bj%7D%5Cright%5D+%2F+%5Cnu_%7Bk%7D+%5C%5C+0+%5Cleq+k+%5Cleq+n-1+%5C%5C+%5Cnu_%7Bn%7D%3DE+Y_%7Bn%2B1%7D%5E%7B2%7D-%5Csum_%7Bj%3D0%7D%5E%7Bn-1%7D+%5Ctheta_%7Bn%2C+n-j%7D%5E%7B2%7D+%5Cnu_%7Bj%7D+%5Cend%7Barray%7D%5Cright.%5C%5C) 

**最后一行**：将均方误差中的 Wn+1 表示为 Yn+1 减去一个最佳线性预测，然后用勾股定理，再利用 W 之间的正交性得到。

在证明之前，我们先应用这个递推公式以便有一个初步的认识。

对第一个观测值用 0 来预测，预测误差及均方误差如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Chat%7BY%7D_%7B1%7D%3D0%2C+%5Cquad+W_%7B1%7D%3DY_%7B1%7D-%5Chat%7BY%7D_%7B1%7D+%5C%5C+v_%7B0%7D%3DE%5Cleft%5BW_%7B1%7D%5E%7B2%7D%5Cright%5D%3DE+Y_%7B1%7D%5E%7B2%7D+%5Cend%7Barray%7D%5C%5C) 

然后用第一个观测值预测第二个，递推公式告诉我们可以用 W1 来预测（当然这里 W1 = Y1）

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Chat%7BY%7D_%7B2%7D%3D%5Ctheta_%7B1%2C1%7D+W_%7B1%7D%2C+%5Cquad+W_%7B2%7D%3DY_%7B2%7D-%5Chat%7BY%7D_%7B2%7D+%5C%5C+E%5Cleft%5B%5Chat%7BY%7D_%7B2%7D+W_%7B1%7D%5Cright%5D%3D%5Ctheta_%7B1%2C1%7D+E%5Cleft%5BW_%7B1%7D%5E%7B2%7D%5Cright%5D%2C+%5Cquad+E%5Cleft%5B%5Chat%7BY%7D_%7B2%7D+W_%7B1%7D%5Cright%5D%3DE%5Cleft%5BY_%7B2%7D+W_%7B1%7D%5Cright%5D%3DE%5Cleft%5BY_%7B2%7D+Y_%7B1%7D%5Cright%5D+%5C%5C+%5Ctheta_%7B1%2C1%7D%3DE%5Cleft%5BY_%7B2%7D+Y_%7B1%7D%5Cright%5D+%2F+v_%7B0%7D%2C+%5Cquad+v_%7B1%7D%3DE%5Cleft%5BW_%7B2%7D%5E%7B2%7D%5Cright%5D%3DE%5Cleft%5B%5Cleft%28Y_%7B2%7D-%5Chat%7BY%7D_%7B2%7D%5Cright%29%5E%7B2%7D%5Cright%5D%3DE+Y_%7B2%7D%5E%7B2%7D-%5Ctheta_%7B1%2C1%7D%5E%7B2%7D+v_%7B0%7D+%5Cend%7Barray%7D%5C%5C) 

> 为了得到系数 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctheta_%7B1%2C1%7D+) ，两边同时乘上 W1 再求期望。其中带尖的可以去掉（因为 W 的正交性），均方误差由勾股定理得到

然后是用前两个预测第三个，相当于用 W1,W2 预测 Y3

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Chat%7BY%7D_%7B3%7D%3D%5Ctheta_%7B2%2C2%7D+W_%7B1%7D%2B%5Ctheta_%7B2%2C1%7D+W_%7B2%7D%2C+%5Cquad+W_%7B3%7D%3DY_%7B3%7D-%5Chat%7BY%7D_%7B3%7D+%5C%5C+E+%5Chat%7BY%7D_%7B3%7D+W_%7B1%7D%3D%5Ctheta_%7B2%2C2%7D+E%5Cleft%5BW_%7B1%7D%5E%7B2%7D%5Cright%5D%2C+%5Cquad+E+%5Chat%7BY%7D_%7B3%7D+W_%7B1%7D%3DE+Y_%7B3%7D+W_%7B1%7D+%5C%5C+%5Ctheta_%7B2%2C2%7D%3DE%5Cleft%5BY_%7B3%7D+Y_%7B1%7D%5Cright%5D+%2F+v_%7B0%7D+%5C%5C+E+%5Chat%7BY%7D_%7B3%7D+W_%7B2%7D%3D%5Ctheta_%7B2%2C1%7D+E%5Cleft%5BW_%7B2%7D%5E%7B2%7D%5Cright%5D+%5C%5C+E+%5Chat%7BY%7D_%7B3%7D+W_%7B2%7D%3DE+Y_%7B3%7D+W_%7B2%7D%3DE+Y_%7B3%7D%5Cleft%28Y_%7B2%7D-%5Chat%7BY%7D_%7B2%7D%5Cright%29%3DE+Y_%7B3%7D+Y_%7B2%7D-%5Ctheta_%7B1%2C1%7D+E+Y_%7B3%7D+Y_%7B1%7D+%5C%5C+%5Ctheta_%7B2%2C1%7D%3DE%5Cleft%5BY_%7B3%7D+Y_%7B2%7D-%5Ctheta_%7B1%2C1%7D+%5Ctheta_%7B2%2C2%7D+v_%7B0%7D%5Cright%5D+%2F+v_%7B1%7D+%5C%5C+v_%7B2%7D%3DE%5Cleft%5B%5Cleft%28Y_%7B3%7D-%5Chat%7BY%7D_%7B3%7D%5Cright%29%5E%7B2%7D%5Cright%5D%3DE+Y_%7B3%7D%5E%7B2%7D-%5Ctheta_%7B2%2C2%7D%5E%7B2%7D+v_%7B0%7D-%5Ctheta_%7B2%2C1%7D%5E%7B2%7D+v_%7B1%7D+%5Cend%7Barray%7D%5C%5C) 

其中系数的计算同理，先同乘 W1 求期望得到第一个系数，再同乘 W2 求期望得到第二个系数，其中期望中带尖的可以去掉。

**注意**：EY3W2的计算要将 W2 转化为 W1，然后 EY3W1 可以由 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctheta_%7B2%2C2%7D) 表示



### （三）时间序列的递推预测

### （1）时间序列的递推预测

回顾一下递推预测定理的内容。

**定理** 设 Yt 为零均值平稳序列，协方差矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28E%5Cleft%28Y_%7Bs%7D+Y_%7Bt%7D%5Cright%29%5Cright%29_%7B1+%5Cleq+s%2C+t+%5Cleq+m%2B1%7D) 正定，最佳线性预测可以用 W 来表示如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Chat%7BY%7D_%7Bn%2B1%7D+%26+%5Ctriangleq+L%5Cleft%28Y_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29+%5C%5C+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn%2C+j%7D+W_%7Bn%2B1-j%7D%2C+n%3D1%2C2%2C+%5Cldots%2C+m+%5Cend%7Baligned%7D%5C%5C)

注意这里的系数是与 n 有关的！其中系数以及预测的均方误差 ![[公式]](https://www.zhihu.com/equation?tex=%5Cnu_%7Bn%7D%3DE+W_%7Bn%2B1%7D%5E%7B2%7D) 可以递推得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bc%7D+%5Cnu_%7B0%7D%3DE+Y_%7B1%7D%5E%7B2%7D+%5C%5C+%5Ctheta_%7Bn%2C+n-k%7D%3D%5Cleft%5BE%5Cleft%28Y_%7Bn%2B1%7D+Y_%7Bk%2B1%7D%5Cright%29-%5Csum_%7Bj%3D0%7D%5E%7Bk-1%7D+%5Ctheta_%7Bk%2C+k-j%7D+%5Ctheta_%7Bn%2C+n-j%7D+%5Cnu_%7Bj%7D%5Cright%5D+%2F+%5Cnu_%7Bk%7D+%5C%5C+0+%5Cleq+k+%5Cleq+n-1+%5C%5C+%5Cnu_%7Bn%7D%3DE+Y_%7Bn%2B1%7D%5E%7B2%7D-%5Csum_%7Bj%3D0%7D%5E%7Bn-1%7D+%5Ctheta_%7Bn%2C+n-j%7D%5E%7B2%7D+%5Cnu_%7Bj%7D+%5Cend%7Barray%7D%5Cright.%5C%5C)

其证明方法与上一讲最后的演练基本一致。

**证明** 两边同乘 Wk+1 然后求期望

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+E%5Cleft%28%5Chat%7BY%7D_%7Bn%2B1%7D+W_%7Bk%2B1%7D%5Cright%29+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn%2C+j%7D+E%5Cleft%28W_%7Bn%2B1-j%7D+W_%7Bk%2B1%7D%5Cright%29+%5C%5C+%26%3D%5Ctheta_%7Bn%2C+n-k%7D+%5Cnu_%7Bk%7D+%5Cend%7Baligned%7D%5C%5C) 

利用 W 的正交性把带尖的 Y 改为不带尖的

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28Y_%7Bn%2B1%7D+W_%7Bk%2B1%7D%5Cright%29%3DE%5Cleft%28%5Chat%7BY%7D_%7Bn%2B1%7D+W_%7Bk%2B1%7D%5Cright%29%5C%5C) 

 于是得到要求的系数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Ctheta_%7Bn%2C+n-k%7D+%26%3DE%5Cleft%28%5Chat%7BY%7D_%7Bn%2B1%7D+W_%7Bk%2B1%7D%5Cright%29+%2F+%5Cnu_%7Bk%7D+%5C%5C+%26%3DE%5Cleft%28Y_%7Bn%2B1%7D+W_%7Bk%2B1%7D%5Cright%29+%2F+%5Cnu_%7Bk%7D+%5C%5C+%26%3DE%5Cleft%5BY_%7Bn%2B1%7D%5Cleft%28Y_%7Bk%2B1%7D-%5Csum_%7Bj%3D0%7D%5E%7Bk-1%7D+%5Ctheta_%7Bk%2C+k-j%7D+W_%7Bj%2B1%7D%5Cright%29%5Cright%5D+%2F+%5Cnu_%7Bk%7D+%5C%5C+%26%3D%5Cleft%5BE%5Cleft%28Y_%7Bn%2B1%7D+Y_%7Bk%2B1%7D%5Cright%29-%5Csum_%7Bj%3D0%7D%5E%7Bk-1%7D+%5Ctheta_%7Bk%2C+k-j%7D+%5Ctheta_%7Bn%2C+n-j%7D+%5Cnu_%7Bj%7D%5Cright%5D+%2F+%5Cnu_%7Bk%7D+%5Cend%7Baligned%7D%5C%5C) 

第三行对原来的预测式子做了变量替换

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D_%7Bk%2B1%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+%5Ctheta_%7Bk%2C+j%7D+W_%7Bk%2B1-j%7D%3D%5Csum_%7Bj%3D0%7D%5E%7Bk-1%7D+%5Ctheta_%7Bk%2C+k-j%7D+W_%7Bj%2B1%7D%5C%5C) 

最后一个等号里面，对 j 从 0 到 k-1， ![[公式]](https://www.zhihu.com/equation?tex=%5C%5BE%7BY_%7Bn+%2B+1%7D%7D%7BW_%7Bj+%2B+1%7D%7D%5C%5D) 可以用之前递推得到的系数表示，（**第二行**）。

均方误差利用勾股定理就可以得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cnu_%7Bn%7D%3DE+Y_%7Bn%2B1%7D%5E%7B2%7D-%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn%2C+j%7D%5E%7B2%7D+%5Cnu_%7Bn-j%7D%3DE+Y_%7Bn%2B1%7D%5E%7B2%7D-%5Csum_%7Bj%3D0%7D%5E%7Bn-1%7D+%5Ctheta_%7Bn%2C+n-j%7D%5E%7B2%7D+%5Cnu_%7Bj%7D%5C%5C) 

**递推的顺序如下**：

![[公式]](https://www.zhihu.com/equation?tex=%5Cnu_%7B0%7D+%3B+%5Ctheta_%7B1%2C1%7D%2C+%5Cnu_%7B1%7D+%3B+%5Ctheta_%7B2%2C2%7D%2C+%5Ctheta_%7B2%2C1%7D%2C+%5Cnu_%7B2%7D+%3B+%5Ctheta_%7B3%2C3%7D%2C+%5Ctheta_%7B3%2C2%7D%2C+%5Ctheta_%7B3%2C1%7D%2C+%5Cnu_%7B3%7D+%3B+%5Ccdots%5C%5C) 

### （2）多步预报问题

下面用前 n 个观测值预测第 n+k+1 个观测值。

设

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28Y_%7B1%7D%2C+Y_%7B2%7D%2C+%5Ccdots%2C+Y_%7Bn+%2B+k%2B1%7D%5Cright%29%5E%7BT%7D%5C%5C) 

的自协方差矩阵正定。

记 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D_%7Bn%2Bk%2B1%7D%3DL%5Cleft%28Y_%7Bn%2Bk%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%2Bk%7D%5Cright%29) ，这实际上还是一步预报，根据之前定理有

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D_%7Bn%2Bk%2B1%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%2Bk%7D+%5Ctheta_%7Bn%2Bk%2C+j%7D+W_%7Bn%2Bk%2B1-j%7D%5C%5C) 

现在利用上面这个式子把 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D_%7Bn%2Bk%2B1%7D%3DL%5Cleft%28Y_%7Bn%2Bk%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29) 求出来，过程如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+L%5Cleft%28Y_%7Bn%2Bk%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29%3DL%5Cleft%28%5Chat%7BY%7D_%7Bn%2Bk%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29+%5C%5C+%3D%26+L%5Cleft%5B%5Csum_%7Bj%3D1%7D%5E%7Bn%2Bk%7D+%5Ctheta_%7Bn%2Bk%2C+j%7D+W_%7Bn%2Bk%2B1-j%7D+%5Cmid+%5Cmathbf%7BW%7D_%7Bn%7D%5Cright%5D+%5C%5C+%3D%26+L%5Cleft%5B%5Csum_%7Bj%3Dk%2B1%7D%5E%7Bn%2Bk%7D+%5Ctheta_%7Bn%2Bk%2C+j%7D+W_%7Bn%2Bk%2B1-j%7D+%5Cmid+%5Cmathbf%7BW%7D_%7Bn%7D%5Cright%5D+%5C%5C+%3D%26+%5Csum_%7Bj%3Dk%2B1%7D%5E%7Bn%2Bk%7D+%5Ctheta_%7Bn%2Bk%2C+j%7D+W_%7Bn%2Bk%2B1-j%7D+.+%5Cend%7Baligned%7D%5C%5C) 

其中第一个等号需要注意到，Yn 是一个小的空间，先投影到 Yn+k+1 再投影到 Yn 等价于直接投影到 Yn，这是之前定理保证的（第 09 讲投影算子性质第六条）

第二个等号即一步预报的递推定理，第三个等号利用 W 的正交性，只保留下标在 1 到 n 的，第四个等号因为本身在空间中，投影等于自身。

多步预报的均方误差为（也是勾股定理）

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+E%5Cleft%5BY_%7Bn%2Bk%2B1%7D-L%5Cleft%28Y_%7Bn%2Bk%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29%5Cright%5D%5E%7B2%7D%3DE+Y_%7Bn%2Bk%2B1%7D%5E%7B2%7D-E%5Cleft%5BL%5Cleft%28Y_%7Bn%2Bk%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29%5Cright%5D%5E%7B2%7D+%5C%5C+%3D%26+E+Y_%7Bn%2Bk%2B1%7D%5E%7B2%7D-%5Csum_%7Bj%3Dk%2B1%7D%5E%7Bn%2Bk%7D+%5Ctheta_%7Bn%2Bk%2C+j%7D%5E%7B2%7D+%5Cnu_%7Bn%2Bk-j%7D+%5Cend%7Baligned%7D%5C%5C) 

### （3）正态时间序列的区间预测

软件中对时间序列进行预测会给出置信区间，这是在序列服从正态分布假定下得到的。

利用

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BPr%7D%5Cleft%28%5Cleft%7CY_%7Bn%2B1%7D-%5Chat%7BY%7D_%7Bn%2B1%7D%5Cright%7C+%2F+%5Csqrt%7B%5Cnu_%7Bn%7D%7D+%5Cleq+1.96%5Cright%29%3D0.95%5C%5C) 

可以得到 Yn+1 的置信度为 0.95 的置信区间为

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5B%5Chat%7BY%7D_%7Bn%2B1%7D-1.96+%5Csqrt%7B%5Cnu_%7Bn%7D%7D%2C+%5Chat%7BY%7D_%7Bn%2B1%7D%2B1.96+%5Csqrt%7B%5Cnu_%7Bn%7D%7D%5Cright%5D%5C%5C) 

多步预报也是同理的，Yn+k+1 减去预测值再除以预测的标准差服从标准正态。

### （4）平稳序列的递推预测

将递推定理中两个 Y 乘积的数学期望用自协方差函数表示，其他都一样的。

其中正交的 W 被称为**样本新息序列**，注意其与 wold 定理中的新息序列的差别：wold 定理中是从无穷远的资料开始，而这里的 W 是从第一个观测值开始。

另外，由于是平稳序列，可以对下标 n 进行平移，有

![[公式]](https://www.zhihu.com/equation?tex=%5Cnu_%7Bn%7D%3DE%5Cleft%5BX_%7B1%7D-L%5Cleft%28X_%7B1%7D+%5Cmid+X_%7B0%7D%2C+X_%7B-1%7D%2C+%5Ccdots%2C+X_%7B-n%2B1%7D%5Cright%29%5Cright%5D%5E%7B2%7D+%5Crightarrow+%5Csigma%5E%7B2%7D%5C%5C) 

令 n 趋于无穷就是一个无穷资料预测问题了。 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E%7B2%7D) 是用无穷资料进行一步预测时的方差，如果严格正，那么序列是非决定性的。

### （5）AR(p) 的一步预测

考虑用 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D_%7Bn%7D%3D%5Cleft%28X_%7B1%7D%2C+X_%7B2%7D%2C+%5Cldots%2C+X_%7Bn%7D%5Cright%29%5E%7BT%7D) 预测 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%2B1%7D) .

如果观测数据比较少，1≤n≤p-1，那么自协方差矩阵正定，解预测方程即可

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bn%2B1%7D%3DL%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29%3D%5Cgamma_%7Bn%7D%5E%7BT%7D+%5CGamma_%7Bn%7D%5E%7B-1%7D+%5Cmathbf%7BX%7D_%7Bn%7D%5C%5C) 

当 n ≥ p 时

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Chat%7BX%7D_%7Bn%2B1%7D+%26%3DL%5Cleft%28%5Cvarepsilon_%7Bn%2B1%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bn%2B1-j%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29+%5C%5C+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bn%2B1-j%7D+%5Cend%7Baligned%7D%5C%5C) 

> 现在的观测值与将来的白噪声不相关

所以对 n ≥ p，用前 n 个进行一步预报等于用前 p 个进行一步预报，即

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bn%2B1%7D%3DL%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-p%2B1%7D%5Cright%29%5C%5C) 

### （6）AR(p) 的多步预报

可以用归纳法证明，对 n ≥ p 有

![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29%3DL%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-p%2B1%7D%5Cright%29%5C%5C) 

说明用 p 个数据进行预报与用 n 个数据进行预报结果一样。

于是有递推公式

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+L%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29%3DL%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bn%2Bk-j%7D%2B%5Cvarepsilon_%7Bn%2Bk%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29+%5C%5C+%3DL%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bn%2Bk-j%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+L%5Cleft%28X_%7Bn%2Bk-j%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-p%2B1%7D%5Cright%29+%5Cend%7Barray%7D%5C%5C) 

最后一个式子中，如果下标在 n-p+1 到 n 中，那么预报就是本身。如果不在，则递推计算得到。

**递推例子**（用 1 步预报递推 2 步预报）：

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+L%5Cleft%28+%7B%7BX_%7Bn+%2B+2%7D%7D%7C%7BX_n%7D%2C+%5Ccdots+%2C%7BX_1%7D%7D+%5Cright%29+%3D+L%5Cleft%28+%7B%5Csum%5Climits_%7Bj+%3D+1%7D%5Ep+%7B%7Ba_j%7D%7BX_%7Bn+%2B+2+-+j%7D%7D%7D+%7C%7BX_n%7D%2C+%5Ccdots+%2C%7BX_1%7D%7D+%5Cright%29%5C%5C++%3D+%5Csum%5Climits_%7Bj+%3D+1%7D%5Ep+%7B%7Ba_j%7DL%5Cleft%28+%7B%7BX_%7Bn+%2B+2+-+j%7D%7D%7C%7BX_n%7D%2C+%5Ccdots+%2C%7BX_1%7D%7D+%5Cright%29%7D+%5C%5C++%3D+%7Ba_1%7DL%5Cleft%28+%7B%7BX_%7Bn+%2B+1%7D%7D%7C%7BX_n%7D%2C+%5Ccdots+%2C%7BX_1%7D%7D+%5Cright%29+%2B+%5Csum%5Climits_%7Bj+%3D+2%7D%5Ep+%7B%7Ba_j%7DL%5Cleft%28+%7B%7BX_%7Bn+%2B+2+-+j%7D%7D%7C%7BX_n%7D%2C+%5Ccdots+%2C%7BX_1%7D%7D+%5Cright%29%7D+%5C%5C++%3D+%7Ba_1%7DL%5Cleft%28+%7B%7BX_%7Bn+%2B+1%7D%7D%7C%7BX_n%7D%2C+%5Ccdots+%2C%7BX_1%7D%7D+%5Cright%29+%2B+%5Csum%5Climits_%7Bj+%3D+2%7D%5Ep+%7B%7Ba_j%7D%7BX_%7Bn+%2B+2+-+j%7D%7D%7D++%5Cend%7Barray%7D%5C%5C%5C%5D) 

### 例子 AR(1)模型的预测（常作为考题）

> 这是证明 AR(1) 序列是纯非决定性平稳序列的一种写法

设 ![[公式]](https://www.zhihu.com/equation?tex=X_%7Bn%7D%3Da_%7B1%7D+X_%7Bn-1%7D%2B%5Cvarepsilon_%7Bn%7D) ，那么对任意正整数 m

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+L%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-m%2B1%7D%5Cright%29+%26%3Da_%7B1%7D+X_%7Bn%7D+%5C%5C+L%5Cleft%28X_%7Bn%2B2%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-m%2B1%7D%5Cright%29+%26%3Da_%7B1%7D+L%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+X_%7Bn%7D%5Cright%29+%5C%5C+%26%3Da_%7B1%7D%5E%7B2%7D+X_%7Bn%7D+%5C%5C+%26+%5Cldots+%5C%5C+L%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Cldots%2C+X_%7Bn-m%2B1%7D%5Cright%29+%26%3Da_%7B1%7D%5E%7Bk%7D+X_%7Bn%7D+%5Cend%7Baligned%7D%5C%5C) 

因为 a1 的模小于 1，所以令 k 趋于无穷有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+E%5Cleft%5BX_%7Bn%2Bk%7D-L%5Cleft%28X_%7Bn%2Bk%7D+%5Cmid+X_%7Bn%7D%2C+X_%7Bn-1%7D%2C+%5Ccdots%2C+X_%7Bn-m%7D%5Cright%29%5Cright%5D%5E%7B2%7D+%5C%5C+%3D%26+E%5Cleft%28X_%7Bn%2Bk%7D-a_%7B1%7D%5E%7Bk%7D+X_%7Bn%7D%5Cright%29%5E%7B2%7D+%5C%5C+%3D%26+E%5Cleft%28X_%7Bk%7D-a_%7B1%7D%5E%7Bk%7D+X_%7B0%7D%5Cright%29%5E%7B2%7D+%5C%5C+%5Crightarrow+%26+%5Cgamma_%7B0%7D%3DE+X_%7B0%7D%5E%7B2%7D%2C+%5Ctext+%7B+%E5%BD%93+%7D+k+%5Crightarrow+%5Cinfty+%5Cend%7Baligned%7D%5C%5C) 

> 实际上 ARMA(p,q) 序列都是纯非决定性平稳序列，之前在 wold 表示定理证明之后说明过的

### 例子 AR(2)

假设已经建立好一个 AR(2) 模型如下

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D-0.54+Y_%7Bt-1%7D%2B0.3+Y_%7Bt-2%7D%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cvarepsilon_%7Bt%7D+%5Csim+%5Cmathrm%7BWN%7D%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29%5C%5C) 

假设前面  5 个观测值分别为 20,-70,40,-44,36，预测第 8 个。

可以递推计算如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Chat%7BY%7D_%7B6%7D%3D-0.54+%5Ctimes+36%2B0.3+%5Ctimes%28-44%29%3D-32.64+%5C%5C+%5Chat%7BY%7D_%7B7%7D%3D-0.54+%5Chat%7BY%7D_%7B6%7D%2B0.3+%5Ctimes+36%3D28.43+%5C%5C+%5Chat%7BY%7D_%7B8%7D%3D-0.54+%5Chat%7BY%7D_%7B7%7D%2B0.3+%5Chat%7BY%7D_%7B6%7D%3D-25.14+%5Cend%7Barray%7D%5C%5C) 

### （7）MA(q) 预测

思想与 AR 序列一样，观测值小于 q 就解预测方程，否则就递推。

之前证明过，原序列 Y 和样本新息序列 W 张成空间一样，这里也类似地有

![[公式]](https://www.zhihu.com/equation?tex=L_%7Bn%7D%3D%5Coverline%7B%5Cmathrm%7Bsp%7D%7D%5Cleft%5C%7BX_%7B1%7D%2C+X_%7B2%7D%2C+%5Ccdots%2C+X_%7Bn%7D%5Cright%5C%7D%3D%5Coverline%7B%5Cmathrm%7Bsp%7D%7D%5Cleft%5C%7B%5Chat%7B%5Cvarepsilon%7D_%7B1%7D%2C+%5Chat%7B%5Cvarepsilon%7D_%7B2%7D%2C+%5Cldots%2C+%5Chat%7B%5Cvarepsilon%7D_%7Bn%7D%5Cright%5C%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cvarepsilon%7D_%7Bn%7D%3DX_%7Bn%7D-L%5Cleft%28X_%7Bn%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn-1%7D%5Cright%29) 为逐步预测误差。

那么对于一步预报，有如下推导过程

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%26+L%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29%3DL%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Chat%7B%5Cvarepsilon%7D_%7Bn%7D%2C+%5Cldots%2C+%5Chat%7B%5Cvarepsilon%7D_%7B1%7D%5Cright%29+%5C%5C+%3D%26+L%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Chat%7B%5Cvarepsilon%7D_%7Bn%7D%2C+%5Cldots%2C+%5Chat%7B%5Cvarepsilon%7D_%7Bn-q%2B1%7D%5Cright%29%2BL%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Chat%7B%5Cvarepsilon%7D_%7Bn-q%7D%2C+%5Cldots%2C+%5Chat%7B%5Cvarepsilon%7D_%7B1%7D%5Cright%29+%5C%5C+%3D%26+L%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Chat%7B%5Cvarepsilon%7D_%7Bn%7D%2C+%5Cldots%2C+%5Chat%7B%5Cvarepsilon%7D_%7Bn-q%2B1%7D%5Cright%29++%5Cend%7Baligned%7D%5C%5C) 

其中第一个等号利用 X 和新息序列张成空间一样；第二个等号利用新息序列的正交性，可以将最佳线性预测拆成两部分，其中第二项因为 Xn+1 与 新息序列中的下标间隔超过 q，而 MA(q) 序列的自协方差函数是 q 步截尾，所以等于0.

所以得到与 AR 序列类似的结果：用前 n 个新息预测就等价于用前 q 个新息预测

> **注意**：不能说用前 n 个数据预测就等价于用前 q 个数据预测，因为前 q 个新息与前 q 个数据张成空间不一定相同

而用新息进行预测，可以**用递推定理**。

### 例子 MA(1)  预测

下面是 MA(1) 模型的形式与自协方差函数

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2Bb+%5Cvarepsilon_%7Bt-1%7D%2C+%5Cquad+%5Cvarepsilon_%7Bt%7D+%5Csim+W+N%5Cleft%280%2C+%5Csigma%5E%7B2%7D%5Cright%29) 

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Baligned%7D+%5Cgamma_%7B0%7D+%26%3D%5Csigma%5E%7B2%7D%5Cleft%281%2Bb%5E%7B2%7D%5Cright%29+%5C%5C+%5Cgamma_%7B1%7D+%26%3Db+%5Csigma%5E%7B2%7D+%5C%5C+%5Cgamma_%7Bk%7D+%26%3D0%2C+k+%5Cgeq+2+%5Cend%7Baligned%7D%5Cright.%5C%5C) 

**法一**（递推）：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Chat%7BX%7D_%7Bn%2B1%7D+%26+%5Ctriangleq+L%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29+%5C%5C+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn%2C+j%7D+Z_%7Bn%2B1-j%7D%2C+n%3D1%2C2%2C+%5Cldots+%5Cend%7Baligned%7D%5C%5C) 

直接套递推公式（过程略去）可以得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Ctheta_%7Bn+1%7D%3Db+%5Csigma%5E%7B2%7D+v_%7Bn-1%7D%5E%7B-1%7D+%5C%5C+%5Ctheta_%7Bn+j%7D%3D0%2C2+%5Cleq+j+%5Cleq+n+%5C%5C+v_%7B0%7D%3D%5Csigma%5E%7B2%7D%5Cleft%281%2Bb%5E%7B2%7D%5Cright%29+%5C%5C+v_%7Bn%7D%3D%5Csigma%5E%7B2%7D%5Cleft%281%2Bb%5E%7B2%7D-b%5E%7B2%7D+%5Csigma%5E%7B2%7D+%5Cboldsymbol%7Bv%7D_%7Bn-1%7D%5E%7B-1%7D%5Cright%29+%5Cend%7Barray%7D%5C%5C) 

**法二**（直接推证法）：

之前证明了用前 n 个新息预测等价于用前 q 个新息预测，而这里 q 取 1，所以

![[公式]](https://www.zhihu.com/equation?tex=%5Ctheta_%7Bn+j%7D%3D0%2C2+%5Cleq+j+%5Cleq+n%5C%5C) 

 进而一步预报的形式为![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Chat%7BX%7D_%7B1%7D%3D0+%5C%5C+%5Chat%7BX%7D_%7Bn%2B1%7D%3D%5Ctheta_%7Bn+1%7D%5Cleft%28X_%7Bn%7D-%5Chat%7BX%7D_%7Bn%7D%5Cright%29+%5Cend%7Barray%7D%5C%5C) 

求系数可以两边同乘 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28X_%7Bn%7D-%5Chat%7BX%7D_%7Bn%7D%5Cright%29) 然后取数学期望，最后得到

![[公式]](https://www.zhihu.com/equation?tex=%5Ctheta_%7Bn+1%7D%3Db+%5Csigma%5E%7B2%7D+v_%7Bn-1%7D%5E%7B-1%7D%5C%5C) 

求期望的过程需要用到：过去的新息与当前的观测值正交，即

![[公式]](https://www.zhihu.com/equation?tex=%5C%5BE%7BX_%7Bn+%2B+1%7D%7D%7B%5Chat+%5Cvarepsilon+_n%7D+%3D+0%5C%5C%5C%5D) 

均方误差可以递推如下

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bl%7D%7D+%7B%7Bv_0%7D+%3D+%7B%5Csigma+%5E2%7D%5Cleft%28+%7B1+%2B+%7Bb%5E2%7D%7D+%5Cright%29%7D%5C%5C+%7B%7Bv_n%7D+%3D+%7B%5Cgamma+_0%7D+-+%5Csum%5Climits_%7Bj+%3D+1%7D%5Eq+%7B%5Ctheta+_%7Bn%2Cj%7D%5E2%7D+%7B%5Cnu+_%7Bn+-+j%7D%7D+%3D+%7B%5Csigma+%5E2%7D%5Cleft%28+%7B1+%2B+%7Bb%5E2%7D+-+%7Bb%5E2%7D%7B%5Csigma+%5E2%7Dv_%7Bn+-+1%7D%5E%7B+-+1%7D%7D+%5Cright%29%7D+%5Cend%7Barray%7D%5C%5C%5C%5D) 

而随着 n 增大，信息逐渐增多，预测的均方误差递减，而均方误差有界，所以极限存在。再递推式中两边同取极限可以推得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cnu_%7Bn%7D+%5Crightarrow+%5Csigma%5E%7B2%7D) .

**注意**：解方程会得到两个解，另外一个是 ![[公式]](https://www.zhihu.com/equation?tex=b%5E2%5Csigma%5E2) ，而 ![[公式]](https://www.zhihu.com/equation?tex=v_%7Bn%7D%3E%5Csigma%5E%7B2%7D) （**归纳法证明**）所以极限不是它。

将均方误差的极限代入系数中，可以得到系数的极限为 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctheta_%7Bn+1%7D+%5Crightarrow+b) 

### （8）ARMA(p,q) 预测（这一部分证明要求掌握）

这一块比较复杂，实际上来源于一篇论文。

定义 m 为 p 和 q 中较大的，还是只考虑观测数据大于等于 m 的情形（小于 m 就解预测方程）。

论文中提出下面这个变换

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+X_%7Bt%7D+%2F+%5Csigma%2C+%26+t%3D1%2C2%2C+%5Cldots%2C+m+%5C%5C+A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D+%2F+%5Csigma%2C+%26+t%3Dm%2B1%2C+%5Cldots+%5Cend%7Barray%7D%5Cright.%5C%5C) 

这样变化之后的 Yt 序列不依赖白噪声方差。

**注意：**这里 Y 本身不一定是 MA 序列，但如果从 m+1 个观测值开始，可以被认为是 MA(q) 序列。

基于之前的思想，由 **Xt** 会产生一个正交的新息序列 **Zt**，由 **Yt** 会产生一个正交的新息序列 **Wt** ，而实际上这四个序列张成空间是一样的，并且我们只要证 Xt 和 Yt 空间一样，就可以得到这个结论。下面来证一下：

### X 与 Y 空间一样的证明

**证明** 如果 t 在 1 到 m 中，那么 Xt 和 Yt 只相差一个常数，自然张成空间一样。如果 t ＞ m，用归纳法证明。

**对于 t = m+1**，可以将 Ym+1 表示成 X1 到 Xm+1 的线性组合，而 Y1 到 Ym 就在 X 张成空间中，所以 Y1 到 Ym+1 张成的空间包含在 X1 到 Xm+1 张成的空间中。

而反过来也是利用 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7BY_%7Bm+%2B+1%7D%7D+%3D+%5Cleft%28+%7B%7BX_%7Bm+%2B+1%7D%7D+-+%7Ba_1%7D%7BX_m%7D+-++%5Ccdots++-+%7Ba_p%7D%7BX_%7Bm+%2B+1+-+p%7D%7D%7D+%5Cright%29%2F%5Csigma+%5C%5D) ，将其变换一下得到

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7BX_%7Bm+%2B+1%7D%7D+%3D+%5Csigma+%7BY_%7Bm+%2B+1%7D%7D+%2B+%7Ba_1%7D%7BX_m%7D+%2B++%5Ccdots+%7Ba_p%7D%7BX_%7Bm+%2B+1+-+p%7D%7D%5C%5C%5C%5D) 

而当 t ≤ m 时，X 和 Y 之差一个常数，所以右边的 X 可以表示为 Y 的组合，这样就得到 Xm+1 也可以表示为 Y1 到 Ym+1 的组合。

因此我们证明了 X1 到 Xm+1 空间与 Y1 到 Ym+1 空间一样。

归纳证明的过程与 t = m+1 情形完全类似，不赘述了。

### 两个正交序列的关系

结论很漂亮，两个正交序列只相差一个白噪声方差

![[公式]](https://www.zhihu.com/equation?tex=Z_%7Bt%7D%3D%5Csigma+W_%7Bt%7D%2C+E+Z_%7Bt%7D%5E%7B2%7D%3D%5Csigma%5E%7B2%7D+E+W_%7Bt%7D%5E%7B2%7D%2C+t%3D1%2C2%2C+%5Cldots%5C%5C) 

先挑软柿子捏，对于 t ≤ m 有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+W_%7Bt%7D+%26%3DX_%7Bt%7D+%2F+%5Csigma-L%5Cleft%28X_%7Bt%7D+%2F+%5Csigma+%5Cmid+%5Cmathbf%7BX%7D_%7Bt-1%7D%5Cright%29+%5C%5C+%26%3D%5Csigma%5E%7B-1%7D%5Cleft%5BX_%7Bt%7D-L%5Cleft%28X_%7Bt%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bt-1%7D%5Cright%29%5Cright%5D%3D%5Csigma%5E%7B-1%7D+Z_%7Bt%7D+%5Cend%7Baligned%7D%5C%5C) 

第一个等号利用 X 和 Y 张成空间一样。

对于 t ＞ m，有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+W_%7Bt%7D+%26%3D%5Csigma%5E%7B-1%7D%5Cleft%5BX_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7BP%7D+a_%7Bj%7D+X_%7Bt-j%7D-L%5Cleft%28X_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7BP%7D+a_%7Bj%7D+X_%7Bt-j%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bt-1%7D%5Cright%29%5Cright%5D+%5C%5C+%26%3D%5Csigma%5E%7B-1%7D%5Cleft%5BX_%7Bt%7D-L%5Cleft%28X_%7Bt%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bt-1%7D%5Cright%29%5Cright%5D%3D%5Csigma%5E%7B-1%7D+Z_%7Bt%7D+%5Cend%7Baligned%7D%5C%5C) 

注意第一行的右边，最佳线性预测部分中有一部分就在 X1 到 Xt-1 中，提出去之后与前面抵消掉了。所以 t ＞ m 也不太难的~

### 预报问题

为了预报 X，先解决 Y 的预报问题。

如果设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_k) 为 X 的自协方差函数，那么 Y 的自协方差函数为

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28Y_%7Bs%7D+Y_%7Bt%7D%5Cright%29%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Csigma%5E%7B-2%7D+%5Cgamma_%7Bt-s%7D%2C+%26+1+%5Cleq+s+%5Cleq+t+%5Cleq+m+%5C%5C+%5Csigma%5E%7B-2%7D%5Cleft%5B%5Cgamma_%7Bt-s%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bt-s-j%7D%5Cright%5D%2C+%26+1+%5Cleq+s+%5Cleq+m%3Ct+%5C%5C+%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+b_%7Bj%7D+b_%7Bj%2Bt-s%7D%2C+%26+t+%5Cgeq+s%3Em+%5Cend%7Barray%7D%5Cright.%5C%5C) 

其中 b0 = 1，bj 当 j ＞ q 时为0，其余情形就是 ARMA 模型中的 bj

**第一行**：Ys 和 Yt 与 Xs 和 Xt 之差一个常数，自协方差也只相差一个常数

**第二行**：按照定义为 ![[公式]](https://www.zhihu.com/equation?tex=%5C%5BA%5Cleft%28+%7B%5Ccal+B%7D+%5Cright%29%7B%5Cgamma+_%7Bt+-+s%7D%7D%2F%7B%5Csigma+%5E2%7D%5C%5D) ，将后移算子作用到 t 上即得

**第三行**：Ys 和 Yt 是 MA(q) 序列（白噪声方差为 1），其中系数就是 bj

可以证明 ARMA(p,q) 序列的预报公式为

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bn%2B1%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn%2C+j%7D+Z_%7Bn%2B1-j%7D%2C+%26+1+%5Cleq+n%3Cm+%5C%5C+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bn%2B1-j%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+%5Ctheta_%7Bn%2C+j%7D+Z_%7Bn%2B1-j%7D%2C+%26+n+%5Cgeq+m+%5Cend%7Barray%7D%5Cright.%5C%5C) 

**证明**：

如果观测数据小于等于 m，对于 Y 可以用逐步递推预测公式

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BY%7D_%7Bn%2B1%7D%3DL%5Cleft%28Y_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn%2C+j%7D+W_%7Bn%2B1-j%7D%5C%5C) 

所以 X 的预测为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Chat%7BX%7D_%7Bn%2B1%7D+%26%3DL%5Cleft%28X_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29%3DL%5Cleft%28%5Csigma+Y_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29+%5C%5C+%26%3D%5Csigma+%5Chat%7BY%7D_%7Bn%2B1%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn%2C+j%7D+%5Csigma+W_%7Bn%2B1-j%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn%2C+j%7D+Z_%7Bn%2B1-j%7D+%5Cend%7Baligned%7D%5C%5C) 

> 此时也可以直接解预测方程。

对于 n ＞ m，从结论上看，ARMA 的预测就是把 AR 和 MA 的预测公式合并起来。但需要注意的是，**MA 部分的系数 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctheta) 是由 Y 递推出来的**。

先考虑 Y 的一步预测

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+L%5Cleft%28Y_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BY%7D_%7Bn%7D%5Cright%29%3DL%5Cleft%28Y_%7Bn%2B1%7D+%5Cmid+W_%7Bn%7D%2C+W_%7Bn-1%7D%2C+%5Ccdots%2C+W_%7B1%7D%5Cright%29+%5C%5C+%3DL%5Cleft%28Y_%7Bn%2B1%7D+%5Cmid+W_%7Bn%7D%2C+W_%7Bn-1%7D%2C+%5Ccdots%2C+W_%7Bn-q%2B1%7D%5Cright%29%2BL%5Cleft%28Y_%7Bn%2B1%7D+%5Cmid+W_%7Bn-q%7D%2C+W_%7Bn-q-1%7D%2C+%5Ccdots%2C+W_%7B1%7D%5Cright%29+%5C%5C+%3DL%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn%2C+j%7D+W_%7Bn%2B1-j%7D+%5Cmid+W_%7Bn%7D%2C+W_%7Bn-1%7D%2C+%5Ccdots%2C+W_%7Bn-q%2B1%7D%5Cright%29+%5C%5C+%3D%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+%5Ctheta_%7Bn%2C+j%7D+W_%7Bn%2B1-j%7D%2C+%5Cquad+n+%5Cgeq+m%3D%5Cmax+%28p%2C+q%29+%5Cend%7Barray%7D%5C%5C) 

第二个等号利用 W 的正交性，其中第二项等于 0 说明如下：

> 注意 Yn+1 是 MA 序列，但 W 并不完全是 MA 序列的新息序列，所以不能直接利用之前的结论说明正交

 利用 ARMA 模型定义，Yn+1 除了可用 X 表示，也可以用白噪声表示

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bn%2B1%7D%3D%5Csigma%5E%7B-1%7D+B%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bn%2B1%7D%3D%5Csigma%5E%7B-1%7D+%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+b_%7Bj%7D+%5Cvarepsilon_%7Bn%2B1-j%7D%5C%5C) 

这里白噪声的下标大于 n-q，所以 Yn+1 与 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7BX_%7Bj%7D%3A+1+%5Cleq+j+%5Cleq+n-q%5Cright%5C%7D) 正交，从而与 ![[公式]](https://www.zhihu.com/equation?tex=%5Coverline%7B%5Cmathrm%7Bsp%7D%7D%5Cleft%5C%7BW_%7Bj%7D%3A+1+%5Cleq+j+%5Cleq+n-q%5Cright%5C%7D) 中任何变量正交。

> 也就是说，对于这里定义的 Y，虽然它并不完全是 MA 序列，但是用前 n 个数据进行一步预测也等价于用前 q 个新息序列进行一步预测。

最后利用 Xn+1 与 Yn+1 的关系可得

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Chat%7BX%7D_%7Bn%2B1%7D+%26%3DL%5Cleft%28%5Csum_%7Bj%3D1%7D%5E%7BP%7D+a_%7Bj%7D+X_%7Bn%2B1-j%7D%2B%5Csigma+Y_%7Bn%2B1%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29+%5C%5C+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bn%2B1-j%7D%2B%5Csigma+%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+%5Ctheta_%7Bn%2C+j%7D+W_%7Bn%2B1-j%7D+%5C%5C+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bn%2B1-j%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+%5Ctheta_%7Bn%2C+j%7D+Z_%7Bn%2B1-j%7D+%5Cend%7Baligned%7D%5C%5C) 

第一个等号为 Xn+1 和 Yn+1 的关系，第二个等号利用 X 和 Y 张成空间一样。

预测的均方误差为 ![[公式]](https://www.zhihu.com/equation?tex=E+Z_%7Bn%2B1%7D%5E%7B2%7D%3D%5Csigma%5E%7B2%7D+%5Cnu_%7Bn%7D) ，**再次声明**： ![[公式]](https://www.zhihu.com/equation?tex=%5Ctheta_%7Bn%2Cj%7D%2C%5Cnu_n) 都是用 Y 序列递推得到的。

> 因为 Y 与白噪声方差无关，所以递推出来的系数与均方误差也与白噪声方差无关



### ARMA 序列递推预报例子

 考虑下面的 ARMA(4,2) 模型

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+X_%7Bt%7D%3D%26-0.9+X_%7Bt-1%7D-1.4+X_%7Bt-2%7D-0.7+X_%7Bt-3%7D+%5C%5C+%26-0.6+X_%7Bt-4%7D%2B%5Cvarepsilon_%7Bt%7D%2B0.5+%5Cvarepsilon_%7Bt-1%7D-0.4+%5Cvarepsilon_%7Bt-2%7D+%5Cend%7Baligned%7D+%5C%5C) 

利用 wold 系数以及自协方差函数的公式

![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi_%7Bj%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+1%2C+%26+j%3D0+%5C%5C+b_%7Bj%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bk%7D+%5Cpsi_%7Bj-k%7D%2C+%26+j%3D1%2C2%2C+%5Cldots+%5Cend%7Barray%7D%5Cright.%5C%5C) 

编程计算出前 21 个自协方差

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Csigma%5E%7B2%7D+%5Csum_%7Bj%3D0%7D%5E%7B%5Cinfty%7D+%5Cpsi_%7Bj%7D+%5Cpsi_%7Bj%2Bk%7D%5C%5C) 

> 加到无穷大可以用加到 50 来近似

计算自协方差的结果为

![img](https://pic1.zhimg.com/80/v2-df185642757ef1ac1a42096ae7092d58_720w.jpg)

利用上一讲得到的公式计算 Yt 的自协方差函数：

![[公式]](https://www.zhihu.com/equation?tex=E%5Cleft%28Y_%7Bs%7D+Y_%7Bt%7D%5Cright%29%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Csigma%5E%7B-2%7D+%5Cgamma_%7Bt-s%7D%2C+%26+1+%5Cleq+s+%5Cleq+t+%5Cleq+m+%5C%5C+%5Csigma%5E%7B-2%7D%5Cleft%5B%5Cgamma_%7Bt-s%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+%5Cgamma_%7Bt-s-j%7D%5Cright%5D%2C+%26+1+%5Cleq+s+%5Cleq+m%3Ct+%5C%5C+%5Csum_%7Bj%3D0%7D%5E%7Bq%7D+b_%7Bj%7D+b_%7Bj%2Bt-s%7D%2C+%26+t+%5Cgeq+s%3Em+%5Cend%7Barray%7D%5Cright.%5C%5C) 

利用递推预报公式对 Y 进行预报，结果如下图

![img](https://pic1.zhimg.com/80/v2-a79a938f561c72a554b07007d0845c2c_720w.jpg)

![img](https://pic4.zhimg.com/80/v2-8984c6bbb2e27b29f568be9ab2e537cb_720w.jpg)

**注意**：预测误差趋于 1 （实际上是白噪声方差）的速度还是很理想的

以下为递推预报前20（红）与真实结果（蓝）

![img](https://pic3.zhimg.com/80/v2-7a4c221492bbfe0cce31196ce8edfb8a_720w.jpg)

### ARMA(2,1)例子 （考试形式）

 考察如下模型

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D-X_%7Bt-1%7D%2B0.25+X_%7Bt-2%7D%3D%5Cvarepsilon_%7Bt%7D%2B0.5+%5Cvarepsilon_%7Bt-1%7D%2C+%5Cquad%5Cleft%5C%7B%5Cvarepsilon_%7Bt%7D%5Cright%5C%7D+%5Csim+W+N%280%2C1%29%5C%5C) 

计算 wold 系数得到

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5Cpsi+_0%7D+%3D+1%2C%7B%5Cpsi+_1%7D+%3D+%7B%5Cpsi+_0%7D+%2B+%7Bb_1%7D+%3D+1.5%2C%7B%5Cpsi+_2%7D+%3D+%7B%5Cpsi+_1%7D+-+0.25%7B%5Cpsi+_0%7D+%3D+0.25%2C%5C%5C%5C%5D)![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2B%5Cfrac%7B3%7D%7B2%7D+%5Cvarepsilon_%7Bt-1%7D%2B%5Cfrac%7B5%7D%7B4%7D+%5Cvarepsilon_%7Bt-2%7D%2B%5Ccdots%5C%5C) 

两边同乘 Xt-k 然后取数学期望

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bc%7D+%5Cgamma_%7B0%7D-%5Cgamma_%7B1%7D%2B%5Cfrac%7B1%7D%7B4%7D+%5Cgamma_%7B2%7D%3D%5Cfrac%7B7%7D%7B4%7D+%5C%5C+-%5Cgamma_%7B0%7D%2B%5Cfrac%7B5%7D%7B4%7D+%5Cgamma_%7B1%7D%3D%5Cfrac%7B1%7D%7B2%7D+%5C%5C+%5Cgamma_%7Bk%7D-%5Cgamma_%7Bk-1%7D%2B%5Cfrac%7B1%7D%7B4%7D+%5Cgamma_%7Bk-2%7D%3D0%2C+%5Cquad+k+%5Cgeq+2+%5Cend%7Barray%7D%5Cright.%5C%5C) 

类似第 05 讲的方法，可以得到自协方差函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Cgamma_%7B0%7D%3D%5Cfrac%7B164%7D%7B27%7D%2C+%5Cgamma_%7B1%7D%3D%5Cfrac%7B142%7D%7B27%7D%2C+%5Cgamma_%7B2%7D%3D%5Cfrac%7B101%7D%7B27%7D+%5C%5C+%5Cgamma_%7Bk%7D%3DC_%7B1%7D%5Cleft%28%5Cfrac%7B1%7D%7B2%7D%5Cright%29%5E%7Bk%7D%2BC_%7B2%7D+k%5Cleft%28%5Cfrac%7B1%7D%7B2%7D%5Cright%29%5E%7Bk%7D%2C+k%3D0%2C1%2C2_%7B4%7D+%5Ccdots+%5Cend%7Barray%7D%5C%5C) 

解出 C1 和 C2 即可

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Cfrac%7B164%7D%7B27%7D+%5Ctimes%5Cleft%28%5Cfrac%7B1%7D%7B2%7D%5Cright%29%5E%7Bk%7D%2B%5Cfrac%7B101%7D%7B27%7D+k+%5Ctimes%5Cleft%28%5Cfrac%7B1%7D%7B2%7D%5Cright%29%5E%7Bk%7D%2C+k%3D0%2C1%2C2%2C+%5Ccdots%5C%5C) 

作 Ansley 变换

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bcl%7D+X_%7Bt%7D%2C+%26+t+%5Cleq+2+%5C%5C+X_%7Bt%7D-X_%7Bt-1%7D%2B0.25+X_%7Bt-2%7D%2C+%26+t%3E2+%5Cend%7Barray%7D%5Cright.%5C%5C) 

计算 Y 的自协方差函数如下

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+E+Y_%7B1%7D%5E%7B2%7D%3DE+Y_%7B2%7D%5E%7B2%7D%3D%5Cfrac%7B164%7D%7B27%7D+%5C%5C+E+Y_%7B1%7D+Y_%7B2%7D%3DE+Y_%7B2%7D+Y_%7B1%7D%3D%5Cfrac%7B142%7D%7B27%7D%2C+E+Y_%7B1%7D+Y_%7Bk%7D%3DE+Y_%7Bk%7D+Y_%7B1%7D%3D0%2C+k+%5Cgeq+3+%5C%5C+E+Y_%7B2%7D+Y_%7B3%7D%3DE+Y_%7B3%7D+Y_%7B2%7D%3D%5Cfrac%7B1%7D%7B2%7D%2C+E+Y_%7B2%7D+Y_%7Bk%7D%3DE+Y_%7Bk%7D+Y_%7B2%7D%3D0%2C+k+%5Cgeq+4+%5Cend%7Barray%7D%5C%5C) 

- 当 s 和 t 都不超过 2，那么自协方差函数与 X 的一样
- 当一个超过 2 一个不超过，根据 Ansley 变换下 Y 的定义计算（基本上就是 Y-W 方程的结果）
- 两个都超过 2，为 MA 序列。相差超过 1 为 0，不超过 1 则根据 b0 和 b1 计算即可

接下来手算 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctheta_%7B11%7D%2C+%5Ctheta_%7B22%7D%2C+%5Ctheta_%7B21%7D) 即均方误差,其中

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+v_%7Bn-1%7D%3DE%5Cleft%28X_%7Bn%7D-%5Chat%7BX%7D_%7Bn%7D%5Cright%29%5E%7B2%7D%2C+n%3D1%2C2%2C3+%5C%5C+%5Chat%7BX%7D_%7B1%7D%3D0+%5C%5C+%5Chat%7BX%7D_%7B2%7D%3D%5Ctheta_%7B11%7D%5Cleft%28X_%7B1%7D-%5Chat%7BX%7D_%7B1%7D%5Cright%29+%5C%5C+%5Chat%7BX%7D_%7B3%7D%3D0.5+X_%7B2%7D-0.25+X_%7B1%7D%2B%5Ctheta_%7B21%7D%5Cleft%28X_%7B2%7D-%5Chat%7BX%7D_%7B2%7D%5Cright%29%2B%5Ctheta_%7B22%7D%5Cleft%28X_%7B1%7D-%5Chat%7BX%7D_%7B1%7D%5Cright%29+%5Cend%7Barray%7D%5C%5C) 

由于白噪声方差为 1，所以对 X 的预测误差等于对 Y 的预测误差

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Chat%7BY%7D_%7B1%7D%3D0+%5C%5C+%5Chat%7BY%7D_%7B2%7D%3D%5Ctheta_%7B11%7D%5Cleft%28Y_%7B1%7D-%5Chat%7BY%7D_%7B1%7D%5Cright%29+%5C%5C+%5Chat%7BY%7D_%7B3%7D%3D%5Ctheta_%7B21%7D%5Cleft%28Y_%7B2%7D-%5Chat%7BY%7D_%7B2%7D%5Cright%29%2B%5Ctheta_%7B22%7D%5Cleft%28Y_%7B1%7D-%5Chat%7BY%7D_%7B1%7D%5Cright%29+%5Cend%7Barray%7D%5C%5C) 

第一个预测误差即 ![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_0) ，然后两边同乘取期望来求系数

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+v_%7B0%7D%3DE+Y_%7B1%7D%5E%7B2%7D%3D%5Cfrac%7B164%7D%7B27%7D+%5C%5C+%5Ctheta_%7B11%7D%3D%5Cfrac%7BE%5Cleft%5B%5Chat%7BY%7D_%7B2%7D%5Cleft%28Y_%7B1%7D-%5Chat%7BY%7D_%7B1%7D%5Cright%29%5Cright%5D%7D%7BE%5Cleft%5B%5Cleft%28Y_%7B1%7D-%5Chat%7BY%7D_%7B1%7D%5Cright%29%5E%7B2%7D%5Cright%5D%7D%3D%5Cfrac%7BE%5Cleft%5BY_%7B2%7D%5Cleft%28Y_%7B1%7D-%5Chat%7BY%7D_%7B1%7D%5Cright%29%5Cright%5D%7D%7BE%5Cleft%5B%5Cleft%28Y_%7B1%7D-%5Chat%7BY%7D_%7B1%7D%5Cright%29%5E%7B2%7D%5Cright%5D%7D%3D%5Cfrac%7B71%7D%7B82%7D+%5C%5C+v_%7B1%7D%3DE%5Cleft%5B%5Cleft%28Y_%7B2%7D-%5Chat%7BY%7D_%7B2%7D%5Cright%29%5E%7B2%7D%5Cright%5D%3DE+Y_%7B2%7D%5E%7B2%7D-%5Ctheta_%7B1%2C1%7D%5E%7B2%7D+v_%7B0%7D%3D%5Cfrac%7B187%7D%7B123%7D+%5Cend%7Barray%7D%5C%5C) 

再递推第二步

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Ctheta_%7B22%7D+%26%3D%5Cfrac%7BE%5Cleft%5B%5Chat%7BY%7D_%7B3%7D%5Cleft%28Y_%7B1%7D-%5Chat%7BY%7D_%7B1%7D%5Cright%29%5Cright%5D%7D%7BE%5Cleft%5B%5Cleft%28Y_%7B1%7D-%5Chat%7BY%7D_%7B1%7D%5Cright%29%5E%7B2%7D%5Cright%5D%7D%3D%5Cfrac%7BE%5Cleft%5BY_%7B3%7D%5Cleft%28Y_%7B1%7D-%5Chat%7BY%7D_%7B1%7D%5Cright%29%5Cright%5D%7D%7BE%5Cleft%5B%5Cleft%28Y_%7B1%7D-%5Chat%7BY%7D_%7B1%7D%5Cright%29%5E%7B2%7D%5Cright%5D%7D%3D0+%5C%5C+%5Ctheta_%7B21%7D+%26%3D%5Cfrac%7BE%5Cleft%5B%5Chat%7BY%7D_%7B3%7D%5Cleft%28Y_%7B2%7D-%5Chat%7BY%7D_%7B2%7D%5Cright%29%5Cright%5D%7D%7BE%5Cleft%5B%5Cleft%28Y_%7B2%7D-%5Chat%7BY%7D_%7B2%7D%5Cright%29%5E%7B2%7D%5Cright%5D%7D%3D%5Cfrac%7BE%5Cleft%5BY_%7B3%7D%5Cleft%28Y_%7B2%7D-%5Chat%7BY%7D_%7B2%7D%5Cright%29%5Cright%5D%7D%7Bv_%7B1%7D%7D+%5C%5C+%26%3D%5Cfrac%7BE+Y_%7B3%7D+Y_%7B2%7D-%5Ctheta_%7B11%7D+E+Y_%7B3%7D+Y_%7B1%7D%7D%7Bv_%7B1%7D%7D%3D%5Cfrac%7B123%7D%7B374%7D+%5C%5C+v_%7B2%7D+%26%3DE%5Cleft%5B%5Cleft%28Y_%7B3%7D-%5Chat%7BY%7D_%7B3%7D%5Cright%29%5E%7B2%7D%5Cright%5D%3DE+Y_%7B3%7D%5E%7B2%7D-%5Ctheta_%7B21%7D%5E%7B2%7D+v_%7B1%7D%3D%5Cfrac%7B203%7D%7B187%7D+%5Cend%7Baligned%7D%5C%5C) 

**注意**：EY3Y1 = 0 是凑巧！对于其他 ARMA 模型还是要将 Y2 尖用之前的递推结果替换.

**最后一个**：用预测误差来表示 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28X_%7B1%7D%2C+X_%7B2%7D%2C+X_%7B3%7D%5Cright%29%5E%7BT%7D) 的自协方差矩阵的行列式。

> 这个留到第六章讲完之后再做

## 第六章 ARMA 模型参数估计

用各类统计软件都能很方便的实现参数估计，所以我们注重理论的推导。

### 6.1 AR 模型的参数估计

需要估计的参数有 a1 到 ap 以及白噪声方差。

### （一）Y-W 估计

得到数据后，首先进行中心化。先假定服从 AR(p) 模型，p 已知。

然后计算样本协方差函数 0 到 p。

解 Y-W 方程可以得到系数和白噪声方差的估计

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7D+%7B%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D+%5Chat%7B%5Cgamma%7D_%7B1%7D+%5C%5C+%5Chat%7B%5Cgamma%7D_%7B2%7D+%5C%5C+%5Cvdots+%5C%5C+%5Chat%7B%5Cgamma%7D_%7Bp%7D+%5Cend%7Barray%7D%5Cright%5D%3D%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+%5Chat%7B%5Cgamma%7D_%7B0%7D+%26+%5Chat%7B%5Cgamma%7D_%7B1%7D+%26+%5Ccdots+%26+%5Chat%7B%5Cgamma%7D_%7Bp-1%7D+%5C%5C+%5Chat%7B%5Cgamma%7D_%7B1%7D+%26+%5Chat%7B%5Cgamma%7D_%7B0%7D+%26+%5Ccdots+%26+%5Chat%7B%5Cgamma%7D_%7Bp-2%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+%5Chat%7B%5Cgamma%7D_%7Bp-1%7D+%26+%5Chat%7B%5Cgamma%7D_%7Bp-2%7D+%26+%5Ccdots+%26+%5Chat%7B%5Cgamma%7D_%7B0%7D+%5Cend%7Barray%7D%5Cright%5D%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D+%5Chat%7Ba%7D_%7B1%7D+%5C%5C+%5Chat%7Ba%7D_%7B2%7D+%5C%5C+%5Cvdots+%5C%5C+%5Chat%7Ba%7D_%7Bp%7D+%5Cend%7Barray%7D%5Cright%5D%7D+%5C%5C+%5Chat%7B%5Csigma%7D%5E%7B2%7D%3D%5Chat%7B%5Cgamma%7D_%7B0%7D-%5Cleft%28%5Chat%7Ba%7D_%7B1%7D+%5Chat%7B%5Cgamma%7D_%7B1%7D%2B%5Chat%7Ba%7D_%7B2%7D+%5Chat%7B%5Cgamma%7D_%7B2%7D%2B%5Ccdots%2B%5Chat%7Ba%7D_%7Bp%7D+%5Chat%7B%5Cgamma%7D_%7Bp%7D%5Cright%29+%5Cend%7Barray%7D%5C%5C) 

为了避免计算这个矩阵的逆，之前也介绍过 Levinson 递推法

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bc%7D+%5Chat%7B%5Csigma%7D_%7B0%7D%5E%7B2%7D%3D%5Chat%7B%5Cgamma%7D_%7B0%7D+%5C%5C+%5Chat%7Ba%7D_%7B1%2C1%7D%3D%5Chat%7B%5Cgamma%7D_%7B1%7D+%2F+%5Chat%7B%5Csigma%7D_%7B0%7D%5E%7B2%7D+%5C%5C+%5Chat%7B%5Csigma%7D_%7Bk%7D%5E%7B2%7D%3D%5Chat%7B%5Csigma%7D_%7Bk-1%7D%5E%7B2%7D%5Cleft%281-%5Chat%7Ba%7D_%7Bk%2C+k%7D%5E%7B2%7D%5Cright%29+%5C%5C+%5Chat%7Ba%7D_%7Bk%2B1%2C+k%2B1%7D%3D%5Cfrac%7B%5Chat%7By%7D_%7Bk%2B1%7D-%5Chat%7B%5Cgamma%7D_%7Bk%7D+%5Chat%7Ba%7D_%7Bk%2C+1%7D-%5Chat%7B%5Cgamma%7D_%7Bk-1%7D+%5Chat%7Ba%7D_%7Bk%2C+2%7D-%5Ccdots-%5Chat%7B%5Cgamma%7D_%7B1%7D+%5Chat%7Ba%7D_%7Bk%2C+k%7D%7D%7B%5Chat%7B%5Cgamma%7D_%7B0%7D-%5Chat%7B%5Cgamma%7D_%7B1%7D+%5Chat%7Ba%7D_%7Bk%2C+1%7D-%5Chat%7B%5Cgamma%7D_%7B2%7D+%5Chat%7Ba%7D_%7Bk%2C+2%7D-%5Ccdots-%5Chat%7B%5Cgamma%7D_%7Bk%7D+%5Chat%7Ba%7D_%7Bk%2C+k%7D%7D+%5C%5C+%5Chat%7Ba%7D_%7Bk%2B1%2C+j%7D%3D%5Chat%7Ba%7D_%7Bk%2C+j%7D-%5Chat%7Ba%7D_%7Bk%2B1%2C+k%2B1%7D+%5Chat%7Ba%7D_%7Bk%2C+k%2B1-j%7D%2C+%5Cquad+1+%5Cleq+j+%5Cleq+k%2C+k+%5Cleq+p-1+%5Cend%7Barray%7D%5Cright.%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Chat%7Ba%7D_%7B1%7D%2C+%5Chat%7Ba%7D_%7B2%7D%2C+%5Ccdots%2C+%5Chat%7Ba%7D_%7Bp%7D%5Cright%29%3D%5Cleft%28%5Chat%7Ba%7D_%7Bp%2C+1%7D%2C+%5Chat%7Ba%7D_%7Bp%2C+2%7D%2C+%5Ccdots%2C+%5Chat%7Ba%7D_%7Bp%2C+p%7D%5Cright%29%2C+%5Chat%7B%5Csigma%7D%5E%7B2%7D%3D%5Chat%7B%5Csigma%7D_%7Bp%7D%5E%7B2%7D%5C%5C) 

**优点**：计算简单，保证最小相位性

### Y-W估计的相合性

由于 AR(p) 总体自协方差函数正定，所以系数和白噪声方差是总体自协方差的连续函数。而当白噪声独立同分布时，样本自协方差是总体自协方差的强相合估计，所以 Y-W 估计的系数和白噪声方差也具有强相合性。

以下给出关于 Y-W 估计性质的定理（了解就可）

![img](https://pic3.zhimg.com/80/v2-6e12840928ea0db6d6deb3bbf1a2af0e_720w.jpg)

定理的 2 和 3 分别给出了渐近正态性以及重对数阶的收敛速度。

有渐近正态性就可以计算置信区间了。

### （二）最小二乘估计

基本思想是使得残差平方和达到最小

![[公式]](https://www.zhihu.com/equation?tex=%5Cmin+S%5Cleft%28a_%7B1%7D%2C+%5Cldots%2C+a_%7Bp%7D%5Cright%29+%5Ctriangleq+%5Csum_%7Bt%3Dp%2B1%7D%5E%7BN%7D%5Cleft%5By_%7Bt%7D-%5Cleft%28a_%7B1%7D+y_%7Bt-1%7D%2B%5Ccdots%2Ba_%7Bp%7D+y_%7Bt-p%7D%5Cright%29%5Cright%5D%5E%7B2%7D%5C%5C) 

记

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BY%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+y_%7Bp%2B1%7D+%5C%5C+y_%7Bp%2B2%7D+%5C%5C+%5Ccdots+%5C%5C+y_%7BN%7D+%5Cend%7Barray%7D%5Cright%29%2C+%5Cmathbf%7BX%7D%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bcccc%7D+y_%7Bp%7D+%26+y_%7Bp-1%7D+%26+%5Ccdots+%26+y_%7B1%7D+%5C%5C+y_%7Bp%2B1%7D+%26+y_%7Bp%7D+%26+%5Ccdots+%26+y_%7B2%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+y_%7BN-1%7D+%26+y_%7BN-2%7D+%26+%5Ccdots+%26+y_%7BN-p%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

根据回归理论，最小二乘解为 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctilde%7B%5Cmathbf%7Ba%7D%7D%3D%5Cleft%28%5Cmathbf%7BX%7D%5E%7BT%7D+%5Cmathbf%7BX%7D%5Cright%29%5E%7B-1%7D+%5Cmathbf%7BX%7D%5E%7BT%7D+%5Cmathbf%7BY%7D) ，解唯一的条件为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D%5E%7BT%7D+%5Cmathbf%7BX%7D) 正定

最小二乘估计的计算更简单，甚至不用计算自协方差。

### （三）依概率有界

实际模拟出来，Y-W 估计和最小二乘估计的结果差不多，下面理论说明这一点。

**定义** ξ 为时间序列，如果存在正数 M ，对任意正数 ε 有

![[公式]](https://www.zhihu.com/equation?tex=%5Csup+_%7Bn%7D+P%5Cleft%28%5Cleft%7C%5Cxi_%7Bn%7D%5Cright%7C%3EM%5Cright%29+%5Cleq+%5Cvarepsilon%5C%5C) 

称时间序列 ξ 是依概率有界的，记作 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D%3DO_%7Bp%7D%281%29) ，如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cxi_%7Bn%7D+%2F+c_%7Bn%7D%5Cright%5C%7D%3DO_%7Bp%7D%281%29) ，就称 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D%3DO_%7Bp%7D%5Cleft%28c_%7Bn%7D%5Cright%29) ，其中 cn 为非零常数

注意这里是大 O，如果依概率收敛于 0 则记作小 o。

**引理** 依概率收敛包含在依概率有界中。

> **证明思想** N 很大时有界，而前面有限项总存在最大值，所以整体有界。

**引理** 如果时间序列依概率有界，常数列 cn 趋于无穷，那么 ![[公式]](https://www.zhihu.com/equation?tex=%5Cxi_%7Bn%7D+%2F+c_%7Bn%7D%3Do_%7Bp%7D%281%29) 

> **证明思想** 有界的除以趋于无穷大的，极限显然为 0
> 对于一个确定的随机变量（不是广义的），只要期望有界，它就是依概率有界的。

**引理** 时间序列同分布，一阶矩存在，那么依概率有界。

> **证明** 既然同分布，就可以当做一个确定的随机变量

### （四）Y-W 估计与最小二乘估计的比较

回顾一下 Y-W 估计与最小二乘估计的形式 

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28+%7B%7B%5Cbf%7BXX%27%7D%7D%7D+%5Cright%29a+%3D+%7B%5Cbf%7BX%27Y%7D%7D%5C%5C%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%7B%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D+%5Chat%7B%5Cgamma%7D_%7B1%7D+%5C%5C+%5Chat%7B%5Cgamma%7D_%7B2%7D+%5C%5C+%5Cvdots+%5C%5C+%5Chat%7B%5Cgamma%7D_%7Bp%7D+%5Cend%7Barray%7D%5Cright%5D%3D%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+%5Chat%7B%5Cgamma%7D_%7B0%7D+%26+%5Chat%7B%5Cgamma%7D_%7B1%7D+%26+%5Ccdots+%26+%5Chat%7B%5Cgamma%7D_%7Bp-1%7D+%5C%5C+%5Chat%7B%5Cgamma%7D_%7B1%7D+%26+%5Chat%7B%5Cgamma%7D_%7B0%7D+%26+%5Ccdots+%26+%5Chat%7B%5Cgamma%7D_%7Bp-2%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+%5Chat%7B%5Cgamma%7D_%7Bp-1%7D+%26+%5Chat%7B%5Cgamma%7D_%7Bp-2%7D+%26+%5Ccdots+%26+%5Chat%7B%5Cgamma%7D_%7B0%7D+%5Cend%7Barray%7D%5Cright%5D%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D+%5Chat%7Ba%7D_%7B1%7D+%5C%5C+%5Chat%7Ba%7D_%7B2%7D+%5C%5C+%5Cvdots+%5C%5C+%5Chat%7Ba%7D_%7Bp%7D+%5Cend%7Barray%7D%5Cright%5D%7D%5C%5C) 

考察矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%281+%2F+N%29+%5Cmathbf%7BX%7D%5E%7BT%7D+%5Cmathbf%7BX%7D) 的第 j 行第 k 列元素

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Ctilde%7B%5Cgamma%7D_%7Bj+k%7D+%26%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7BN-p%7D+y_%7Bt%2Bp-j%7D+%5Cdot%7By%7D_%7Bt%2Bp-k%7D%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3Dp-j%2B1%7D%5E%7BN-j%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D+%5C%5C+%26%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7BN-%28j-k%29%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7Bp-j%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3DN-j%2B1%7D%5E%7BN-%28j-k%29%7D+y_%7Bt%7D+y_%7Bt%2Bi-k%7D+%5C%5C+%26%3D%5Chat%7B%5Cgamma%7D_%7Bj-k%7D-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7Bp-j%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3DN-j%2B1%7D%5E%7BN-%28j-k%29%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D+%5Cend%7Baligned%7D%5C%5C) 

>  其中矩阵乘法的形式如下，由于两个矩阵是转置关系，所以等价第 j 行乘第 k 行

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bcccc%7D+y_%7Bp%7D+%26+y_%7Bp%2B1%7D+%26+%5Ccdots+%26+y_%7BN-1%7D+%5C%5C+y_%7Bp-1%7D+%26+y_%7Bp%7D+%26+%5Ccdots+%26+y_%7BN-2%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+y_%7B1%7D+%26+y_%7B2%7D+%26+%5Ccdots+%26+y_%7BN-p%7D+%5Cend%7Barray%7D%5Cright%29%5Cleft%28%5Cbegin%7Barray%7D%7Bcccc%7D+y_%7Bp%7D+%26+y_%7Bp-1%7D+%26+%5Ccdots+%26+y_%7B1%7D+%5C%5C+y_%7Bp%2B1%7D+%26+y_%7Bp%7D+%26+%5Ccdots+%26+y_%7B2%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+y_%7BN-1%7D+%26+y_%7BN-2%7D+%26+%5Ccdots+%26+y_%7BN-p%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

得到的 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cgamma%7D_%7Bj-k%7D) 为样本协方差，所以 Y-W 估计的系数矩阵与最小二乘估计的系数矩阵之间的差异为

![[公式]](https://www.zhihu.com/equation?tex=-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7Bp-j%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3DN-j%2B1%7D%5E%7BN-%28j-k%29%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D%5C%5C) 

求和都只有有限个，所以都会趋于 0，但第二项会啰嗦一些，因为求和指标也在变化。

**说明**：第一项中 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bt%3D1%7D%5E%7Bp-j%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D) 是固定的随机变量，依概率有界。除以 N 后与 1/N 同阶。

第二项用 AR 序列的严平稳遍历性，得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Csum+%5Cbegin%7Barray%7D%7Bl%7D+N-%28j-k%29+%5C%5C+t%3DN-j%2B1+%5Cend%7Barray%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D) 也是严平稳遍历的。

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3DN-j%2B1%7D%5E%7BN-%28j-k%29%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D%26%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7BN-%28j-k%29%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bj%3D1%7D%5E%7BN-j%29%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D+%5C%5C+%26%3D%5Cfrac%7BN-%28j-k%29%7D%7BN+%5Cquad+%5Cfrac%7B1%7D%7BN-%28j-k%29%7D+%5Csum_%7Bj%3D1%7D%5E%7BN-%28j-k%29%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D%7D+%5C%5C+%5Cquad%26-%5Cfrac%7BN-j%7D%7BN%7D+%5Cfrac%7B1%7D%7BN-j%7D+%5Csum_%7Bj%3D1%7D%5E%7BN-j%29%7D+y_%7Bt%7D+y_%7Bt%2Bj-k%7D+%5C%5C+%26%5Crightarrow+1+%5Ccdot+%5Cgamma_%7Bj-k%7D-1+%5Ccdot+%5Cgamma_%7Bj-k%7D%3D0+%5Cquad+%5Ctext+%7B+a.s.+%7D+%5Cend%7Barray%7D) 

第一个等号相当于将 a 到 b 分为 1 到 b 减去 1 到 a； 其中最后一行用到严平稳遍历性。

下面考察两种估计方程的右端项差异，计算下面矩阵的第 j 个元素

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bcccc%7D+y_%7Bp%7D+%26+y_%7Bp%2B1%7D+%26+%5Ccdots+%26+y_%7BN-1%7D+%5C%5C+y_%7Bp-1%7D+%26+y_%7Bp%7D+%26+%5Ccdots+%26+y_%7BN-2%7D+%5C%5C+%5Cvdots+%26+%5Cvdots+%26+%26+%5Cvdots+%5C%5C+y_%7B1%7D+%26+y_%7B2%7D+%26+%5Ccdots+%26+y_%7BN-p%7D+%5Cend%7Barray%7D%5Cright%29%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+y_%7Bp%2B1%7D+%5C%5C+y_%7Bp%2B2%7D+%5C%5C+%5Ccdots+%5C%5C+y_%7BN%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

同样可以得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Ctilde%7B%5Cgamma%7D_%7Bj%7D+%26%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7BN-p%7D+y_%7Bt%2Bp-j%7D+y_%7Bt%2Bp%7D%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3Dp-j%2B1%7D%5E%7BN-j%7D+y_%7Bt%7D+y_%7Bt%2Bj%7D+%5C%5C+%26%3D%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7BN-j%7D+y_%7Bt%7D+y_%7Bt%2Bj%7D-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7Bp-j%7D+y_%7Bt%7D+y_%7Bt%2Bj%7D+%5C%5C+%26%3D%5Chat%7B%5Cgamma%7D_%7Bj%7D-%5Cfrac%7B1%7D%7BN%7D+%5Csum_%7Bt%3D1%7D%5E%7Bp-j%7D+y_%7Bt%7D+y_%7Bt%2Bj%7D+%5Cend%7Baligned%7D%5C%5C) 

类似地，右端项的差异也是与 1/N 同阶的。

因此，**由 Y-W 的强相合性可得最小二乘估计的强相合性**。

下面比较两种估计得到的系数之间的差异，以及收敛速度差异。

 作出两者的差并计算得到

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%5Cbegin%7Barray%7D%7Bl%7D+%5Ctilde+a+-+%5Chat+a+%3D+%7B%5Cleft%28+%7B%7B%7B%5Cbf%7BX%7D%7D%5ET%7D%7B%5Cbf%7BX%7D%7D%7D+%5Cright%29%5E%7B+-+1%7D%7D%7B%7B%5Cbf%7BX%7D%7D%5ET%7D%7B%5Cbf%7BY%7D%7D+-+%5Chat+%5CGamma+_p%5E%7B+-+1%7D%7B%7B%5Chat+%5Cgamma+%7D_p%7D%5C%5C++%3D+%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7BN%7D%7B%7B%5Cbf%7BX%7D%7D%5ET%7D%7B%5Cbf%7BX%7D%7D%7D+%5Cright%29%5E%7B+-+1%7D%7D%5Cleft%28+%7B%5Cfrac%7B1%7D%7BN%7D%7B%7B%5Cbf%7BX%7D%7D%5ET%7D%7B%5Cbf%7BY%7D%7D+-+%7B%7B%5Chat+%5Cgamma+%7D_p%7D%7D+%5Cright%29+%2B+%5Cleft%5B+%7B%7B%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7BN%7D%7B%7B%5Cbf%7BX%7D%7D%5ET%7D%7B%5Cbf%7BX%7D%7D%7D+%5Cright%29%7D%5E%7B+-+1%7D%7D+-+%5Chat+%5CGamma+_p%5E%7B+-+1%7D%7D+%5Cright%5D%7B%7B%5Chat+%5Cgamma+%7D_p%7D%5C%5C++%3D+%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7BN%7D%7B%7B%5Cbf%7BX%7D%7D%5ET%7D%7B%5Cbf%7BX%7D%7D%7D+%5Cright%29%5E%7B+-+1%7D%7D%7BO_p%7D%281%2FN%29+%2B+%7B%5Cleft%28+%7B%5Cfrac%7B1%7D%7BN%7D%7B%7B%5Cbf%7BX%7D%7D%5ET%7D%7B%5Cbf%7BX%7D%7D%7D+%5Cright%29%5E%7B+-+1%7D%7D%5Cleft%5B+%7B%7B%7B%5Chat+%5CGamma+%7D_p%7D+-+%5Cfrac%7B1%7D%7BN%7D%7B%7B%5Cbf%7BX%7D%7D%5ET%7D%7B%5Cbf%7BX%7D%7D%7D+%5Cright%5D%5Chat+%5CGamma+_p%5E%7B+-+1%7D%7B%7B%5Chat+%5Cgamma+%7D_p%7D%5C%5C+%7B%5Crm%7B+%3D+%7D%7D%7BO_p%7D%281%2FN%29+%5Cend%7Barray%7D%5C%5C%5C%5D) 

第二个等式为添一减一，其中第一项有一个依概率有界的因子，第二项配凑依概率有界因子得到第三个等式。

由于 1/N 收敛到 0 的速度很快，所以对较大的 N，两种估计方法没有很大差异。

> 实际模拟中，样本较小时，系数估计是 Y-W 比较好，预测方差估计是最小二乘法比较好；样本较大时没有明显差异

### （五）最小二乘估计的极限分布

最小二乘估计与 Y-W 估计有相同的渐近分布：

![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Ctilde%7Ba%7D_%7B1%7D-a_%7B1%7D%2C+%5Ccheck%7Ba%7D_%7B2%7D-a_%7B2%7D%2C+%5Cldots%2C+%5Ctilde%7Ba%7D_%7Bp%7D-a_%7Bp%7D%5Cright%29%5Crightarrow+N%5Cleft%280%2C+%5Csigma%5E%7B2%7D+%5CGamma_%7Bp%7D%5E%7B-1%7D%5Cright%29%5C%5C) 

### （六）极大似然估计

假定白噪声服从正态分布，那么 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bp%2B1%7D%2C+%5Cvarepsilon_%7Bp%2B2%7D%2C+%5Ccdots%2C+%5Cvarepsilon_%7BN%7D) 的联合密度为

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cfrac%7B1%7D%7B2+%5Cpi+%5Csigma%5E%7B2%7D%7D%5Cright%29%5E%7B%5Cfrac%7BN-p%7D%7B2%7D%7D+%5Cexp+%5Cleft%28-%5Cfrac%7B1%7D%7B2+%5Csigma%5E%7B2%7D%7D+%5Csum_%7Bt%3Dp%2B1%7D%5E%7BN%7D+%5Cvarepsilon_%7Bt%7D%5E%7B2%7D%5Cright%29%5C%5C) 

> 注意白噪声下标不是从 1 开始的

将白噪声用原序列 X 替换得到 X 的似然函数

![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28%5Cmathbf%7Ba%7D%2C+%5Csigma%5E%7B2%7D%5Cright%29%3D%5Cleft%28%5Cfrac%7B1%7D%7B2+%5Cpi+%5Csigma%5E%7B2%7D%7D%5Cright%29%5E%7B%5Cfrac%7BN-p%7D%7B2%7D%7D+%5Cexp+%5Cleft%28-%5Cfrac%7B1%7D%7B2+%5Csigma%5E%7B2%7D%7D+%5Csum_%7Bt%3Dp%2B1%7D%5E%7BN%7D%5Cleft%28x_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+x_%7Bt-j%7D%5Cright%29%5E%7B2%7D%5Cright%29%5C%5C) 

下面先对数据进行中心化，然后求对数似然的极值点。

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+I%5Cleft%28%5Cmathbf%7Ba%7D%2C+%5Csigma%5E%7B2%7D%5Cright%29+%26%3D%5Cln+L%5Cleft%28%5Cmathbf%7Ba%7D%2C+%5Csigma%5E%7B2%7D%5Cright%29+%5C%5C+%26%3D-%5Cfrac%7BN-p%7D%7B2%7D+%5Cln+%5Cleft%28%5Csigma%5E%7B2%7D%5Cright%29-%5Cfrac%7B1%7D%7B2+%5Csigma%5E%7B2%7D%7D+%5Csum_%7Bt%3Dp%2B1%7D%5E%7BN%7D%5Cleft%5By_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+y_%7Bt-j%7D%5Cright%5D%5E%7B2%7D%2Bc+%5C%5C+%26%3D-%5Cfrac%7BN-p%7D%7B2%7D+%5Cln+%5Cleft%28%5Csigma%5E%7B2%7D%5Cright%29-%5Cfrac%7B1%7D%7B2+%5Csigma%5E%7B2%7D%7D+S%28%5Cmathbf%7Ba%7D%29%2Bc+%5Cend%7Baligned%7D%5C%5C) 

可以发现， ![[公式]](https://www.zhihu.com/equation?tex=S%28%5Cmathbf%7Ba%7D%29) 为最小二乘估计的极小化目标，所以最大似然估计与最小二乘估计得到的系数是一样的。而白噪声方差可以通过求偏导，并令为 0 得到

![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E%7B2%7D%3D%5Cfrac%7B1%7D%7BN-p%7D+S%28%5Cmathbf%7Ba%7D%29%5C%5C) 

三种估计方法考试以叙述题的形式出现。

### （七）AR 模型的定阶问题

**思想**：计算偏相关系数，观察是否有截尾性

此外，用的很多的还有 AIC 和 BIC 准则，即定义某个与模型拟合优度和简单程度有关的信息量，阶数 p 使得模型拟合程度最好。

通过样本，利用 Levinson 递推来计算偏相关系数，可以得到偏相关系数的强相合估计（在白噪声独立同分布假定下）。（利用样本自协方差函数的强相合性）

### （1）偏相关系数检验

通过递推计算的（也可以解 Y-W 方程）偏相关系数有渐近正态性

![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Chat%7Ba%7D_%7Bk%2C+1%7D-a_%7Bk%2C+1%7D%2C+%5Chat%7Ba%7D_%7Bk%2C+2%7D-a_%7Bk%2C+2%7D%2C+%5Ccdots%2C+%5Chat%7Ba%7D_%7Bk%2C+k%7D-a_%7Bk%2C+k%7D%5Cright%29%5Crightarrow+N%5Cleft%280%2C+%5Csigma%5E%7B2%7D+%5CGamma_%7Bk%7D%5E%7B-1%7D%5Cright%29%5C%5C) 

当 k > p 时， ![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D+%5Chat%7Ba%7D_%7Bk%2C+k%7D) 渐近服从标准正态，所以只要对某个 p 的偏相关系数没有落在标准正态置信区间中，而 p+1 的偏相关系数落在标准正态置信区间中，就可以将阶数定为 p.

**证明标准正态**：只要说明 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E%7B2%7D+%5CGamma_%7Bk%7D%5E%7B-1%7D) 第 k 行第 k 列元素为 1 即可。

![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bk%7D%5E%7B-1%7D%3D%5Cfrac%7B1%7D%7B%5Coperatorname%7Bdet%7D%5Cleft%28%5CGamma_%7Bk%7D%5Cright%29%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bcc%7D+%5Coperatorname%7Bdet%7D%5Cleft%28%5CGamma_%7Bk-1%7D%5Cright%29+%26+%2A+%5C%5C+%2A+%26+%2A+%26+%5Coperatorname%7Bdet%7D%5Cleft%28%5CGamma_%7Bk-1%7D%5Cright%29+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

这里只考察第 1 行第 1 列元素与第 k 行第 k 列元素的伴随矩阵，这两个元素的伴随矩阵是一样的。

于是 ![[公式]](https://www.zhihu.com/equation?tex=%5CGamma_%7Bk%7D%5E%7B-1%7D) 的左上角元素与右下角元素一样

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5CGamma_%7Bk%7D%5E%7B-1%7D%5Cright%29_%7B%28k%2C+k%29%7D%3D%5Cleft%28%5CGamma_%7Bk%7D%5E%7B-1%7D%5Cright%29_%7B%281%2C1%29%7D%3D%5Cfrac%7B%5Coperatorname%7Bdet%7D%5Cleft%28%5CGamma_%7Bk-1%7D%5Cright%29%7D%7B%5Coperatorname%7Bdet%7D%5Cleft%28%5CGamma_%7Bk%7D%5Cright%29%7D%2C+%5Cforall+k+%5Cgeq+1%5C%5C) 

回顾 AR 序列的 YW 方程

![[公式]](https://www.zhihu.com/equation?tex=%5C%5B%7B%5CGamma+_%7Bk+%2B+1%7D%7D%5Cleft%28+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bl%7D%7D+1%5C%5C+%7B+-+%7B%7B%5Cbf%7Ba%7D%7D_k%7D%7D+%5Cend%7Barray%7D%7D+%5Cright%29+%3D+%5Cleft%28+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bc%7D%7D+%7B%7B%5Cgamma+_0%7D%7D%26%2A%5C%5C+%2A%26%7B%7B%5CGamma+_k%7D%7D+%5Cend%7Barray%7D%7D+%5Cright%29%5Cleft%28+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bl%7D%7D+1%5C%5C+%7B+-+%7B%7B%5Cbf%7Ba%7D%7D_k%7D%7D+%5Cend%7Barray%7D%7D+%5Cright%29+%3D+%5Cleft%28+%7B%5Cbegin%7Barray%7D%7B%2A%7B20%7D%7Bl%7D%7D+%7B%7B%5Csigma+%5E2%7D%7D%5C%5C+0%5C%5C++%5Cvdots+%5C%5C+0+%5Cend%7Barray%7D%7D+%5Cright%29%5C%5C%5C%5D) 

从而

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+1+%5C%5C+-%5Cmathbf%7Ba%7D_%7Bk%7D+%5Cend%7Barray%7D%5Cright%29%3D%5CGamma_%7Bk%2B1%7D%5E%7B-1%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+%5Csigma%5E%7B2%7D+%5C%5C+0+%5C%5C+%5Cvdots+%5C%5C+0+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

注意比较等式两端的最上方，于是

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Csigma%5E%7B2%7D+%5CGamma_%7Bk%2B1%7D%5E%7B-1%7D%5Cright%29_%7B%28k%2B1%2C+k%2B1%29%7D%3D%5Cleft%28%5Csigma%5E%7B2%7D+%5CGamma_%7Bk%2B1%7D%5E%7B-1%7D%5Cright%29_%7B%281%2C1%29%7D%3D1%2C+k+%5Cgeq+p%5C%5C) 

### （2）用样本偏相关系数定阶

取 p 为最大位于置信区间外的数

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7Bp%7D%3D%5Cmax+%5Cleft%5C%7Bj%3A%5Cleft%7C%5Chat%7Ba%7D_%7Bj%2C+j%7D%5Cright%7C%3E1.96+%2F+%5Csqrt%7BN%7D%2C+1+%5Cleq+j+%5Cleq+K%5Cright%5C%7D%5C%5C) 

![img](https://pic2.zhimg.com/80/v2-50fbb9d950334abca780f5246c027949_720w.jpg)

对于上图，定阶为 4

### （3）AIC 和 BIC 定阶

两个信息量都考察了拟合优度与模型简单程度

![[公式]](https://www.zhihu.com/equation?tex=%5Coperatorname%7BAlC%7D%28k%29%3D%5Cln+%5Chat%7B%5Csigma%7D_%7Bk%7D%5E%7B2%7D%2B%5Cfrac%7B2+k%7D%7BN%7D%2C+%5Cquad+k%3D0%2C1%2C+%5Cldots%2C+P_%7B0%7D%5C%5C%5Coperatorname%7BBIC%7D%28k%29%3D%5Cln+%5Chat%7B%5Csigma%7D_%7Bk%7D%5E%7B2%7D%2B%5Cfrac%7Bk+%5Cln+N%7D%7BN%7D%2C+%5Cquad+k%3D0%2C1%2C+%5Cldots%2C+P_%7B0%7D%5C%5C) 

其中 p0 为阶数的上界，k 是阶数（阶数越高则模型越复杂）。

自然希望 AIC 和 BIC 越小越好，取极小值对应的 k 作为阶数。

> 两者差异体现在对参数个数的惩罚上，统计中这样的惩罚项都是先随意取，发现实际效果好再来解释。

AIC 是不相合的，倾向于高估；BIC 是强相合的，对较小的 N 倾向于低估。



## 第六章 ARMA 模型参数估计

### （八）模型拟合检验

这一部分是在模型建立好后，对残差序列进行白噪声检验。

AR模型的残差序列为

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cvarepsilon%7D_%7Bt%7D%3Dy_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7B%5Chat%7Bp%7D%7D+%5Chat%7Ba%7D_%7Bj%7D+y_%7Bt-j%7D%2C+%5Cquad+t%3D%5Chat%7Bp%7D%2B1%2C+%5Chat%7Bp%7D%2B2%2C+%5Cldots%2C+N%5C%5C) 

这里的 y 是原序列 x **中心化后**的序列。

而白噪声检验在第 08 讲的 4.3 介绍过卡方检验和样本自相关置信区间检验，可去回顾一下。

[时间序列分析第08讲（均值估计收敛速度，自协方差估计，白噪声检验，预测引入）](https://zhuanlan.zhihu.com/p/300621466)

如果能判断残差序列是白噪声，那么模型合理。否则换用不同的阶数 p，或者改用 MA 或 ARMA 模型。

> 考试如果要叙述这一块，白噪声检验可以不用详细叙述。

### （九）AR 谱密度估计

AR(p) 序列的谱密度函数形式为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C1-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B-2%7D%5C%5C) 

将估计得到的白噪声方差以及系数代入，就得到谱密度的估计

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7Bf%7D%28%5Clambda%29%3D%5Cfrac%7B%5Chat%7B%5Csigma%7D%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7C1-%5Csum_%7Bj%3D1%7D%5E%7B%5Chat%7Bp%7D%7D+%5Chat%7Ba%7D_%7Bj%7D+e%5E%7Bi+j+%5Clambda%7D%5Cright%7C%5E%7B-2%7D%5C%5C) 

## 6.2 MA(q) 参数估计

### 引入--MA(1) 参数估计

考虑

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2Bb+%5Cvarepsilon_%7Bt-1%7D%2C+%5Cquad+t%3D1%2C2%2C+%5Cldots%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%7Cb%7C%3C1) 。计算得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7B1%7D%3D%5Cfrac%7Bb%7D%7B1%2Bb%5E%7B2%7D%7D) （由此可得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7C%5Crho_%7B1%7D%5Cright%7C+%5Cleq+0.5) ），所以

![[公式]](https://www.zhihu.com/equation?tex=%5Crho_%7B1%7D+b%5E%7B2%7D-b%2B%5Crho_%7B1%7D%3D0%5C%5C) 

解得（另一个解不满足 ![[公式]](https://www.zhihu.com/equation?tex=%7Cb%7C%3C1) ）

![[公式]](https://www.zhihu.com/equation?tex=b%3D%5Cfrac%7B1-%5Csqrt%7B1-4+%5Crho_%7B1%7D%5E%7B2%7D%7D%7D%7B2+%5Crho_%7B1%7D%7D%5C%5C) 

如果用 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Crho%7D_%7B1%7D%3D%5Chat%7B%5Cgamma%7D_%7B1%7D+%2F+%5Chat%7B%5Cgamma%7D_%7B0%7D) 来估计自相关函数，可得 b 的**矩估计**：

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7Bb%7D%3D%5Cfrac%7B1-%5Csqrt%7B1-4+%5Chat%7B%5Crho%7D_%7B1%7D%5E%7B2%7D%7D%7D%7B2+%5Chat%7B%5Crho%7D_%7B1%7D%7D%5C%5C) 

当白噪声独立同分布时，样本自相关系数是总体自相关系数的强相合估计，所以矩估计也是强相合估计。并且有渐近正态分布结果

![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%28%5Chat%7Bb%7D-b%29%5Csim+%5Cmathrm%7BN%7D+%5Cleft%280%2C+%5Cfrac%7B1%2Bb%5E%7B2%7D%2Bb%5E%7B4%7D%2Bb%5E%7B6%7D%2Bb%5E%7B8%7D%7D%7B%5Cleft%281-b%5E%7B2%7D%5Cright%29%5E%7B2%7D%7D%5Cright%29%5C%5C) 

### （一）矩估计

考虑可逆 MA(q) 模型

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+b_%7Bj%7D+%5Cvarepsilon_%7Bt-j%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

> 这里假设 q 已经定阶好

利用自协方差函数与参数的关系

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7Bk%7D%3D%5Csigma%5E%7B2%7D%5Cleft%28b_%7B0%7D+b_%7Bk%7D%2Bb_%7B1%7D+b_%7Bk%2B1%7D%2B%5Ccdots%2Bb_%7Bq-k%7D+b_%7Bq%7D%5Cright%29%2C+%5Cquad+0+%5Cleq+k+%5Cleq+q%5C%5C) 

用样本协方差函数替代总体的，然后解 q+1 个方程的方程组得到参数的估计。

> 这是非线性方程组，可以用迭代法求解。

### 线性迭代法：

- 计算样本自协方差函数
- 给定 b 和 σ 的初值
- 利用下面公式迭代

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bc%7D+%5Csigma%5E%7B2%7D%28j%2B1%29%3D%5Cfrac%7B%5Chat%7B%5Cgamma%7D_%7B0%7D%7D%7B1%2Bb_%7B1%7D%5E%7B2%7D%28j%29%2B%5Ccdots%2Bb_%7Bq%7D%5E%7B2%7D%28j%29%7D+%5C%5C+b_%7Bk%7D%28j%2B1%29%3D%5Cfrac%7B%5Chat%7B%5Cgamma%7D_%7Bk%7D%7D%7B%5Csigma%5E%7B2%7D%28j%2B1%29%7D-%5Cleft%5Bb_%7B1%7D%28j%29+b_%7Bk%2B1%7D%28j%29%2B%5Ccdots%2Bb_%7Bq-k%7D%28j%29+b_%7Bq%7D%28j%29%5Cright%5D%2C+%5Cquad+1+%5Cleq+k+%5Cleq+q-1+%5C%5C+b_%7Bq%7D%28j%2B1%29%3D%5Cfrac%7B%5Chat%7B%5Cgamma%7D_%7Bq%7D%7D%7B%5Csigma%5E%7B2%7D%28j%2B1%29%7D+%5Cend%7Barray%7D%5Cright.%5C%5C) 

给定精度δ，当方程组中所有方程的总偏差小于δ时停止

![[公式]](https://www.zhihu.com/equation?tex=%5Csum_%7Bk%3D0%7D%5E%7Bq%7D%5Cleft%7C%5Chat%7B%5Cgamma%7D_%7Bk%7D-%5Csigma%5E%7B2%7D%28j%2B1%29+%5Csum_%7Bt%3D0%7D%5E%7Bq-k%7D+b_%7Bt%7D%28j%2B1%29+b_%7Bt%2Bk%7D%28j%2B1%29%5Cright%7C%3C%5Cdelta%5C%5C) 

### 教材上给出了另外一种方法（来自硕士论文）：

考虑到 MA 序列自协方差函数的截尾性，可令

![[公式]](https://www.zhihu.com/equation?tex=%5Ctilde%7B%5Cgamma%7D_%7Bk%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Chat%7B%5Cgamma%7D_%7Bk%7D%2C+%26+0+%5Cleq+k+%5Cleq+q+%5C%5C+0%2C+%26+k%3Eq+%5Cend%7Barray%7D%5Cright.%5C%5C) 

然后将这个作为自协方差函数的估计，代入论文中的方法，具体细节在第 05 讲已经叙述。

[不爱起床的燕林：时间序列分析第05讲（AR序列自协方差计算，MA模型定义及充要条件）](https://zhuanlan.zhihu.com/p/270376394)[zhuanlan.zhihu.com![图标](https://pic1.zhimg.com/equation_ipico.jpg)](https://zhuanlan.zhihu.com/p/270376394)

需要补充一点说明，这一方法在样本数据充分大时，得到系数估计 b1,...,bq 在几乎处处意义下满足可逆性条件。

### （二）逆相关函数法

比较一下之前介绍的参数估计方法，其实 AR 的参数估计似乎比 MA 的要简单。所以我们想**先将 MA 转为 AR，对 AR 进行参数估计后再转回来**。

假设平稳序列 Xt 有恒正的谱密度 f(λ)，称

![[公式]](https://www.zhihu.com/equation?tex=f_%7By%7D%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B4+%5Cpi%5E%7B2%7D+f%28%5Clambda%29%7D%5C%5C) 

是 Xt 的逆谱密度。

称

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7By%7D%28k%29+%5Ctriangleq+%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+e%5E%7Bi+k+%5Clambda%7D+f_%7By%7D%28%5Clambda%29+d+%5Clambda%5C%5C) 

为逆相关函数。

### （1）MA(q) 的逆自相关函数

对于可逆 MA(q) 序列 Xt，逆谱密度为

![[公式]](https://www.zhihu.com/equation?tex=f_%7By%7D%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B-2%7D%7D%7B2+%5Cpi%7D%5Cleft%7CB%5Cleft%28e%5E%7Bi+%5Clambda%7D%5Cright%29%5Cright%7C%5E%7B-2%7D%5C%5C) 

它是如下 AR(q) 序列的谱密度

![[公式]](https://www.zhihu.com/equation?tex=Y_%7Bt%7D%3D-%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+b_%7Bj%7D+Y_%7Bt-j%7D%2Be_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7Be_%7Bt%7D%5Cright%5C%7D+%5Csim+%5Cmathrm%7BWN%7D%5Cleft%280%2C+%5Csigma%5E%7B-2%7D%5Cright%29) .

> 类似地，AR(q) 的逆谱密度对应的是 MA(q)

逆相关函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7By%7D%28k%29%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+e%5E%7Bi+k+%5Clambda%7D+f_%7By%7D%28%5Clambda%29+d+%5Clambda%2C+%5Cquad+k%3D0%2C1%2C2%2C+%5Cldots%5C%5C) 

这也就是 AR(q) 序列 Yt 的自相关函数。所以只要估计出 Yt 的自相关函数，就能用 AR 序列的参数估计方法得到 MA(q) 序列的待估系数。

**如何估计 Yt 的自相关函数**？

**思路**：MA(q) 近似 AR(∞)，而 AR(∞) 近似 AR(pn), 其中 pn 是比较大的整数。

所以 MA(q) 的逆相关函数近似于 AR(pn) 的逆相关函数！而 AR(pn) 的逆相关函数就是 MA(pn) 的自相关函数。

为了计算 AR 的逆相关函数，给出以下引理。

**引理**  如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28a_%7B1%7D%2C+a_%7B2%7D%2C+%5Cldots%2C+a_%7Bp%7D%5Cright%29) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E2+) 分别是 AR(p) 模型

![[公式]](https://www.zhihu.com/equation?tex=X_%7Bt%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bt-j%7D%2B%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

的自回归系数和白噪声方差，那么它的逆相关函数形式为

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7By%7D%28k%29%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D+%5Csum_%7Bj%3D0%7D%5E%7Bp-k%7D+a_%7Bj%7D+a_%7Bj%2Bk%7D%2C+%26+0+%5Cleq+k+%5Cleq+p%2C+%5Cquad+a_%7B0%7D+%5Ctriangleq-1+%5C%5C+0%2C+%26+k%3Ep+%5Cend%7Barray%7D%5Cright.%5C%5C) 

> 形式上看就是 MA(p) 的自相关函数，只不过白噪声方差变成倒数

**证明** AR(p) 的谱密度为

![[公式]](https://www.zhihu.com/equation?tex=f%28%5Clambda%29%3D%5Cfrac%7B%5Csigma%5E%7B2%7D%7D%7B2+%5Cpi%7D%5Cleft%7CA%5Cleft%28e%5E%7Bi+%5Clambda%7D%5Cright%29%5Cright%7C%5E%7B-2%7D%5C%5C) 

逆谱密度为

![[公式]](https://www.zhihu.com/equation?tex=f_%7By%7D%28%5Clambda%29%3D%5Cfrac%7B1%7D%7B4+%5Cpi%5E%7B2%7D+f%28%5Clambda%29%7D%3D%5Cfrac%7B1%7D%7B2+%5Cpi+%5Csigma%5E%7B2%7D%7D%5Cleft%7CA%5Cleft%28e%5E%7Bi+%5Clambda%7D%5Cright%29%5Cright%7C%5E%7B2%7D%5C%5C) 

所以

![[公式]](https://www.zhihu.com/equation?tex=%5Cgamma_%7By%7D%28k%29%3D%5Cint_%7B-%5Cpi%7D%5E%7B%5Cpi%7D+e%5E%7Bi+k+%5Clambda%7D+f_%7By%7D%28%5Clambda%29+d+%5Clambda%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D+%5Csum_%7Bj%3D0%7D%5E%7Bp-k%7D+a_%7Bj%7D+a_%7Bj%2Bk%7D%2C+%26+0+%5Cleq+k+%5Cleq+p+%5C%5C+0%2C+%26+k%3Ep+%5Cend%7Barray%7D%5Cright.%5C%5C) 

> 逆谱密度是 MA(p) 的谱密度

### （2）MA(q) 的逆相关函数估计法

- 首先利用样本建立一个**长阶的 AR(pn)** 模型，可以用 AIC 来定阶，也可以取 KlnN 的整数部分，其中 K 是正数
- 利用引理计算 AR(pn) 的逆相关函数
- 而 AR(pn) 的逆相关函数近似 MA(q) 的逆相关函数，而 MA(q) 的逆相关函数就是 AR(q) 的自相关函数。
- 利用 AR(q) 的自相关函数就能估计 AR(q) 的系数。而 AR(q) 的系数和 MA(q) 的系数等价的。

### （三）新息估计（常考）

主要解决两个问题：新息估计怎么算？为什么可以这么算？

回顾一下新息序列的定义

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt%2B1%7D+%26%3DX_%7Bt%2B1%7D-%5Chat%7BX%7D_%7Bt%2B1%7D+%5Ctriangleq+X_%7Bt%2B1%7D-L%5Cleft%28X_%7Bt%2B1%7D+%5Cmid+X_%7B1%7D%2C+%5Cldots%2C+X_%7Bt%7D%5Cright%29+%5C%5C+%26%3DX_%7Bt%2B1%7D-L%5Cleft%28X_%7Bt%2B1%7D+%5Cmid+%5Chat%7B%5Cvarepsilon%7D_%7B1%7D%2C+%5Cldots%2C+%5Chat%7B%5Cvarepsilon%7D_%7Bt%7D%5Cright%29+%5C%5C+%26%3DX_%7Bt%2B1%7D-%5Csum_%7Bj%3D1%7D%5E%7Bt%7D+%5Ctheta_%7Bt%2C+j%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt%2B1-j%7D%2C+%5Cquad+t%3D1%2C2%2C+%5Cldots+%5Cend%7Baligned%7D%5C%5C) 

其中第三个等号利用原序列与新息序列张成空间一样，第四个等号利用递推预测定理得到。

比较第二个式子和最后一个式子，并利用 MA 序列最佳线性预测的截尾性得到

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bt%2B1%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+%5Ctheta_%7Bt%2C+j%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt%2B1-j%7D%2C+%5Cquad+t+%5Cgeq+q%5C%5C) 

令 t 趋于无穷，**样本新息就趋于总体新息**。（这是由于有限资料预测取极限等价于无穷资料的预测，而这里无穷资料的预测就是 MA 模型中的白噪声）

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cvarepsilon_%7Bt%2B1%7D+%26%3DX_%7Bt%2B1%7D-L%5Cleft%28X_%7Bt%2B1%7D+%5Cmid+X_%7Bt%7D%2C+X_%7Bt-1%7D%2C+X_%7Bt-2%7D%2C+%5Cldots%5Cright%29+%5C%5C+%26+%5Capprox+X_%7Bt%2B1%7D-L%5Cleft%28X_%7Bt%2B1%7D+%5Cmid+X_%7Bt%7D%2C+X_%7Bt-1%7D%2C+X_%7Bt-2%7D%2C+%5Cldots%2C+X_%7B1%7D%5Cright%29+%5C%5C+%26%3D%5Chat%7B%5Cvarepsilon%7D_%7Bt%2B1%7D%2C+%5Cquad+t+%5Crightarrow+%5Cinfty+%5Cend%7Baligned%7D%5C%5C) 

对比较大的 t 有

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+X_%7Bt%7D+%26%3D%5Cvarepsilon_%7Bt%7D%2Bb_%7B1%7D+%5Cvarepsilon_%7Bt-1%7D%2B%5Ccdots%2Bb_%7Bq%7D+%5Cvarepsilon_%7Bt-q%7D+%5C%5C+%26+%5Capprox+%5Chat%7B%5Cvarepsilon%7D_%7Bt%7D%2Bb_%7B1%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt-1%7D%2B%5Ccdots%2Bb_%7Bq%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt-q%7D+%5C%5C+%26%3DX_%7Bt%7D-%5Chat%7BX%7D_%7Bt%7D%2Bb_%7B1%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt-1%7D%2B%5Ccdots%2Bb_%7Bq%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt-q%7D+%5Cend%7Baligned%7D%5C%5C) 

这说明

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bt%2B1%7D+%5Capprox+b_%7B1%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt%7D%2B%5Ccdots%2Bb_%7Bq%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt%2B1-q%7D%5C%5C) 

对照之前结果

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bt%2B1%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+%5Ctheta_%7Bt%2C+j%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt%2B1-j%7D%2C+%5Cquad+t+%5Cgeq+q%5C%5C%5C%5C) 

我们可以用 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7Bb%7D_%7Bj%7D%3D%5Ctheta_%7Bt%2C+j%7D) 估计 bj，用 ![[公式]](https://www.zhihu.com/equation?tex=%5Cnu_%7Bt%7D) 估计 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E2+) ，这种估计称为新息估计。

## ***叙述步骤（这个不是思想，思想是前面的部分）

- 给定 N 个观测数据，取 ![[公式]](https://www.zhihu.com/equation?tex=m%3Do%5Cleft%28N%5E%7B1+%2F+3%7D%5Cright%29) 
- 计算样本自协方差函数从 0 到 m
- 新息估计为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Chat%7Bb%7D_%7B1%7D%2C+%5Chat%7Bb%7D_%7B2%7D%2C+%5Cldots%2C+%5Chat%7Bb%7D_%7Bq%7D%5Cright%29%3D%5Cleft%28%5Chat%7B%5Ctheta%7D_%7Bm%2C+1%7D%2C+%5Chat%7B%5Ctheta%7D_%7Bm%2C+2%7D%2C+%5Cldots%2C+%5Chat%7B%5Ctheta%7D_%7Bm%2C+q%7D%5Cright%29%2C+%5Cquad+%5Chat%7B%5Csigma%7D%5E%7B2%7D%3D%5Chat%7B%5Cnu%7D_%7Bm%7D) ，其中这些估计可以通过递推得到。

### 相合性（为了完整而介绍，不证明）

对于可逆 ARMA(p,q) 模型

![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+X_%7Bt%7D%3DB%28%5Cmathscr%7BB%7D%29+%5Cvarepsilon_%7Bt%7D%2C+%5Cquad+t+%5Cin+%5Cmathbb%7BZ%7D%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B%5Cpsi_%7Bj%7D%5Cright%5C%7D) 是wold系数，如果白噪声同分布且四阶矩存在，令 N 趋于无穷，m 与 N的1/3次方同阶趋于无穷，那么有渐近正态结论

![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%5Cleft%28%5Chat%7B%5Ctheta%7D_%7Bm%2C+1%7D-%5Cpsi_%7B1%7D%2C+%5Chat%7B%5Ctheta%7D_%7Bm%2C+2%7D-%5Cpsi_%7B2%7D%2C+%5Cldots%2C+%5Chat%7B%5Ctheta%7D_%7Bm%2C+q%7D-%5Cpsi_%7Bq%7D%5Cright%29+%5Csim+N%280%2C+A%29%5C%5C) 

其中 A 为 q 阶方阵

![[公式]](https://www.zhihu.com/equation?tex=A%3D%5Cleft%28a_%7Bi%2C+j%7D%5Cright%29%2C+%5Cquad+a_%7Bi%2C+j%7D%3D%5Csum_%7Bk%3D1%7D%5E%7B%5Cmin+%28i%2C+j%29%7D+%5Cpsi_%7Bi-k%7D+%5Cpsi_%7Bj-k%7D%5C%5C) 

并且 ![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cnu%7D_%7Bm%7D) 依概率收敛到 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E2+) .

> 这里用 ARMA 来叙述，但实际上 ARMA 可以写为 MA(∞)

对于 MA(q) 只要将定理中 wold 系数换成 MA 序列的系数 bj 即可

### （四）MA 序列定阶

### （1）利用自协方差函数截尾性

由 MA 序列的截尾性，当样本自相关系数从某点 q 后变得比较小，就将阶数定为 q 阶。

怎样算很小呢？可以用置信区间来判断，当 m>q 时 ![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D+%5Chat%7B%5Crho%7D_%7Bm%7D) 依分布收敛于均值为 0，方差为

![[公式]](https://www.zhihu.com/equation?tex=1%2B2+%5Crho_%7B1%7D%5E%7B2%7D%2B2+%5Crho_%7B2%7D%5E%7B2%7D%2B%5Cldots%2B2+%5Crho_%7Bq%7D%5E%7B2%7D%5C%5C) 

的正态分布。

如果在置信区间中，当做 0，不在则当做非 0。所以只要画出自相关系数变化图像，找到临界点 q 使得后面的自相关系数都落于置信区间中。

### （2）AIC 和 BIC 定阶

根据问题背景和数据特性，找到阶数的上界 Q0

令阶数m从 0 取到 Q0，拟合不同阶数的 MA(m) 模型

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Csigma%7D_%7Bm%7D%5E%7B2%7D) 为 AIC 函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathrm%7BAlC%7D%28m%29%3D%5Cln+%5Cleft%28%5Chat%7B%5Csigma%7D_%7Bm%7D%5E%7B2%7D%5Cright%29%2B2+m+%2F+N%2C+%5Cquad+m%3D0%2C1%2C+%5Cldots%2C+Q_%7B0%7D%5C%5C) 

阶数 m 应该使得 AIC 函数达到最小，如果最小值点不唯一，取较小的阶数。

> BIC 定阶改下函数形式即可

### （五）MA 模型估计的拟合检验

取 0 之前的白噪声序列为 0，利用递推得到白噪声序列

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5Chat%7B%5Cvarepsilon%7D_%7B1-%5Chat%7Bq%7D%7D%3D%5Chat%7B%5Cvarepsilon%7D_%7B2-%5Chat%7Bq%7D%7D%3D%5Ccdots%3D%5Chat%7B%5Cvarepsilon%7D_%7B0%7D%3D0+%5C%5C+y_%7Bt%7D%3Dx_%7Bt%7D-%5Cbar%7Bx%7D_%7BN%7D+%5C%5C+%5Chat%7B%5Cvarepsilon%7D_%7Bt%7D%3Dy_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7B%5Chat%7Bq%7D%7D+%5Chat%7Bb%7D_%7Bj%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt-j%7D%2C+t%3D1%2C2%2C+%5Cldots%2C+N+%5Cend%7Barray%7D%5C%5C) 

之后进行卡方检验即可，如果通过，则模型合理。否则改变阶数，或用其他模型。

### （六）谱密度估计

把谱密度写出来，然后将其中不知道的用估计量替代，且因为估计量是相合的，所以谱密度估计量也是相合的。

## 6.3 ARMA(p,q) 参数估计

一般 AR 和 MA 拟合效果都不好，就用 ARMA。其实它的参数估计思想前面已经提到过一点，就是**先估计 AR 部分，然后估计 MA 部分**。

### （一）矩估计

对于 ARMA 模型，它对应的是延拓的 Y-W 方程（其实还是左右同乘 Xt-k 取期望）

![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cbegin%7Barray%7D%7Bc%7D+%5Cgamma_%7Bq%2B1%7D+%5C%5C+%5Cgamma_%7Bq%2B2%7D+%5C%5C+.+%5C%5C+%5Cgamma_%7Bp%2Bq%7D+%5Cend%7Barray%7D%5Cright%29%3D%5Cleft%28%5Cbegin%7Barray%7D%7Bcccc%7D+%5Cgamma_%7Bq%7D+%26+%5Cgamma_%7Bq-1%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bq-p%2B1%7D+%5C%5C+%5Cgamma_%7Bq%2B1%7D+%26+%5Cgamma_%7Bq%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bq-p%2B2%7D+%5C%5C+.+.+%26+.+%26+%5Ccdots+%26+.+.+%5C%5C+%5Cgamma_%7Bq%2Bp-1%7D+%26+%5Cgamma_%7Bq%2Bp-2%7D+%26+%5Ccdots+%26+%5Cgamma_%7Bq%7D+%5Cend%7Barray%7D%5Cright%29%5Cleft%28%5Cbegin%7Barray%7D%7Bl%7D+a_%7B1%7D+%5C%5C+a_%7B2%7D+%5C%5C+.+.+%5C%5C+a_%7Bp%7D+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

解之可得 AR 部分的系数估计，并且这是强相合的。

然后令

![[公式]](https://www.zhihu.com/equation?tex=z_%7Bt%7D+%5Ctriangleq+x_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+x_%7Bt-j%7D%2C+t%3Dp%2B1%2C+p%2B2%2C+%5Cldots%2C+N%5C%5C) 

根据 ARMA 模型，这是一个 MA(q) 序列，所以将 aj 用计算得到的估计值替代，可得一 MA 序列，然后利用 MA 序列的参数估计方法来做。

### （二）自回归逼近法

**思想**：如果白噪声 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bt%7D) 已知，可以将 a 和 b 都看做 Xt 关于其他项做回归的回归系数。现在**白噪声序列不知道**，但它作为一步预报误差，可以用样本新息估计，但比较难计算，所以拟合长阶自回归模型，用其残差序列作为一步预报误差的估计。

首先为数据拟合 AR 模型，其中阶数上界为 ![[公式]](https://www.zhihu.com/equation?tex=P_%7B0%7D%3D%5B%5Csqrt%7BN%7D%5D) ，用 AIC 定阶，拟合模型后计算残差

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Cvarepsilon%7D_%7Bt%7D%3Dx_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7B%5Chat%7Bp%7D%7D+%5Chat%7B%5Cphi%7D_%7Bj%7D+x_%7Bt-j%7D%2C+%5Cquad+t%3D%5Chat%7Bp%7D%2B1%2C+%5Chat%7Bp%7D%2B2%2C+%5Cldots%2C+N%5C%5C) 

用残差代替模型中的白噪声得到

![[公式]](https://www.zhihu.com/equation?tex=x_%7Bt%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+x_%7Bt-j%7D%2B%5Chat%7B%5Cvarepsilon%7D_%7Bt%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+b_%7Bj%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt-j%7D%2C+t%3DL%2B1%2C+L%2B2%2C+%5Cldots%2C+N%5C%5C) 

这里 ![[公式]](https://www.zhihu.com/equation?tex=L%3D%5Cmax+%28%5Chat%7Bp%7D%2C+p%2C+q%29) ，现在我们可以把它看成一个**多元线性回归模型**，这里的 Xt 和 白噪声序列都已经有了，使用最小二乘法，取 a 和 b 使得残差平方和最小

![[公式]](https://www.zhihu.com/equation?tex=Q%28%5Cmathbf%7Ba%7D%2C+%5Cmathbf%7Bb%7D%29%3D%5Csum_%7Bt%3DL%2B1%7D%5E%7BN%7D%5Cleft%28x_%7Bt%7D-%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+x_%7Bt-j%7D-%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+b_%7Bj%7D+%5Chat%7B%5Cvarepsilon%7D_%7Bt-j%7D%5Cright%29%5E%7B2%7D%5C%5C) 

白噪声方差估计如下

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7B%5Csigma%7D%5E%7B2%7D%3D%5Cfrac%7B1%7D%7BN-L%7D+Q%5Cleft%28%5Chat%7Ba%7D_%7B1%7D%2C+%5Cldots%2C+%5Chat%7Ba%7D_%7Bp%7D%2C+%5Chat%7Bb%7D_%7B1%7D%2C+%5Cldots%2C+%5Chat%7Bb%7D_%7Bq%7D%5Cright%29%5C%5C) 

## 6.3 ARMA(p,q) 参数估计

### （三）最大似然估计

关于 ARMA 的预报可以拆为 AR 和 MA 两部分，这在之前已经提到，不再赘述

[不爱起床的燕林：时间序列分析第12讲（递推预测定理证明，AR、MA、ARMA的预测问题）](https://zhuanlan.zhihu.com/p/337785621)[zhuanlan.zhihu.com![图标](https://pic4.zhimg.com/equation_ipico.jpg)](https://zhuanlan.zhihu.com/p/337785621)

 如果 Xt 是正态时间序列，协方差阵正定，之前提过：用历史资料预测等价于用历史的样本新息预测（**会证样本新息正交以及样本信息与历史资料的空间一样**）

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bn%7D+%5Ctriangleq+L%5Cleft%28X_%7Bn%7D+%5Cmid+%5Cmathbf%7BX%7D_%7Bn-1%7D%5Cright%29%3D%5Csum_%7Bj%3D1%7D%5E%7Bn-1%7D+%5Ctheta_%7Bn-1%2C+n-j%7D+Z_%7Bj%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=Z_%7Bj%7D%3DX_%7Bj%7D-%5Chat%7BX%7D_%7Bj%7D%2C+Z_%7B1%7D%3DX_%7B1%7D) .

下面来考虑如何把 Z 表示为 X，先把所有的 X 用 Z 来表示：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+X_%7Bn%7D+%26%3D%5Chat%7BX%7D_%7Bn%7D%2BZ_%7Bn%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bn-1%7D+%5Ctheta_%7Bn-1%2C+n-j%7D+Z_%7Bj%7D%2BZ_%7Bn%7D+%5C%5C+%26%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+%5Ctheta_%7Bn-1%2C+n-j%7D+Z_%7Bj%7D+%5Cquad%5Cleft%28%5Ctheta_%7Bn-1%2C0%7D+%5Ctriangleq+1%5Cright%29+%5C%5C+%26%3D%5Cleft%28%5Ctheta_%7Bn-1%2C+n-1%7D%2C+%5Ctheta_%7Bn-1%2C+n-2%7D%2C+%5Ccdots%2C+%5Ctheta_%7Bn-1%2C1%7D%2C+1%5Cright%29+%5Ccdot+%5Cmathbf%7BZ%7D_%7Bn%7D%2C+%5Cend%7Baligned%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BZ%7D_%7Bn%7D%3D%5Cleft%28Z_%7B1%7D%2C+Z_%7B2%7D%2C+%5Ccdots%2C+Z_%7Bn%7D%5Cright%29%5E%7BT%7D) 。

就从这个式子出发，对下标 1 到 n 都写出对应式子，组合成一个矩阵：

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D_%7Bn%7D%3DC+%5Cmathbf%7BZ%7D_%7Bn%7D%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=C%3D%5Cleft%28%5Cbegin%7Barray%7D%7Blllll%7D+1+%26+0+%26+0+%26+%5Ccdots+%26+0+%5C%5C+%5Ctheta_%7B1%2C1%7D+%26+1+%26+0+%26+%5Ccdots+%26+0+%5C%5C+%5Ctheta_%7B2%2C2%7D+%26+%5Ctheta_%7B2%2C1%7D+%26+1+%26+%5Ccdots+%26+0+%5C%5C+%5Cvdots+v+%5Ccdots+%26+%5Cvdots+%26+%5Ccdots+%26+%5Cvdots+%26+%5C%5C+%5Ctheta_%7Bn-1%2C+n-1%7D+%26+%5Ctheta_%7Bn-1%2C+n-2%7D+%26+%5Ctheta_%7Bn-1%2C+n-3%7D+%26+%5Ccdots+%26+1+%5Cend%7Barray%7D%5Cright%29%5C%5C) 

在 Xt 为正态序列的假定下，根据其自协方差矩阵可以得到联合密度函数：

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+L%5Cleft%28%5CGamma_%7Bn%7D%5Cright%29+%26%3D%5Cfrac%7B1%7D%7B%282+%5Cpi%29%5E%7Bn+%2F+2%7D%5Cleft%5B%5Coperatorname%7Bdet%7D%5Cleft%28%5CGamma_%7Bn%7D%5Cright%29%5Cright%5D%5E%7B1+%2F+2%7D%7D+%5Cexp+%5Cleft%28-%5Cfrac%7B1%7D%7B2%7D+%5Cmathbf%7BX%7D_%7Bn%7D%5E%7BT%7D+%5CGamma_%7Bn%7D%5E%7B-1%7D+%5Cmathbf%7BX%7D_%7Bn%7D%5Cright%29+%5C%5C+%26%3D%5Cfrac%7B1%7D%7B%282+%5Cpi%29%5E%7Bn+%2F+2%7D%5Cleft%28r_%7B0%7D+r_%7B1%7D+%5Ccdots+r_%7Bn-1%7D%5Cright%29%5E%7B1+%2F+2%7D%7D+%5Cexp+%5Cleft%28-%5Cfrac%7B1%7D%7B2%7D+%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+Z_%7Bj%7D%5E%7B2%7D+%2F+r_%7Bj-1%7D%5Cright%29+%5Cend%7Baligned%7D%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=r_%7Bk-1%7D+%5Ctriangleq+E+Z_%7Bk%7D%5E%7B2%7D%2C+%5Cquad+k%3D1%2C2%2C+%5Cldots%2C+n-1) ，由 Z 的正交性，其协方差阵为对角阵

![[公式]](https://www.zhihu.com/equation?tex=D+%5Ctriangleq+E%5Cleft%28%5Cmathbf%7BZ%7D_%7Bn%7D+%5Cmathbf%7BZ%7D_%7Bn%7D%5E%7BT%7D%5Cright%29%3D%5Coperatorname%7Bdiag%7D%5Cleft%28r_%7B0%7D%2C+r_%7B1%7D%2C+%5Cldots%2C+r_%7Bn-1%7D%5Cright%29%5C%5C) 

第二行推导如下（注意 D 也要求逆，所以 r 在分母上）

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+%5CGamma_%7Bn%7D%3DE%5Cleft%28C+%5Cmathbf%7BZ%7D_%7Bn%7D+%5Cmathbf%7BZ%7D_%7Bn%7D%5E%7BT%7D+C%5E%7BT%7D%5Cright%29%3DC+D+C%5E%7BT%7D+%5C%5C+%5Coperatorname%7Bdet%7D%5Cleft%28%5CGamma_%7Bn%7D%5Cright%29%3D%5Coperatorname%7Bdet%7D%28D%29%3Dr_%7B0%7D+r_%7B1%7D+%5Ccdots+r_%7Bn-1%7D+%5C%5C+%5Cmathbf%7BX%7D_%7Bn%7D%5E%7BT%7D+%5CGamma_%7Bn%7D%5E%7B-1%7D+%5Cmathbf%7BX%7D_%7Bn%7D%3D%5Cmathbf%7BZ%7D_%7Bn%7D%5E%7BT%7D+C%5E%7BT%7D%5Cleft%28C+D+C%5E%7BT%7D%5Cright%29%5E%7B-1%7D+C+%5Cmathbf%7BZ%7D_%7Bn%7D%3D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D+Z_%7Bj%7D%5E%7B2%7D+%2F+r_%7Bj-1%7D+%5Cend%7Barray%7D%5C%5C) 

回顾一下，对于 ARMA 模型有逐步预报公式

![[公式]](https://www.zhihu.com/equation?tex=%5Chat%7BX%7D_%7Bk%2B1%7D%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+%5Ctheta_%7Bk%2C+j%7D+Z_%7Bk%2B1-j%7D%2C+%26+1+%5Cleq+k%3Cm+%5C%5C+%5Csum_%7Bj%3D1%7D%5E%7Bp%7D+a_%7Bj%7D+X_%7Bk%2B1-j%7D%2B%5Csum_%7Bj%3D1%7D%5E%7Bq%7D+%5Ctheta_%7Bk%2C+j%7D+Z_%7Bk%2B1-j%7D%2C+%26+k+%5Cgeq+m+%5Cend%7Barray%7D%5Cright.%5C%5C) 

 其中![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bl%7D+Z_%7Bk%7D%3DX_%7Bk%7D-%5Chat%7BX%7D_%7Bk%7D%3DX_%7Bk%7D-L%5Cleft%28X_%7Bk%7D+%5Cmid+X_%7Bk-1%7D%2C+X_%7Bk-2%7D%2C+%5Cldots%2C+X_%7Bl%7D%5Cright%29+%5C%5C+r_%7Bk-1%7D%3DE+Z_%7Bk%7D%5E%7B2%7D%3DE%5Cleft%28X_%7Bk%7D-%5Chat%7BX%7D_%7Bk%7D%5Cright%29%5E%7B2%7D%3D%5Csigma%5E%7B2%7D+%5Cnu_%7Bk-1%7D+%5Cend%7Barray%7D%5C%5C) 

关于 Xt 的似然函数为（只是将 r 换成了 σv，这里 v 为 Yt 序列新息的均方误差）

![[公式]](https://www.zhihu.com/equation?tex=L%5Cleft%28%5Cboldsymbol%7B%5Cbeta%7D%2C+%5Csigma%5E%7B2%7D%5Cright%29%3D%5Cfrac%7B%5Cexp+%5Cleft%28-%5Cfrac%7B1%7D%7B2+%5Csigma%5E%7B2%7D%7D+%5Csum_%7Bk%3D1%7D%5E%7BN%7D+Z_%7Bk%7D%5E%7B2%7D+%2F+%5Cnu_%7Bk-1%7D%5Cright%29%7D%7B%282+%5Cpi%29%5E%7BN+%2F+2%7D%5Cleft%28%5Csigma%5E%7B2+N%7D+%5Cnu_%7B0%7D+%5Cnu_%7B1%7D+%5Ccdots+%5Cnu_%7BN-1%7D%5Cright%29%5E%7B1+%2F+2%7D%7D%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5Ctheta_%7Bk%2C+j%7D%2C+%5Cnu_%7Bk%7D) 是用 Yt 序列递推得到的，与 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E2) 无关，只与 ARMA 模型的系数 ai 和 bi 有关。这里的系数就记为

![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Cbeta%7D%3D%5Cleft%28a_%7B1%7D%2C+a_%7B2%7D%2C+%5Cldots%2C+a_%7Bp%7D%2C+b_%7B1%7D%2C+b_%7B2%7D%2C+%5Cldots%2C+b_%7Bq%7D%5Cright%29%5E%7BT%7D%5C%5C) 

忽略常数项后的对数似然函数为

![[公式]](https://www.zhihu.com/equation?tex=%5Cln+L%5Cleft%28%5Cboldsymbol%7B%5Cbeta%7D%2C+%5Csigma%5E%7B2%7D%5Cright%29%3D-%5Cfrac%7BN%7D%7B2%7D+%5Cln+%5Csigma%5E%7B2%7D-%5Cfrac%7B1%7D%7B2%7D+%5Cln+%5Cleft%28%5Cnu_%7B0%7D+%5Cnu_%7B1%7D+%5Ccdots+%5Cnu_%7BN-1%7D%5Cright%29-%5Cfrac%7B1%7D%7B2+%5Csigma%5E%7B2%7D%7D+S%28%5Cboldsymbol%7B%5Cbeta%7D%29%5C%5C) 

其中 ![[公式]](https://www.zhihu.com/equation?tex=S%28%5Cboldsymbol%7B%5Cbeta%7D%29%3D%5Csum_%7Bk%3D1%7D%5E%7BN%7D+Z_%7Bk%7D%5E%7B2%7D+%2F+%5Cnu_%7Bk-1%7D) .

先对 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E2) 求偏导令为 0 得到（注意到中间项与 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%5E2) 无关）

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Csigma%5E%7B2%7D%7D+%5Cln+L%5Cleft%28%5Cbeta%2C+%5Csigma%5E%7B2%7D%5Cright%29%3D-%5Cfrac%7BN%7D%7B2+%5Csigma%5E%7B2%7D%7D%2B%5Cfrac%7BS%28%5Cbeta%29%7D%7B2+%5Csigma%5E%7B4%7D%7D%3D0+%5C%5C+%5Csigma%5E%7B2%7D%3D%5Cfrac%7B1%7D%7BN%7D+S%28%5Cbeta%29+%5Cend%7Barray%7D%5C%5C) 

将其回代得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+I%28%5Cbeta%29+%26+%5Ctriangleq-%5Cfrac%7B2%7D%7BN%7D+%5Cln+L%28%5Cbeta%2C+S%28%5Cbeta%29+%2F+N%29-1+%5C%5C+%26%3D%5Cfrac%7B1%7D%7BN%7D+%5Cln+%5Cleft%28%5Cnu_%7B0%7D+%5Cnu_%7B1%7D+%5Ccdots+%5Cnu_%7BN-1%7D%5Cright%29%2B%5Cln+%5BS%28%5Cbeta%29+%2F+N%5D+%5Cend%7Baligned%7D%5C%5C) 

上面式子称为约化似然函数，可以看到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cnu) 中包含 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbeta) ，求极值点会比较复杂。但叙述的话，就到这一步之后说约化似然函数的最小值点即为系数的最大似然估计。

> 实际计算中可以先用矩估计或自回归逼近方法，得到最小值附近的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbeta) ，用最速下降法得到最小值点，继续深入下去就非常理论化了

回顾一下，ARMA 是非决定性平稳序列，其预测均方误差会趋于1（实际上是白噪声方差，但因为 Yt 的白噪声方差为1，**要求会证**！），即 ![[公式]](https://www.zhihu.com/equation?tex=%5Cnu_%7Bk%7D%5Crightarrow1) ，进而利用**均值的极限等于通项的极限**得到

![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7BN%7D+%5Cln+%5Cleft%28%5Cnu_%7B0%7D+%5Cnu_%7B1%7D+%5Ccdots+%5Cnu_%7BN-1%7D%5Cright%29+%5Crightarrow+0%5C%5C) 

所以求约化似然函数的最小值点可以近似为求第二项的，这等价于最小二乘估计，但在最小二乘估计中，白噪声方差估计为

![[公式]](https://www.zhihu.com/equation?tex=%5Ctilde%7B%5Csigma%7D%5E%7B2%7D%3D%5Cfrac%7B1%7D%7BN-p-q%7D+S%28%5Ctilde%7B%5Cbeta%7D%29%5C%5C) 

### 最大似然估计的极限分布

对于可逆的 ARMA(p,q) 序列 Xt，白噪声独立同分布，四阶矩存在，那么当样本容量 N 趋于无穷时有

![[公式]](https://www.zhihu.com/equation?tex=%5Csqrt%7BN%7D%28%5Chat%7B%5Cboldsymbol%7B%5Cbeta%7D%7D-%5Cboldsymbol%7B%5Cbeta%7D%29%5Crightarrow+N%280%2C+V%28%5Cbeta%29%29%5C%5C) 

其中

![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cboldsymbol%7B%5Cbeta%7D%29%3D%5Cleft%5C%7B%5Cbegin%7Barray%7D%7Bll%7D+%5Csigma%5E%7B2%7D%5Cleft%28%5Cbegin%7Barray%7D%7Bcc%7D+E%5Cleft%28%5Cmathbf%7BU+U%7D%5E%7BT%7D%5Cright%29+%26+E%5Cleft%28%5Cmathbf%7BU+V%7D%5E%7BT%7D%5Cright%29+%5C%5C+E%5Cleft%28%5Cmathbf%7BV+U%7D%5E%7BT%7D%5Cright%29+%26+E%5Cleft%28%5Cmathbf%7BV%7D+%5Cmathbf%7BV%7D%5E%7BT%7D%5Cright%29+%5Cend%7Barray%7D%5Cright%29%5E%7B-1%7D%2C+%26+p%3E0%2C+q%3E0+%5C%5C+%5Csigma%5E%7B2%7D%5Cleft%28E%5Cleft%28%5Cmathbf%7BU%7D+%5Cmathbf%7BU%7D%5E%7BT%7D%5Cright%29%5Cright%29%5E%7B-1%7D%2C+%26+q%3D0%2C+p%3E0%2C+%5C%5C+%5Csigma%5E%7B2%7D%5Cleft%28E%5Cleft%28%5Cmathbf%7BV%7D+%5Cmathbf%7BV%7D%5E%7BT%7D%5Cright%29%5Cright%29%5E%7B-1%7D%2C+%26+p%3D0%2C+q%3E0+%5Cend%7Barray%7D%5Cright.%5C%5C) 

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BU%7D%3D%5Cleft%28U_%7Bp%7D%2C+U_%7Bp-1%7D%2C+%5Cldots%2C+U_%7B1%7D%5Cright%29%5E%7BT%7D%2C+%5Cmathbf%7BV%7D%3D%5Cleft%28V_%7Bq%7D%2C+V_%7Bq-1%7D%2C+%5Cldots%2C+V_%7B1%7D%5Cright%29%5E%7BT%7D%5C%5C) 

Ut 和 Vt 分别为 AR(p) 和 AR(q) 序列，满足

![[公式]](https://www.zhihu.com/equation?tex=A%28%5Cmathscr%7BB%7D%29+U_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D+%2C+B%28%5Cmathscr%7BB%7D%29+V_%7Bt%7D%3D%5Cvarepsilon_%7Bt%7D%5C%5C) 

后面就是残差序列的白噪声检验、谱密度函数估计了，这些都与之前的完全类似。